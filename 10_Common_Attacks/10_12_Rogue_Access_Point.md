| **Inicio**         | **atr√°s 11**                   | **Siguiente 13**                 |
| ------------------ | ------------------------------ | -------------------------------- |
| [üè†](../README.md) | [‚è™](./10_11_Replay_Attack.md) | [‚è©](./10_13_Buffer_Overflow.md) |

---

## **√çndice**

| Temario                                                                                        |
| ---------------------------------------------------------------------------------------------- |
| [321. Puntos de acceso no autorizados](#321-puntos-de-acceso-no-autorizados)                   |
| [322. ¬øQu√© es un punto de acceso no autorizado?](#322-qu√©-es-un-punto-de-acceso-no-autorizado) |

# **Punto de acceso fraudulento**

## **321. Puntos de acceso no autorizados**

![Rogue Access Point](/img/10_Common_Attacks/Rogue_Access_Point.png "Rogue Access Point")

### 1) ¬øQu√© es un punto de acceso no autorizado (Rogue AP)?

Un **Rogue AP** es cualquier punto de acceso inal√°mbrico conectado a (o que interact√∫a con) la infraestructura de red de una organizaci√≥n **sin autorizaci√≥n del equipo de TI**. Puede ser:

- **Accidental/benigno**: un empleado conecta un router dom√©stico a un puerto Ethernet para ‚Äúmejorar Wi-Fi‚Äù.
- **Malicioso**: un atacante conecta un AP al switch o crea un _evil-twin_ (AP que imita un SSID leg√≠timo) para espiar clientes o hacer phishing.
  Estas unidades rompen las pol√≠ticas de control de acceso y evitan las protecciones planificadas para la red.

### 2) ¬øPor qu√© son peligrosos? (impacto)

Un rogue AP puede:

- **Permitir acceso directo a la red interna** si el AP est√° enchufado a un puerto con privilegios.
- **Facilitar ataques Man-in-the-Middle (MitM)** y captura de tr√°fico (HTTP no cifrado, tokens, etc.).
- **Servir para phishing** (captura de credenciales mediante captive portals) ‚Äî forma t√≠pica de _evil twin_.
- **Exponer dispositivos IoT** o permitir pivotaje lateral dentro de la red corporativa.
- **Crear puntos ciegos de seguridad** que no son visibles para los controles centralizados.

  Estos riesgos est√°n documentados por agencias y gu√≠as de seguridad de redes inal√°mbricas.

### 3) Tipos y escenarios (ejemplos reales y did√°cticos)

- **Empleado ingenuo**: un trabajador conecta su ‚Äúrouter de casa‚Äù al puerto de escritorio; lo configura como abierto o con WPA personal; deja la red interna accesible. (Riesgo: puerto con VLAN err√≥nea ‚Üí acceso a recursos internos).
- **Evil-Twin / phishing**: atacante monta un AP con el mismo SSID que el de la cafeter√≠a corporativa y prepara un captive portal que pide login; usuarios despistados entregan credenciales. (Casos similares han sido reportados en aeropuertos y vuelos).
- **AP clandestino conectado por intruso**: alguien accede f√≠sicamente a un armario de telecomunicaciones y enchufa un AP para acceso remoto persistente.
- **AP de terceros mal configurado**: proveedor o contratista deja su equipo conectado sin las pol√≠ticas adecuadas.

### 4) C√≥mo detectarlos (estrategias defensivas)

Detecci√≥n por capas ‚Äî combina varias fuentes para fiabilidad:

**a) Detecci√≥n inal√°mbrica (WIDS/WIPS)**

- Sistema de detecci√≥n inal√°mbrica pasivo (WIDS) o soluci√≥n WIPS que monitoree el espectro y liste APs y clientes. Buscan: SSID desconocidos, BSSID con mismo SSID que APs autorizados, APs fuera de la base de datos de inventario. Muchos controladores empresariales incluyen detecci√≥n autom√°tica.

**b) Detecci√≥n en la red cableada**

- Monitorear switches: detectar puertos que anuncian LLDP/802.1X fallos, o puertos con MACs de APs no esperadas.
- DHCP logs: ver√°s leases otorgados por MACs/DHCP servers inesperados.
- NetFlow/traffic baselines: picos o patrones inusuales asociados a sub-redes inal√°mbricas.

**c) Inventario y correlaci√≥n**

- Mantener una lista autoritativa de APs (BSSID, canal, ubicaci√≥n). Correlacionar lo que reporta el WIDS con esa base de datos.

**d) Se√±ales RF y f√≠sicas**

- Detecci√≥n de SSID duplicados, APs en canales no previstos, potencias inusuales o APs ubicados fuera de zonas autorizadas (triangulaci√≥n RF).
- Inspecciones f√≠sicas y sitio RF surveys peri√≥dicos.

### 5) Prevenci√≥n y endurecimiento (mejores pr√°cticas)

Aplica controles en **capas**: pol√≠ticas, red cableada, autenticaci√≥n y monitoreo.

#### Pol√≠ticas y gobernanza

- Pol√≠tica estricta que proh√≠ba APs no autorizados y sancione conexiones no autorizadas. Comunica qu√© dispositivos est√°n permitidos.
- Inventario √∫nico y registro (BSSID, canal, ubicaci√≥n, responsable).

#### Controles de red cableada

- **Cerrar puertos de switch no usados** (administrative shutdown).
- **Port-security**: limitar el n√∫mero de MACs por puerto, sticky MAC y violaci√≥n en `restrict` o `shutdown` seg√∫n pol√≠tica.
- **802.1X / NAC (Network Access Control)**: autenticar dispositivos antes de otorgar acceso a la red; asignar VLANs en funci√≥n del resultado (guest, corp). Esto evita que un AP sin credenciales obtenga acceso a VLANs internas.
- **DHCP Snooping / Dynamic ARP Inspection / IP Source Guard**: evita que un rogue act√∫e como servidor DHCP o haga ARP spoofing.

#### Seguridad Wi-Fi y Endurecimiento inal√°mbrico

- **WPA2/WPA3-Enterprise** con EAP-TLS (certificados) ‚Äî evita contrase√±as compartidas que facilitan conexi√≥n a APs maliciosos.
- **Controlador y gesti√≥n centralizada** (CAPWAP) ‚Äî APs gestionados por controller reducen la probabilidad de APs desconectados o mal configurados.
- **Segmentaci√≥n**: VLANs separadas para Guest vs Corporate; aplicar firewall entre VLANs.
- **Blindaje f√≠sico**: sellar o restringir acceso a racks y puntos de conexi√≥n.

### 6) Reacci√≥n e investigaci√≥n (qu√© hacer si detectas un Rogue AP)

1. **No actuar a ciegas**: documenta evidencia (WIDS alerts, SSID, BSSID, canal, RSSI, DHCP leases, switch port info).
2. **Localiza f√≠sicamente**: triangulaci√≥n RF o site survey para identificar ubicaci√≥n; inspecciona puertos de switch asociados.
3. **A√≠sla**: si el AP est√° conectado por Ethernet, desconecta el puerto del switch o aplica port-security/errdisable; si es un AP malicioso en RF, usa herramientas WIPS para alertar y, seg√∫n pol√≠ticas, _contenci√≥n_ (advertencia: el env√≠o de desautenticaciones puede ser problem√°tico legalmente y debe usarse con precauci√≥n).
4. **Forense**: captura tr√°fico relevante, logs DHCP, registros de autenticaci√≥n; preserva evidencia.
5. **Mitiga y corrige**: parchea la brecha (cerrar puerto, reforzar 802.1X, revocar credenciales), rota credenciales si fue posible compromiso de cuentas.
6. **Informe y lecciones**: notifica stakeholders, ajusta pol√≠ticas y formaci√≥n.

### 7) Lista pr√°ctica r√°pida ‚Äî Checklist de defensa

- Inventario de APs (BSSID/canales/ubicaci√≥n).
- Habilitar WIDS/WIPS y alertas.
- 802.1X + NAC para puertos de red y acceso Wi-Fi.
- Cerrar puertos no usados / aplicar port-security.
- DHCP Snooping, DAI, IP Source Guard en switches.
- Separar tr√°fico Guest en VLANs y aplicar firewall entre segmentos.
- Requerir WPA2/WPA3-Enterprise (EAP-TLS preferido).
- Realizar RF site surveys y auditor√≠as peri√≥dicas.
- Formar empleados sobre no conectar routers/dom√©sticos.

(Varios de estos controles son recomendados por fabricantes y gu√≠as NIST/Cisco).

### 8) Comandos y ejemplos defensivos (ejemplo Cisco ‚Äî solo configuraciones que aumentan seguridad)

> _Ejemplo ilustrativo para endurecer puertos de acceso en un switch Cisco (solo la parte defensiva):_

```text
interface GigabitEthernet1/0/5
  switchport mode access
  switchport access vlan 20
  switchport port-security
  switchport port-security maximum 2
  switchport port-security mac-address sticky
  switchport port-security violation restrict
  spanning-tree bpduguard enable
  shutdown unused interfaces   ! (hacer en interfaces f√≠sicas sin uso)
```

Y para trunkes:

```text
interface GigabitEthernet1/0/48
  switchport trunk encapsulation dot1q
  switchport mode trunk
  switchport trunk allowed vlan 10,20,30
  switchport trunk native vlan 999  ! native VLAN no usada por hosts
```

Estos son ejemplos defensivos t√≠picos; aj√∫stalos a tu pol√≠tica de red y hardware.

### 9) Herramientas √∫tiles (solo para detecci√≥n / inventario)

- Soluciones empresariales WIPS/WIDS (controladores Cisco, Aruba, Ruckus, etc.).
- Escaneo pasivo / an√°lisis RF: **Kismet**, herramientas de site survey (Ekahau, AirMagnet) para localizar APs.
- Correlaci√≥n con logs de switches / DHCP / SIEM.

### 10) Conclusi√≥n ‚Äî ¬øqu√© recordar?

- Un **Rogue AP** puede ser tan inofensivo como la intenci√≥n de un empleado, o tan peligroso como la puerta de entrada de un atacante. La protecci√≥n real requiere **pol√≠ticas claras**, **controles en la red cableada (802.1X, port-security, DHCP snooping)** y **monitorizaci√≥n inal√°mbrica** (WIDS/WIPS y site surveys).
- Combina gobernanza, t√©cnica y educaci√≥n: eso reduce dr√°sticamente la probabilidad de que un rogue AP provoque una brecha.

---

[üîº](#√≠ndice)

---

## **322. ¬øQu√© es un punto de acceso no autorizado?**

### üìå ¬øQu√© es un punto de acceso no autorizado?

Un **punto de acceso no autorizado (Rogue AP)** es cualquier dispositivo de red inal√°mbrico que se conecta a tu infraestructura de forma **no controlada o sin autorizaci√≥n del equipo de TI**.

Puede ser:

- Un **router dom√©stico** conectado por accidente a la red corporativa.
- Un **AP malicioso** colocado por un atacante para robar credenciales o espiar tr√°fico.
- Un **AP no gestionado** instalado por un tercero (proveedor, empleado, contratista).

üëâ El problema es que estos dispositivos **abren una puerta trasera** a tu red interna y evaden las medidas de seguridad oficiales.

### üìå Tipos de puntos de acceso no autorizados

1. **Rogue AP accidental (benigno):** empleado conecta su router Wi-Fi personal para ‚Äúmejorar se√±al‚Äù.
2. **Rogue AP malicioso:** atacante instala un AP para tener acceso remoto y lanzar ataques internos.
3. **Evil Twin:** atacante crea un AP con el mismo nombre (SSID) que el leg√≠timo para enga√±ar a usuarios y capturar credenciales.
4. **Mal configurado:** AP leg√≠timo pero con contrase√±as d√©biles, firmware desactualizado o cifrado inseguro (ej. WEP).

### üìå C√≥mo los atacantes explotan los puntos de acceso no autorizados

- **Captura de tr√°fico**: recolectan datos no cifrados (usuarios, contrase√±as, cookies de sesi√≥n).
- **Phishing inal√°mbrico**: redirigen a portales falsos para robar credenciales.
- **Acceso interno**: si el AP est√° conectado a la red corporativa, permite entrada a recursos internos.
- **Ataques MitM (Man-in-the-Middle):** interceptan y modifican comunicaciones.
- **Pivotaje**: usan el AP para entrar a la red y luego moverse lateralmente hacia servidores cr√≠ticos.

### üìå Ejemplos reales de ataques con AP no autorizados

1. **Aeropuertos y cafeter√≠as**: ciberdelincuentes crean Wi-Fi ‚Äúgratis‚Äù con SSID parecido al oficial (‚ÄúFreeAirportWiFi‚Äù) ‚Üí capturan credenciales bancarias.
2. **Empresa financiera**: un empleado conecta un router en su oficina para conectar su celular ‚Üí el router ten√≠a WPS activado y un atacante lo explot√≥ para entrar en la red.
3. **Ataque Evil Twin en conferencias**: AP con el mismo SSID de la Wi-Fi oficial del evento ‚Üí robo masivo de credenciales de correo.

### üìå C√≥mo detectar puntos de acceso no autorizados

- **Monitoreo inal√°mbrico (WIDS/WIPS):** detecta SSIDs, BSSIDs y APs no registrados.
- **Auditor√≠as de red cableada:** revisar puertos de switch para APs desconocidos.
- **Inspecci√≥n de DHCP:** ver si aparecen servidores DHCP extra√±os.
- **An√°lisis RF (site surveys):** identificar se√±ales sospechosas y su ubicaci√≥n f√≠sica.
- **Logs centralizados (SIEM):** alertas ante dispositivos no reconocidos.

### üìå C√≥mo mitigar y prevenir incidentes con AP no autorizados

‚úÖ **Pol√≠ticas claras:** prohibir que empleados conecten APs sin autorizaci√≥n.

‚úÖ **Cerrar puertos de switch no usados.**

‚úÖ **802.1X / NAC:** autenticar dispositivos antes de dar acceso a la red.

‚úÖ **DHCP Snooping / ARP Inspection:** bloquear APs que act√∫en como servidores DHCP.

‚úÖ **Segmentaci√≥n:** separar redes corporativas, invitados y dispositivos IoT.

‚úÖ **WPA2/WPA3-Enterprise:** usar certificados en lugar de contrase√±as compartidas.

‚úÖ **Inspecciones f√≠sicas y site surveys peri√≥dicos.**

### üìå Herramientas y tecnolog√≠as recomendadas para detecci√≥n y protecci√≥n

- **WIDS/WIPS empresariales:** Cisco, Aruba, Ruckus, Fortinet.
- **Escaneo y an√°lisis Wi-Fi:**

  - **Kismet** (detecci√≥n pasiva de APs).
  - **Ekahau / AirMagnet** (site surveys profesionales).

- **Monitoreo de red:**

  - **NAC (Cisco ISE, Aruba ClearPass).**
  - **SIEM (Splunk, ELK, QRadar)** para correlacionar eventos.

- **Controles de switch (Cisco IOS, Juniper, HP Aruba):** port-security, DHCP snooping, Dynamic ARP Inspection.

### üìå Conclusi√≥n

Los **puntos de acceso no autorizados** representan una amenaza silenciosa pero muy peligrosa:

- Pueden abrir puertas traseras a la red interna.
- Permiten ataques de espionaje, phishing y pivotaje.
- Son dif√≠ciles de detectar sin herramientas espec√≠ficas.

La **defensa en capas** es clave: pol√≠ticas claras, monitoreo inal√°mbrico (WIDS/WIPS), controles en la red cableada (802.1X, port-security, DHCP snooping), segmentaci√≥n y auditor√≠as peri√≥dicas.

### üìå Preguntas frecuentes (FAQ)

**üîπ ¬øUn router dom√©stico conectado por un empleado cuenta como Rogue AP?**

S√≠. Aunque no sea malicioso, introduce vulnerabilidades graves.

**üîπ ¬øCu√°l es la diferencia entre Rogue AP y Evil Twin?**

- _Rogue AP_: conectado dentro de tu red (por empleado o atacante).
- _Evil Twin_: imita tu red leg√≠tima para enga√±ar usuarios desde fuera.

**üîπ ¬øC√≥mo s√© si tengo un Rogue AP en la red?**

Con WIDS/WIPS, auditor√≠as de switch y site surveys RF.

**üîπ ¬øEl WPA3 evita los Rogue AP?**

No directamente. WPA3 protege la comunicaci√≥n, pero si el AP es no autorizado dentro de la red, sigue siendo un riesgo.

---

[üîº](#√≠ndice)

---

| **Inicio**         | **atr√°s 11**                   | **Siguiente 13**                 |
| ------------------ | ------------------------------ | -------------------------------- |
| [üè†](../README.md) | [‚è™](./10_11_Replay_Attack.md) | [‚è©](./10_13_Buffer_Overflow.md) |
