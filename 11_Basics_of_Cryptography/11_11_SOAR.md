| **Inicio**         | **atr√°s 10**          |
| ------------------ | --------------------- |
| [üè†](../README.md) | [‚è™](./11_10_SIEM.md) |

---

## **√çndice**

| Temario                                                                                                                                        |
| ---------------------------------------------------------------------------------------------------------------------------------------------- |
| [356. ¬øQu√© es SOAR?](#356-qu√©-es-soar)                                                                                                         |
| [357. ¬øQu√© es SOAR (Seguridad, Orquestaci√≥n, Automatizaci√≥n y Respuesta)?](#357-qu√©-es-soar-seguridad-orquestaci√≥n-automatizaci√≥n-y-respuesta) |

| |

# **SOAR**

## **356. ¬øQu√© es SOAR?**

![SOAR](/img/11_Basics_of_Cryptography/SOAR.webp "SOAR")

### üîπ ¬øQu√© es SOAR?

**SOAR (Security Orchestration, Automation and Response)** es un conjunto de herramientas y procesos que permiten a un equipo de seguridad:

1. **Orquestar**: integrar diferentes tecnolog√≠as de seguridad (SIEM, firewalls, EDR, herramientas de inteligencia de amenazas, etc.).
2. **Automatizar**: ejecutar tareas repetitivas sin intervenci√≥n humana (ej. bloquear una IP maliciosa, resetear contrase√±as).
3. **Responder**: aplicar procedimientos estandarizados (playbooks) para manejar incidentes de seguridad.

üëâ Ejemplo:

Un SIEM detecta m√∫ltiples intentos de inicio de sesi√≥n fallidos ‚Üí el SOAR recibe esa alerta ‚Üí consulta una base de datos de inteligencia de amenazas (TIM) ‚Üí confirma que la IP es maliciosa ‚Üí autom√°ticamente bloquea la IP en el firewall ‚Üí abre un ticket en Jira para seguimiento.

### üîπ ¬øQu√© es SIEM?

**SIEM (Security Information and Event Management)** es una plataforma que:

- Recoge y centraliza logs de m√∫ltiples fuentes (firewalls, endpoints, servidores, aplicaciones, cloud).
- Analiza y correlaciona eventos para detectar amenazas.
- Genera alertas cuando se cumplen ciertas reglas (ej. 10 intentos fallidos de login).
- Almacena registros para auditor√≠as y cumplimiento.

üëâ Ejemplo:

El SIEM detecta que un usuario inici√≥ sesi√≥n en Per√∫ y 10 minutos despu√©s en Londres ‚Üí alerta de login imposible ‚Üí env√≠a la alerta al SOC.

üìå Diferencia clave:

- **SIEM = detecci√≥n (visi√≥n y alertas).**
- **SOAR = acci√≥n (respuesta autom√°tica o guiada).**

### üîπ ¬øQu√© es la orquestaci√≥n y automatizaci√≥n de la seguridad?

- **Orquestaci√≥n** = conectar varias herramientas de seguridad en un solo flujo coordinado.

  Ejemplo: SIEM + EDR + firewall + inteligencia de amenazas ‚Üí trabajando juntos.

- **Automatizaci√≥n** = ejecutar acciones sin intervenci√≥n humana.
  Ejemplo: cuando un EDR detecta ransomware, SOAR ordena al firewall aislar la m√°quina y al sistema de backups iniciar restauraci√≥n.

### üîπ ¬øQu√© es la gesti√≥n de inteligencia de amenazas (TIM)?

**TIM (Threat Intelligence Management)** es la pr√°ctica de **recopilar, organizar y usar informaci√≥n sobre amenazas cibern√©ticas** (IPs maliciosas, dominios de phishing, malware conocido).

- Se integra con SIEM y SOAR para enriquecer alertas.
- Permite priorizar incidentes: no todas las alertas son igual de cr√≠ticas.

üëâ Ejemplo:

Una IP aparece en los logs de tu firewall ‚Üí TIM verifica que esa IP est√° en una blacklist global de C2 (Command & Control) ‚Üí el incidente se marca como ‚Äúcr√≠tico‚Äù.

### üîπ ¬øPor qu√© es importante SOAR?

- **Reduce el tiempo de respuesta** (de horas a minutos).
- **Evita errores humanos** en tareas repetitivas.
- **Escala la capacidad del SOC** sin contratar m√°s analistas.
- **Estandariza** procesos de seguridad (playbooks).
- **Mejora la colaboraci√≥n** entre herramientas que normalmente no se comunican.

üëâ Sin SOAR:

El analista recibe 500 alertas ‚Üí revisa manualmente ‚Üí investiga IP ‚Üí bloquea en firewall ‚Üí notifica.

üëâ Con SOAR:

SOAR recibe la alerta ‚Üí la enriquece con TIM ‚Üí decide acci√≥n ‚Üí bloquea IP ‚Üí notifica al analista ‚Üí registra en ticket.

### üîπ El valor de tener y utilizar SOAR

- **Ahorro de tiempo**: elimina tareas repetitivas (ej. buscar hash en VirusTotal).
- **Mayor eficacia**: respuesta inmediata ante ransomware, phishing, exfiltraci√≥n de datos.
- **Menos fatiga de alertas**: filtra falsos positivos antes de llegar al analista.
- **Cumplimiento normativo**: mantiene registro de todas las acciones autom√°ticas tomadas.

### üîπ Casos de uso de SOAR

1. **Phishing**

   - Detecci√≥n de correo sospechoso.
   - SOAR revisa reputaci√≥n de URLs/adjuntos.
   - A√≠sla el correo en todas las bandejas.
   - Cierra el incidente en el sistema de tickets.

2. **Ransomware en endpoint**

   - SIEM detecta procesos sospechosos.
   - SOAR ordena al EDR aislar el host.
   - Ejecuta script de contenci√≥n.
   - Lanza ticket de recuperaci√≥n.

3. **Brute force en Active Directory**

   - Alerta de login fallido m√∫ltiple.
   - SOAR desactiva la cuenta.
   - Bloquea la IP atacante en el firewall.
   - Notifica al SOC.

4. **Threat hunting autom√°tico**

   - SOAR recibe IOC de una feed de inteligencia.
   - Busca en logs hist√≥ricos del SIEM.
   - Reporta si hay actividad sospechosa relacionada.

### üîπ Qu√© buscar en una plataforma SOAR

- **Integraciones** con SIEM, EDR, firewalls, correo, ticketing.
- **Playbooks preconstruidos** (para phishing, ransomware, brute force).
- **Automatizaci√≥n flexible** (crear tus propios flujos).
- **Dashboards claros** (MTTR, n√∫mero de incidentes, tipos de amenazas).
- **Soporte de TIM** (conectar con feeds de inteligencia de amenazas).
- **Capacidades de case management** (gesti√≥n de incidentes de principio a fin).

### üîπ Preguntas frecuentes sobre SOAR

**1. ¬øSOAR reemplaza al SIEM?**

No. SOAR **complementa** al SIEM: el SIEM detecta y alerta, el SOAR act√∫a.

**2. ¬øNecesito SIEM para usar SOAR?**

No necesariamente, pero juntos son mucho m√°s efectivos. El SIEM alimenta al SOAR con alertas.

**3. ¬øSOAR elimina al analista de seguridad?**

No. Automatiza tareas repetitivas para que el analista se concentre en investigaci√≥n avanzada.

**4. ¬øQu√© diferencia hay entre SOAR y XDR?**

- **SOAR** = respuesta orquestada y automatizada.
- **XDR** = detecci√≥n y respuesta extendida en m√∫ltiples capas (endpoint, red, cloud).
  Muchas veces se complementan.

‚úÖ En resumen:

- **SIEM = detecta y centraliza eventos.**
- **SOAR = responde autom√°ticamente y coordina herramientas.**
- **TIM = alimenta con inteligencia para mejorar decisiones.**
- **Orquestaci√≥n y automatizaci√≥n** = la clave para ganar velocidad y eficiencia contra los atacantes.

---

[üîº](#√≠ndice)

---

## **357. ¬øQu√© es SOAR (Seguridad, Orquestaci√≥n, Automatizaci√≥n y Respuesta)?**

### ¬øQu√© es SOAR (Seguridad, Orquestaci√≥n, Automatizaci√≥n y Respuesta)?

**SOAR** (Security Orchestration, Automation and Response) es una categor√≠a de soluciones y pr√°cticas que permiten a los equipos de seguridad **orquestar herramientas**, **automatizar tareas repetitivas** y **ejecutar respuestas** a incidentes de forma r√°pida, consistente y documentada. En la pr√°ctica, un sistema SOAR conecta el _ecosistema de seguridad_ (SIEM, EDR, firewall, threat intel, tickets, correo, etc.), ejecuta _playbooks_ (flujos de trabajo definidos) y realiza acciones autom√°ticas o semiautom√°ticas para contener, enriquecer y resolver alertas.

### Componentes clave de una plataforma SOAR

1. **Orquestador / Conectores**

   - APIs y conectores listos para SIEM, EDR, firewalls, proxies, soluciones cloud, servicios de ticketing, VirusTotal, etc.
   - Permiten ejecutar acciones (bloquear IP, aislar host, obtener artefactos).

2. **Motor de automatizaci√≥n (Playbooks)**

   - Flujos visuales o basados en scripts que describen pasos a ejecutar ante un trigger (alerta).
   - Pueden ser condicionales, paralelos y con aprobaciones humanas (gateways).

3. **Case management (Gesti√≥n de incidentes)**

   - Consola para triage, asignaci√≥n, evidencias, timeline y reporting.
   - Registra todas las acciones (auditable).

4. **Threat Intelligence Management (TIM)**

   - Ingesta y gesti√≥n de feeds de IOCs/IOAs, reputaci√≥n y enriquecimiento autom√°tico.

5. **Orquestaci√≥n humana (Human-in-the-loop)**

   - Permite pedir aprobaci√≥n humana en pasos cr√≠ticos (ej. bloquear IP en producci√≥n).

6. **Reporting y m√©tricas**

   - KPIs: MTTD, MTTR, n√∫mero de playbooks ejecutados, ahorro estimado.

### ¬øC√≥mo funciona (flujo t√≠pico)?

1. **Trigger**: SIEM / EDR genera una alerta (ej. hash malicioso, beaconing detectado).
2. **Ingest & Enrichment**: SOAR recibe la alerta, consulta TIM, VirusTotal, WHOIS, Passive DNS, y a√±ade contexto (reputaci√≥n, asset criticality).
3. **Decisi√≥n / Playbook**: basado en reglas (confidence, criticidad), el playbook decide: autom√°ticamente ejecutar acciones o pedir aprobaci√≥n.
4. **Automatizaci√≥n**: acciones como bloquear IP en firewall, aislar host en EDR, revocar sesi√≥n, crear ticket en ITSM.
5. **Investigaci√≥n y closure**: el caso guarda evidencias y pasos; si hay falsopositivo, se documenta; si es real, se remedia y se genera informe.

### Ejemplos concretos (playbooks ilustrativos)

#### 1) Phishing (playbook resumido)

- **Trigger**: Mail Gateway marca correo sospechoso o usuario reporta phishing.
- **Pasos autom√°ticos**:

  1. Extraer remitente, URLs y adjuntos.
  2. Consultar TIM / VirusTotal / URLScan.
  3. Si URL o hash malicioso (score > umbral) ‚Üí quitar correo de bandejas (via API de correo).
  4. Crear ticket en ITSM y notificar usuario y manager.
  5. Ejecutar b√∫squeda en SIEM para identificar clicks previos.

- **Human-in-loop**: confirmaci√≥n antes de bloquear URL de dominio corporativo.

#### 2) Ransomware (playbook resumido)

- **Trigger**: EDR detecta comportamiento de cifrado masivo.
- **Pasos autom√°ticos**:

  1. Aislar endpoint (EDR API).
  2. Generar snapshot / volcado de memoria (forense).
  3. Bloquear cuentas comprometidas (AD) y accesos remotos.
  4. Iniciar restauraci√≥n de backups y notificar legal/PR.

- **Human-in-loop**: decidir restauraci√≥n y comunicaciones externas.

#### 3) Brute Force (playbook resumido)

- **Trigger**: SIEM detecta intentos fallidos masivos contra una cuenta.
- **Pasos autom√°ticos**:

  1. Confirmar con TIM si IP es maliciosa.
  2. Si s√≠ ‚Üí bloquear IP en firewall, desactivar cuenta temporal y exigir reset MFA.
  3. Crear ticket y buscar actividad lateral relacionada.

### Ejemplo de pseudoc√≥digo de acci√≥n (Python-like, ilustrativo)

```python
def handle_alert(alert):
    context = enrich_with_threat_intel(alert.ip, alert.hash)
    if context['vt_score'] > 70 or context['is_blacklisted']:
        # action: block IP
        firewall.block_ip(alert.ip)
        edr.isolate_host(alert.host_id)
        ticket = itsm.create_ticket(alert, context)
        log_audit("blocked", alert, context, ticket.id)
    else:
        ticket = itsm.create_ticket(alert, context, priority="low")
        notify_analyst(ticket.id)
```

> Este c√≥digo es ejemplo de l√≥gica; en SOAR real se implementa con conectores y playbooks visuales.

### ¬øPor qu√© SOAR es importante? Valor y beneficios

- **Reducci√≥n del tiempo de respuesta** (MTTR): automatiza las tareas que antes eran manuales.
- **Escalabilidad del SOC**: un analista puede supervisar muchos m√°s incidentes.
- **Consistencia**: playbooks garantizan que las respuestas sigan pol√≠ticas y registros auditables.
- **Mejora de calidad de alertas**: SOAR puede filtrar falsos positivos mediante enriquecimiento antes de escalar.
- **Documentaci√≥n y cumplimiento**: registro completo de acciones para auditor√≠a/regulatorio.
- **Ahorro de costes**: menos horas manuales, menos impacto de incidentes.

### Qu√© buscar en una plataforma SOAR (lista pr√°ctica)

- Amplia **biblioteca de integraciones** (SIEM, EDR, firewall, MDM, GSuite/Office365, ServiceNow).
- **Editor de playbooks** visual e intuitivo + soporte de scripting.
- **Gesti√≥n de casos** integrada con auditor√≠a y evidencia.
- **Soporte TIM** y facilidad para a√±adir feeds.
- **Funcionalidad human-in-the-loop** (aprobaciones, escalados).
- **Escalabilidad y multitenancy** (si es para MSSP).
- **Seguridad**: roles, encriptaci√≥n de secretos, logging completo.
- **Capacidad de testing / sandbox** para validar playbooks sin impacto.
- **Reporting / KPIs** integrados.

### Riesgos, limitaciones y buenas pr√°cticas

**Riesgos**

- Automatizar acciones destructivas sin controles puede causar outages (ej. bloquear IPs leg√≠timas).
- Dependencia de API externas y credenciales: gesti√≥n de secretos cr√≠tica.
- Playbooks mal dise√±ados pueden amplificar errores.

**Buenas pr√°cticas**

- **Empezar con playbooks no destructivos** (enriquecer, crear ticket) y luego a√±adir acciones autom√°ticas gradualmente.
- **Human-in-the-loop** para acciones sensibles en producci√≥n.
- **Testing riguroso** en entorno de staging.
- **Versionado y revisi√≥n** de playbooks (control de cambios).
- **M√©tricas y SLAs**: medir MTTD/MTTR, tasa de falsos positivos, ahorro de tiempo.
- **Gesti√≥n de credenciales** y rotaci√≥n segura.

### M√©tricas √∫tiles (KPIs) para justificar SOAR

- **MTTD** (Mean Time to Detect) antes y despu√©s.
- **MTTR** (Mean Time to Respond).
- **N√∫mero de alertas automatizadas** / por playbook.
- **Horas-hombre ahorradas** (estimadas por procesos).
- **N√∫mero de incidentes resueltos por analista**.
- **Tasa de errores (acciones revertidas)** tras automatizaci√≥n.

### Preguntas frecuentes r√°pidas

- **¬øSOAR reemplaza a los analistas?** No; automatiza tareas repetitivas y libera tiempo para an√°lisis avanzado.
- **¬øPuedo usar SOAR sin SIEM?** S√≠, pero SOAR es m√°s potente cuando se integra a un SIEM que provee alertas ricas.
- **¬øEs peligroso automatizar bloqueos?** Puede serlo si no se controla. Recomiendo empezar con automatizaciones no destructivas y a√±adir aprobaciones.
- **¬øQu√© herramientas SOAR populares existen?** (ejemplos): Cortex XSOAR, Splunk Phantom, IBM Resilient, Swimlane, Demisto (aunque hay solapamiento y evoluci√≥n constante en el mercado).
  _(Menci√≥n informativa ‚Äî evaluar seg√∫n necesidades, integraciones y presupuesto.)_

### Resumen ‚Äî ¬øCu√°ndo implementar SOAR?

Implementa SOAR cuando:

- Tu SOC recibe muchas alertas repetitivas.
- Deseas reducir el MTTR y documentar acciones autom√°ticamente.
- Necesitas coordinar m√∫ltiples herramientas y acciones (firewall, EDR, tickets).
- Quieres escalar tu capacidad sin multiplicar personal.

---

[üîº](#√≠ndice)

---

| **Inicio**         | **atr√°s 10**          |
| ------------------ | --------------------- |
| [üè†](../README.md) | [‚è™](./11_10_SIEM.md) |
