| **Inicio**         | **atrás 12**                      | **Siguiente 14**      |
| ------------------ | --------------------------------- | --------------------- |
| [🏠](../README.md) | [⏪](./12_12_Firewalls_&_Next.md) | [⏩](./12_14_NIDS.md) |

---

## **Índice**

| Temario                                                                                                                                        |
| ---------------------------------------------------------------------------------------------------------------------------------------------- |
| [381. ¿Qué es un sistema de prevención de intrusiones?](#381-qué-es-un-sistema-de-prevención-de-intrusiones)                                   |
| [382. ¿Qué es el sistema de prevención de intrusiones en el host (HIPS)?](#382-qué-es-el-sistema-de-prevención-de-intrusiones-en-el-host-hips) |

# **Sistema de prevención de intrusiones en el host (HIPS)**

## **381. ¿Qué es un sistema de prevención de intrusiones?**

![HIPS](/img/12_Secure_vs_Unsecure_Protocols/HIPS.jpg "HIPS")

Un **IPS (Intrusion Prevention System)** es una solución de seguridad de red diseñada para **detectar, analizar y bloquear automáticamente actividades maliciosas o sospechosas** en tiempo real, antes de que afecten a los sistemas.

👉 Diferencia clave:

- **IDS (Intrusion Detection System)**: detecta y alerta.
- **IPS (Intrusion Prevention System)**: detecta y **bloquea de inmediato**.

Ejemplo:

- Un IDS avisa que alguien intenta explotar una vulnerabilidad en tu servidor web.
- Un IPS no solo avisa, sino que **bloquea la conexión** del atacante en el acto.

### ⚙️ ¿Cómo funcionan los sistemas de prevención de intrusiones?

Los IPS funcionan en línea (in-line) dentro del flujo de tráfico de red.

1. **Monitoreo de tráfico**: inspecciona todo el tráfico entrante y saliente.
2. **Análisis en tiempo real**: compara el tráfico con:

   - **Firmas** de ataques conocidos.
   - **Análisis heurístico y de comportamiento** para ataques desconocidos.

3. **Acción preventiva**:

   - Bloquear paquetes maliciosos.
   - Terminar conexiones sospechosas.
   - Notificar al administrador de seguridad.

👉 Ejemplo:

Si un atacante envía un exploit de SQL Injection en una petición HTTP, el IPS puede reconocer el patrón y **detener la petición antes de que llegue al servidor web**.

### 📂 Tipos de sistemas de prevención de intrusiones

1. **NIPS (Network-based IPS)**

   - Se despliega en la red para inspeccionar tráfico general.
   - Ejemplo: Fortinet FortiGate inspeccionando tráfico de toda la empresa.

2. **WIPS (Wireless IPS)**

   - Protege redes inalámbricas contra accesos no autorizados y ataques Wi-Fi.
   - Ejemplo: detectar un _rogue access point_ que suplanta la red legítima.

3. **HIPS (Host-based IPS)**

   - Instalado en servidores o endpoints para protegerlos individualmente.
   - Ejemplo: un HIPS en un servidor de base de datos que bloquea intentos de escalada de privilegios.

4. **NGIPS (Next-Generation IPS)**

   - IPS avanzados que incluyen DPI, inteligencia de amenazas y sandboxing.
   - Ejemplo: Cisco Firepower NGIPS que usa datos globales para detectar ataques 0-day.

### ✅ Beneficios de los sistemas de prevención de intrusiones

- **Bloqueo proactivo**: detienen ataques en tiempo real.
- **Cumplimiento normativo**: ayudan con GDPR, HIPAA, PCI DSS.
- **Protección contra amenazas avanzadas**: como ransomware y APTs.
- **Reducción de riesgos internos y externos**.
- **Visibilidad de la red**: detectan qué aplicaciones y servicios generan riesgos.

👉 Ejemplo práctico:

En un banco, un IPS puede bloquear conexiones hacia IPs conocidas por robo de credenciales bancarias, protegiendo datos sensibles de clientes.

### 🔑 Características críticas de un IPS

1. **Inspección profunda de paquetes (DPI)**.
2. **Detección basada en firmas** (ataques conocidos).
3. **Detección basada en anomalías** (comportamiento inusual).
4. **Prevención automática** (no solo alerta).
5. **Soporte para SSL/TLS inspection** (tráfico cifrado).
6. **Actualizaciones de inteligencia de amenazas en tiempo real**.
7. **Integración con firewalls, SIEM y SOC**.

### 🤖 Aprendizaje profundo para la detección de amenazas evasivas

Los atacantes modernos usan técnicas de **evasión**, como:

- Fragmentación de paquetes.
- Codificación de payloads.
- Uso de tráfico cifrado.

Para enfrentarse a esto, los IPS más avanzados usan **machine learning y deep learning**:

- **Analizan patrones de tráfico** para identificar anomalías.
- Detectan **amenazas desconocidas (zero-day)** que no tienen firma.
- Mejoran su precisión reduciendo falsos positivos.

👉 Ejemplo:

Un IPS con IA puede detectar que un flujo HTTPS “aparentemente normal” en realidad contiene tráfico de **C2 (command and control)** de un malware, y bloquearlo.

### ❓ Preguntas frecuentes sobre IPS

#### 🔹 ¿Qué diferencia hay entre IDS e IPS?

- IDS: detecta y alerta.
- IPS: detecta y **bloquea automáticamente**.

#### 🔹 ¿Un IPS reemplaza al firewall?

No. Un firewall controla accesos (puertos, IPs, protocolos). Un IPS analiza el **contenido del tráfico** y detecta ataques más sofisticados. Se complementan.

#### 🔹 ¿Dónde se instala un IPS?

En línea, en puntos estratégicos de la red (frontera con Internet, DMZ, segmento interno crítico).

#### 🔹 ¿Qué ataques puede detener un IPS?

- Exploits de vulnerabilidades.
- Fuerza bruta.
- SQL Injection, XSS.
- Malware y ransomware.
- Tráfico de botnets.

#### 🔹 ¿Qué limitaciones tiene un IPS?

- Puede generar **falsos positivos** si no está bien configurado.
- El tráfico cifrado puede ocultar ataques (requiere inspección SSL).
- Requiere **actualización constante de firmas** e inteligencia de amenazas.

✅ **Resumen final**

Un **IPS es esencial en la ciberseguridad moderna** porque no solo detecta ataques, sino que los **bloquea en tiempo real**. Puede ser de red, inalámbrico, host o de nueva generación. Su efectividad aumenta cuando se combina con **IA, firewalls y SIEM** para proteger de amenazas conocidas y desconocidas.

---

[🔼](#índice)

---

## **382. ¿Qué es el sistema de prevención de intrusiones en el host (HIPS)?**

Un **HIPS (Host-based Intrusion Prevention System)** es un software de seguridad instalado en un **dispositivo específico (endpoint o servidor)** que **monitorea, detecta y bloquea actividades maliciosas** en ese equipo en tiempo real.

👉 A diferencia de un IPS de red (NIPS), que protege todo el tráfico de la red, el **HIPS protege un dispositivo individual**.

Ejemplo:

- En un servidor de bases de datos, un HIPS puede bloquear intentos de escalada de privilegios.
- En una laptop corporativa, un HIPS puede detectar un exploit que intenta aprovechar una vulnerabilidad de Windows.

### ❓ Preguntas frecuentes sobre HIPS

#### 🔹 ¿Qué es un sistema de prevención de intrusiones en el host (HIPS)?

Es una solución de seguridad que:

1. Supervisa la actividad del sistema operativo y de las aplicaciones.
2. Detecta comportamientos anómalos (modificación no autorizada de archivos, cambios en el registro, instalación de drivers maliciosos).
3. Aplica medidas preventivas como **bloquear el proceso, aislar el archivo o detener la ejecución**.

👉 Ejemplo:

Si un ransomware intenta cifrar archivos del sistema, el HIPS puede **detener el proceso sospechoso antes de que complete la acción**.

#### 🔹 ¿En qué se diferencia un HIPS de un software antivirus tradicional?

Aunque ambos protegen el host, funcionan de manera distinta:

| Característica    | **Antivirus** 🦠                                     | **HIPS** 🛡️                                                                                 |
| ----------------- | ---------------------------------------------------- | ------------------------------------------------------------------------------------------- |
| **Enfoque**       | Busca y elimina malware conocido (basado en firmas). | Detecta y bloquea comportamientos sospechosos, incluso de amenazas desconocidas (zero-day). |
| **Protección**    | Reactiva: elimina después de identificar.            | Proactiva: bloquea antes de que se ejecute el ataque.                                       |
| **Actualización** | Requiere bases de datos de virus.                    | Puede usar firmas + análisis heurístico y de comportamiento.                                |
| **Ejemplo**       | Detecta un virus descargado por email.               | Detecta que ese virus intenta modificar el registro de Windows y lo bloquea.                |

👉 **Conclusión**:

- El antivirus es “curativo”.
- El HIPS es “preventivo”.
  Lo ideal es **usarlos en conjunto**.

#### 🔹 ¿Cuáles son algunos de los beneficios de utilizar un HIPS?

1. **Prevención proactiva**: bloquea ataques antes de que dañen el host.
2. **Protección contra amenazas desconocidas (zero-day)**.
3. **Monitoreo del sistema en profundidad**:

   - Cambios en el registro.
   - Acceso a archivos críticos.
   - Modificación de configuraciones del sistema.

4. **Cumplimiento normativo** (PCI DSS, HIPAA, ISO 27001).
5. **Reducción de riesgos internos**: bloquea procesos sospechosos iniciados por usuarios legítimos pero malintencionados.

👉 Ejemplo práctico:

En una empresa financiera, un HIPS puede detener un keylogger que intenta instalarse en la laptop de un empleado, protegiendo credenciales bancarias.

#### 🔹 ¿Es un HIPS adecuado para todo tipo de organizaciones?

Depende de varios factores:

✅ **Adecuado para**:

- Empresas con **datos críticos** (bancos, salud, gobierno).
- Servidores expuestos a Internet (bases de datos, aplicaciones web).
- Organizaciones que necesitan **cumplir regulaciones de seguridad**.

⚠️ **Limitaciones**:

- Puede generar **falsos positivos** si no está bien configurado.
- Consume recursos del host (CPU, memoria).
- Puede ser complejo de gestionar en **grandes infraestructuras** (requiere integración con SIEM o consola centralizada).

👉 Ejemplo:

- Una startup pequeña podría usar solo un antivirus avanzado.
- Un hospital, en cambio, necesita **HIPS en todos sus servidores** para proteger historiales clínicos.

### ✅ Resumen

- El **HIPS** es una capa extra de seguridad instalada directamente en cada host.
- Se diferencia del antivirus porque actúa de manera **proactiva** bloqueando comportamientos sospechosos.
- Sus beneficios incluyen **prevención de ataques zero-day, protección profunda del sistema y cumplimiento normativo**.
- Es más útil en organizaciones que manejan **datos sensibles o sistemas críticos**.

---

[🔼](#índice)

---

| **Inicio**         | **atrás 12**                      | **Siguiente 14**      |
| ------------------ | --------------------------------- | --------------------- |
| [🏠](../README.md) | [⏪](./12_12_Firewalls_&_Next.md) | [⏩](./12_14_NIDS.md) |
