| **Inicio**         | **atrÃ¡s 12**                      | **Siguiente 14**      |
| ------------------ | --------------------------------- | --------------------- |
| [ğŸ ](../README.md) | [âª](./12_12_Firewalls_&_Next.md) | [â©](./12_14_NIDS.md) |

---

## **Ãndice**

| Temario                                                                                                                                        |
| ---------------------------------------------------------------------------------------------------------------------------------------------- |
| [381. Â¿QuÃ© es un sistema de prevenciÃ³n de intrusiones?](#381-quÃ©-es-un-sistema-de-prevenciÃ³n-de-intrusiones)                                   |
| [382. Â¿QuÃ© es el sistema de prevenciÃ³n de intrusiones en el host (HIPS)?](#382-quÃ©-es-el-sistema-de-prevenciÃ³n-de-intrusiones-en-el-host-hips) |

# **Sistema de prevenciÃ³n de intrusiones en el host (HIPS)**

## **381. Â¿QuÃ© es un sistema de prevenciÃ³n de intrusiones?**

![HIPS](/img/12_Secure_vs_Unsecure_Protocols/HIPS.jpg "HIPS")

Un **IPS (Intrusion Prevention System)** es una soluciÃ³n de seguridad de red diseÃ±ada para **detectar, analizar y bloquear automÃ¡ticamente actividades maliciosas o sospechosas** en tiempo real, antes de que afecten a los sistemas.

ğŸ‘‰ Diferencia clave:

- **IDS (Intrusion Detection System)**: detecta y alerta.
- **IPS (Intrusion Prevention System)**: detecta y **bloquea de inmediato**.

Ejemplo:

- Un IDS avisa que alguien intenta explotar una vulnerabilidad en tu servidor web.
- Un IPS no solo avisa, sino que **bloquea la conexiÃ³n** del atacante en el acto.

### âš™ï¸ Â¿CÃ³mo funcionan los sistemas de prevenciÃ³n de intrusiones?

Los IPS funcionan en lÃ­nea (in-line) dentro del flujo de trÃ¡fico de red.

1. **Monitoreo de trÃ¡fico**: inspecciona todo el trÃ¡fico entrante y saliente.
2. **AnÃ¡lisis en tiempo real**: compara el trÃ¡fico con:

   - **Firmas** de ataques conocidos.
   - **AnÃ¡lisis heurÃ­stico y de comportamiento** para ataques desconocidos.

3. **AcciÃ³n preventiva**:

   - Bloquear paquetes maliciosos.
   - Terminar conexiones sospechosas.
   - Notificar al administrador de seguridad.

ğŸ‘‰ Ejemplo:

Si un atacante envÃ­a un exploit de SQL Injection en una peticiÃ³n HTTP, el IPS puede reconocer el patrÃ³n y **detener la peticiÃ³n antes de que llegue al servidor web**.

### ğŸ“‚ Tipos de sistemas de prevenciÃ³n de intrusiones

1. **NIPS (Network-based IPS)**

   - Se despliega en la red para inspeccionar trÃ¡fico general.
   - Ejemplo: Fortinet FortiGate inspeccionando trÃ¡fico de toda la empresa.

2. **WIPS (Wireless IPS)**

   - Protege redes inalÃ¡mbricas contra accesos no autorizados y ataques Wi-Fi.
   - Ejemplo: detectar un _rogue access point_ que suplanta la red legÃ­tima.

3. **HIPS (Host-based IPS)**

   - Instalado en servidores o endpoints para protegerlos individualmente.
   - Ejemplo: un HIPS en un servidor de base de datos que bloquea intentos de escalada de privilegios.

4. **NGIPS (Next-Generation IPS)**

   - IPS avanzados que incluyen DPI, inteligencia de amenazas y sandboxing.
   - Ejemplo: Cisco Firepower NGIPS que usa datos globales para detectar ataques 0-day.

### âœ… Beneficios de los sistemas de prevenciÃ³n de intrusiones

- **Bloqueo proactivo**: detienen ataques en tiempo real.
- **Cumplimiento normativo**: ayudan con GDPR, HIPAA, PCI DSS.
- **ProtecciÃ³n contra amenazas avanzadas**: como ransomware y APTs.
- **ReducciÃ³n de riesgos internos y externos**.
- **Visibilidad de la red**: detectan quÃ© aplicaciones y servicios generan riesgos.

ğŸ‘‰ Ejemplo prÃ¡ctico:

En un banco, un IPS puede bloquear conexiones hacia IPs conocidas por robo de credenciales bancarias, protegiendo datos sensibles de clientes.

### ğŸ”‘ CaracterÃ­sticas crÃ­ticas de un IPS

1. **InspecciÃ³n profunda de paquetes (DPI)**.
2. **DetecciÃ³n basada en firmas** (ataques conocidos).
3. **DetecciÃ³n basada en anomalÃ­as** (comportamiento inusual).
4. **PrevenciÃ³n automÃ¡tica** (no solo alerta).
5. **Soporte para SSL/TLS inspection** (trÃ¡fico cifrado).
6. **Actualizaciones de inteligencia de amenazas en tiempo real**.
7. **IntegraciÃ³n con firewalls, SIEM y SOC**.

### ğŸ¤– Aprendizaje profundo para la detecciÃ³n de amenazas evasivas

Los atacantes modernos usan tÃ©cnicas de **evasiÃ³n**, como:

- FragmentaciÃ³n de paquetes.
- CodificaciÃ³n de payloads.
- Uso de trÃ¡fico cifrado.

Para enfrentarse a esto, los IPS mÃ¡s avanzados usan **machine learning y deep learning**:

- **Analizan patrones de trÃ¡fico** para identificar anomalÃ­as.
- Detectan **amenazas desconocidas (zero-day)** que no tienen firma.
- Mejoran su precisiÃ³n reduciendo falsos positivos.

ğŸ‘‰ Ejemplo:

Un IPS con IA puede detectar que un flujo HTTPS â€œaparentemente normalâ€ en realidad contiene trÃ¡fico de **C2 (command and control)** de un malware, y bloquearlo.

### â“ Preguntas frecuentes sobre IPS

#### ğŸ”¹ Â¿QuÃ© diferencia hay entre IDS e IPS?

- IDS: detecta y alerta.
- IPS: detecta y **bloquea automÃ¡ticamente**.

#### ğŸ”¹ Â¿Un IPS reemplaza al firewall?

No. Un firewall controla accesos (puertos, IPs, protocolos). Un IPS analiza el **contenido del trÃ¡fico** y detecta ataques mÃ¡s sofisticados. Se complementan.

#### ğŸ”¹ Â¿DÃ³nde se instala un IPS?

En lÃ­nea, en puntos estratÃ©gicos de la red (frontera con Internet, DMZ, segmento interno crÃ­tico).

#### ğŸ”¹ Â¿QuÃ© ataques puede detener un IPS?

- Exploits de vulnerabilidades.
- Fuerza bruta.
- SQL Injection, XSS.
- Malware y ransomware.
- TrÃ¡fico de botnets.

#### ğŸ”¹ Â¿QuÃ© limitaciones tiene un IPS?

- Puede generar **falsos positivos** si no estÃ¡ bien configurado.
- El trÃ¡fico cifrado puede ocultar ataques (requiere inspecciÃ³n SSL).
- Requiere **actualizaciÃ³n constante de firmas** e inteligencia de amenazas.

âœ… **Resumen final**

Un **IPS es esencial en la ciberseguridad moderna** porque no solo detecta ataques, sino que los **bloquea en tiempo real**. Puede ser de red, inalÃ¡mbrico, host o de nueva generaciÃ³n. Su efectividad aumenta cuando se combina con **IA, firewalls y SIEM** para proteger de amenazas conocidas y desconocidas.

---

[ğŸ”¼](#Ã­ndice)

---

## **382. Â¿QuÃ© es el sistema de prevenciÃ³n de intrusiones en el host (HIPS)?**

Un **HIPS (Host-based Intrusion Prevention System)** es un software de seguridad instalado en un **dispositivo especÃ­fico (endpoint o servidor)** que **monitorea, detecta y bloquea actividades maliciosas** en ese equipo en tiempo real.

ğŸ‘‰ A diferencia de un IPS de red (NIPS), que protege todo el trÃ¡fico de la red, el **HIPS protege un dispositivo individual**.

Ejemplo:

- En un servidor de bases de datos, un HIPS puede bloquear intentos de escalada de privilegios.
- En una laptop corporativa, un HIPS puede detectar un exploit que intenta aprovechar una vulnerabilidad de Windows.

### â“ Preguntas frecuentes sobre HIPS

#### ğŸ”¹ Â¿QuÃ© es un sistema de prevenciÃ³n de intrusiones en el host (HIPS)?

Es una soluciÃ³n de seguridad que:

1. Supervisa la actividad del sistema operativo y de las aplicaciones.
2. Detecta comportamientos anÃ³malos (modificaciÃ³n no autorizada de archivos, cambios en el registro, instalaciÃ³n de drivers maliciosos).
3. Aplica medidas preventivas como **bloquear el proceso, aislar el archivo o detener la ejecuciÃ³n**.

ğŸ‘‰ Ejemplo:

Si un ransomware intenta cifrar archivos del sistema, el HIPS puede **detener el proceso sospechoso antes de que complete la acciÃ³n**.

#### ğŸ”¹ Â¿En quÃ© se diferencia un HIPS de un software antivirus tradicional?

Aunque ambos protegen el host, funcionan de manera distinta:

| CaracterÃ­stica    | **Antivirus** ğŸ¦                                      | **HIPS** ğŸ›¡ï¸                                                                                 |
| ----------------- | ---------------------------------------------------- | ------------------------------------------------------------------------------------------- |
| **Enfoque**       | Busca y elimina malware conocido (basado en firmas). | Detecta y bloquea comportamientos sospechosos, incluso de amenazas desconocidas (zero-day). |
| **ProtecciÃ³n**    | Reactiva: elimina despuÃ©s de identificar.            | Proactiva: bloquea antes de que se ejecute el ataque.                                       |
| **ActualizaciÃ³n** | Requiere bases de datos de virus.                    | Puede usar firmas + anÃ¡lisis heurÃ­stico y de comportamiento.                                |
| **Ejemplo**       | Detecta un virus descargado por email.               | Detecta que ese virus intenta modificar el registro de Windows y lo bloquea.                |

ğŸ‘‰ **ConclusiÃ³n**:

- El antivirus es â€œcurativoâ€.
- El HIPS es â€œpreventivoâ€.
  Lo ideal es **usarlos en conjunto**.

#### ğŸ”¹ Â¿CuÃ¡les son algunos de los beneficios de utilizar un HIPS?

1. **PrevenciÃ³n proactiva**: bloquea ataques antes de que daÃ±en el host.
2. **ProtecciÃ³n contra amenazas desconocidas (zero-day)**.
3. **Monitoreo del sistema en profundidad**:

   - Cambios en el registro.
   - Acceso a archivos crÃ­ticos.
   - ModificaciÃ³n de configuraciones del sistema.

4. **Cumplimiento normativo** (PCI DSS, HIPAA, ISO 27001).
5. **ReducciÃ³n de riesgos internos**: bloquea procesos sospechosos iniciados por usuarios legÃ­timos pero malintencionados.

ğŸ‘‰ Ejemplo prÃ¡ctico:

En una empresa financiera, un HIPS puede detener un keylogger que intenta instalarse en la laptop de un empleado, protegiendo credenciales bancarias.

#### ğŸ”¹ Â¿Es un HIPS adecuado para todo tipo de organizaciones?

Depende de varios factores:

âœ… **Adecuado para**:

- Empresas con **datos crÃ­ticos** (bancos, salud, gobierno).
- Servidores expuestos a Internet (bases de datos, aplicaciones web).
- Organizaciones que necesitan **cumplir regulaciones de seguridad**.

âš ï¸ **Limitaciones**:

- Puede generar **falsos positivos** si no estÃ¡ bien configurado.
- Consume recursos del host (CPU, memoria).
- Puede ser complejo de gestionar en **grandes infraestructuras** (requiere integraciÃ³n con SIEM o consola centralizada).

ğŸ‘‰ Ejemplo:

- Una startup pequeÃ±a podrÃ­a usar solo un antivirus avanzado.
- Un hospital, en cambio, necesita **HIPS en todos sus servidores** para proteger historiales clÃ­nicos.

### âœ… Resumen

- El **HIPS** es una capa extra de seguridad instalada directamente en cada host.
- Se diferencia del antivirus porque actÃºa de manera **proactiva** bloqueando comportamientos sospechosos.
- Sus beneficios incluyen **prevenciÃ³n de ataques zero-day, protecciÃ³n profunda del sistema y cumplimiento normativo**.
- Es mÃ¡s Ãºtil en organizaciones que manejan **datos sensibles o sistemas crÃ­ticos**.

---

[ğŸ”¼](#Ã­ndice)

---

| **Inicio**         | **atrÃ¡s 12**                      | **Siguiente 14**      |
| ------------------ | --------------------------------- | --------------------- |
| [ğŸ ](../README.md) | [âª](./12_12_Firewalls_&_Next.md) | [â©](./12_14_NIDS.md) |
