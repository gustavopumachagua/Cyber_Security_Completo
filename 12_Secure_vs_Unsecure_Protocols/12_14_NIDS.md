| **Inicio**         | **atrás 13**          | **Siguiente 15**      |
| ------------------ | --------------------- | --------------------- |
| [🏠](../README.md) | [⏪](./12_13_HIPS.md) | [⏩](./12_15_NIPS.md) |

---

## **Índice**

| Temario                                                                                                                              |
| ------------------------------------------------------------------------------------------------------------------------------------ |
| [383. ¿Qué es un sistema de detección de intrusiones?](#383-qué-es-un-sistema-de-detección-de-intrusiones)                           |
| [384. ¿Qué es un sistema de detección de intrusiones en red (NIDS)?](#384-qué-es-un-sistema-de-detección-de-intrusiones-en-red-nids) |

# **Sistema de detección de intrusiones en la red (NIDS)**

## **383. ¿Qué es un sistema de detección de intrusiones?**

![NIDS](/img/12_Secure_vs_Unsecure_Protocols/NIDS.png "NIDS")

Un **IDS (Intrusion Detection System)** es una herramienta de **seguridad informática** que **monitorea el tráfico de red o la actividad en los sistemas** para detectar **comportamientos sospechosos, accesos no autorizados o ataques conocidos**.

👉 Importante: Un IDS **no bloquea el ataque** (como lo haría un IPS), sino que **genera alertas** para que los administradores de seguridad actúen.

Ejemplo:

- Si un atacante intenta hacer un **escaneo de puertos** en un servidor web, el IDS detecta el patrón anómalo y genera una alerta.

### ⚔️ IDS vs IPS (Sistemas de Detección vs Prevención de Intrusiones)

| Característica   | **IDS (Detection)**                                       | **IPS (Prevention)**                                         |
| ---------------- | --------------------------------------------------------- | ------------------------------------------------------------ |
| Acción principal | Detecta y alerta                                          | Detecta y bloquea                                            |
| Funcionamiento   | Pasivo                                                    | Activo                                                       |
| Ejemplo          | Te avisa que alguien está intentando entrar a tu servidor | Bloquea automáticamente la IP del atacante                   |
| Riesgo           | El ataque puede completarse si no se actúa rápido         | Puede generar falsos positivos que bloqueen tráfico legítimo |

👉 En la práctica, muchos sistemas modernos combinan ambas funciones (**IDPS: Intrusion Detection and Prevention System**).

### ⚙️ ¿Cómo funciona un IDS?

Un IDS puede operar a nivel de **red (NIDS)** o de **host (HIDS)** y sigue este flujo:

1. **Captura de datos** → recopila tráfico de red o logs del sistema.
2. **Análisis** → compara contra bases de firmas conocidas o busca anomalías.
3. **Generación de alertas** → envía notificaciones al SOC (Security Operations Center).

Ejemplo:

- Si un usuario normal descarga 10 MB diarios y de repente sube 1 GB a un servidor externo, el IDS detecta la **anomalía de tráfico** y genera una alerta.

### 🛠️ Tipos de detección en IDS

1. **Basado en firmas** 🔍

   - Detecta ataques conocidos comparando patrones con una base de datos.
   - Ejemplo: reconoce un malware específico si coincide con la firma de tráfico.
   - Limitación: no detecta ataques nuevos (**zero-day**).

2. **Basado en anomalías** 📊

   - Crea un perfil de tráfico “normal” y detecta desviaciones.
   - Ejemplo: detecta que un usuario de oficina intenta conectarse a la base de datos del servidor central a medianoche.
   - Ventaja: puede identificar amenazas desconocidas.

3. **Basado en comportamiento** 👤

   - Analiza las acciones de usuarios o aplicaciones y detecta comportamientos maliciosos.
   - Ejemplo: un empleado intenta copiar toda la carpeta de clientes a un USB.

### 🔐 IDS vs. Cortafuegos

| Característica     | **IDS**                                                                 | **Firewall**                                           |
| ------------------ | ----------------------------------------------------------------------- | ------------------------------------------------------ |
| Función            | Detectar intrusiones                                                    | Bloquear accesos no autorizados                        |
| Nivel de operación | Capa de red y aplicación                                                | Capa de red (principalmente)                           |
| Reacción           | Genera alertas                                                          | Permite o deniega tráfico                              |
| Ejemplo            | Detecta que alguien está intentando explotar una vulnerabilidad en HTTP | Bloquea todo el tráfico entrante al puerto 23 (Telnet) |

👉 En conjunto: El **firewall controla el acceso** y el **IDS detecta ataques dentro del tráfico permitido**.

### 🕵️‍♂️ Técnicas de evasión de IDS

Los atacantes intentan pasar inadvertidos ante el IDS usando técnicas como:

- **Fragmentación de paquetes** → dividir un ataque en paquetes pequeños.
- **Ofuscación** → modificar el payload para que no coincida con firmas conocidas.
- **Evasión de tiempo** → enviar tráfico malicioso muy lentamente para no generar anomalías.
- **Cifrado** → usar HTTPS o VPN para ocultar el contenido.

Ejemplo: un atacante puede ocultar un ataque SQL Injection dentro de una petición encriptada por HTTPS, lo que dificulta que un IDS basado en firmas lo detecte.

### 📌 ¿Por qué son importantes los sistemas de detección de intrusiones?

1. **Detección temprana de amenazas** antes de que causen daño.
2. **Cumplimiento regulatorio** (PCI DSS, ISO 27001, HIPAA).
3. **Visibilidad de la red** → saber qué sucede dentro de la organización.
4. **Respuesta a incidentes más rápida**.
5. **Protección contra amenazas internas y externas**.

### ❓ Preguntas frecuentes sobre IDS

#### 🔹 ¿Un IDS reemplaza al firewall?

No 🚫. El IDS complementa al firewall. El firewall **bloquea accesos no autorizados**, mientras que el IDS **detecta intrusiones en el tráfico que ya pasó el firewall**.

#### 🔹 ¿IDS siempre bloquea ataques?

No. Un IDS solo **detecta y alerta**. Para bloquear ataques se necesita un **IPS**.

#### 🔹 ¿Dónde se instala un IDS?

- En el **punto de entrada/salida de la red** (NIDS).
- En servidores o estaciones específicas (HIDS).

#### 🔹 ¿Ejemplos de IDS conocidos?

- **Snort** (open source, muy usado).
- **Suricata** (más avanzado, multihilo).
- **OSSEC** (para HIDS).

### ✅ Resumen

- El **IDS** es un sistema que **detecta intrusiones pero no las bloquea**.
- Se diferencia del **IPS**, que además **previene**.
- Puede trabajar **basado en firmas, anomalías o comportamiento**.
- Es un **complemento del firewall**, no un reemplazo.
- Es crucial para la **detección temprana y respuesta a incidentes**.

---

[🔼](#índice)

---

## **384. ¿Qué es un sistema de detección de intrusiones en red (NIDS)?**

Un **NIDS** es un **IDS (Intrusion Detection System)** especializado en monitorear el **tráfico de red** para detectar ataques, accesos no autorizados o anomalías.

👉 En lugar de analizar solo un host específico (como hace un **HIDS**), el **NIDS** observa todo lo que pasa por segmentos de la red.

📌 Ejemplo:

- Si un atacante lanza un **escaneo de puertos** contra todos los equipos de una red corporativa, el NIDS lo detecta y genera una alerta.

### ⚙️ ¿Cómo funciona un NIDS?

Un NIDS sigue este proceso:

1. **Captura de tráfico**

   - Se conecta a un switch en modo "port mirroring" o a un punto de enlace de red para inspeccionar los paquetes.

2. **Análisis**

   - Compara los paquetes con **firmas conocidas** (ataques ya registrados).
   - O analiza patrones en busca de **anomalías**.

3. **Generación de alertas**

   - Si detecta actividad sospechosa, **notifica al administrador de seguridad** o al **SOC (Security Operations Center)**.

4. **Registro de eventos (logs)**

   - Guarda evidencia de los intentos de ataque para un análisis forense posterior.

📌 Ejemplo práctico:

- El NIDS detecta un paquete con la cadena "`' OR '1'='1`", que corresponde a un intento de **SQL Injection** en una aplicación web, y lanza una alerta.

### 🔀 Varios tipos de IDS

Existen diferentes enfoques de IDS según **qué monitorean**:

1. **NIDS (Network-based IDS)**

   - Vigila el tráfico de red.
   - Ejemplo: **Snort**, **Suricata**.

2. **HIDS (Host-based IDS)**

   - Se instala en un servidor o equipo individual y vigila su comportamiento.
   - Ejemplo: **OSSEC**.

3. **IDPS (Intrusion Detection and Prevention System)**

   - Combinan IDS + IPS (prevención).
   - Ejemplo: algunos NGFW modernos.

### 📊 Tipos de detección de IDS basados en anomalías

Cuando hablamos de **detección por anomalías**, el sistema compara la actividad actual con lo que se considera “normal”. Hay varios tipos:

1. **Basado en comportamiento (behavioral-based)**

   - Detecta patrones de uso anormales en usuarios o dispositivos.
   - Ejemplo: un empleado que siempre accede a la red de 9am-6pm empieza a conectarse a las 3am.

2. **Basado en estadística (statistical-based)**

   - Usa métricas de tráfico y genera alertas cuando hay desviaciones significativas.
   - Ejemplo: el tráfico promedio en un servidor es de 10 Mbps, pero de repente sube a 500 Mbps → posible ataque DDoS.

3. **Basado en machine learning o IA**

   - Usa algoritmos de aprendizaje automático para identificar amenazas nuevas (zero-day).
   - Ejemplo: un sistema entrenado detecta que un flujo de tráfico encriptado tiene un patrón similar al de un ransomware.

### ✅ Resumen

- Un **NIDS** analiza **todo el tráfico de red**, a diferencia del HIDS que protege solo un host.
- Funciona capturando paquetes, comparando con firmas y buscando anomalías.
- Los **tipos de IDS** incluyen NIDS, HIDS e IDPS.
- Los **IDS basados en anomalías** pueden usar comportamiento, estadísticas o IA para detectar amenazas desconocidas.

---

[🔼](#índice)

---

| **Inicio**         | **atrás 13**          | **Siguiente 15**      |
| ------------------ | --------------------- | --------------------- |
| [🏠](../README.md) | [⏪](./12_13_HIPS.md) | [⏩](./12_15_NIPS.md) |
