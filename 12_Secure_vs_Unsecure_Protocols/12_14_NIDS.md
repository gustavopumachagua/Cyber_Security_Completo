| **Inicio**         | **atrÃ¡s 13**          | **Siguiente 15**      |
| ------------------ | --------------------- | --------------------- |
| [ğŸ ](../README.md) | [âª](./12_13_HIPS.md) | [â©](./12_15_NIPS.md) |

---

## **Ãndice**

| Temario                                                                                                                              |
| ------------------------------------------------------------------------------------------------------------------------------------ |
| [383. Â¿QuÃ© es un sistema de detecciÃ³n de intrusiones?](#383-quÃ©-es-un-sistema-de-detecciÃ³n-de-intrusiones)                           |
| [384. Â¿QuÃ© es un sistema de detecciÃ³n de intrusiones en red (NIDS)?](#384-quÃ©-es-un-sistema-de-detecciÃ³n-de-intrusiones-en-red-nids) |

# **Sistema de detecciÃ³n de intrusiones en la red (NIDS)**

## **383. Â¿QuÃ© es un sistema de detecciÃ³n de intrusiones?**

![NIDS](/img/12_Secure_vs_Unsecure_Protocols/NIDS.png "NIDS")

Un **IDS (Intrusion Detection System)** es una herramienta de **seguridad informÃ¡tica** que **monitorea el trÃ¡fico de red o la actividad en los sistemas** para detectar **comportamientos sospechosos, accesos no autorizados o ataques conocidos**.

ğŸ‘‰ Importante: Un IDS **no bloquea el ataque** (como lo harÃ­a un IPS), sino que **genera alertas** para que los administradores de seguridad actÃºen.

Ejemplo:

- Si un atacante intenta hacer un **escaneo de puertos** en un servidor web, el IDS detecta el patrÃ³n anÃ³malo y genera una alerta.

### âš”ï¸ IDS vs IPS (Sistemas de DetecciÃ³n vs PrevenciÃ³n de Intrusiones)

| CaracterÃ­stica   | **IDS (Detection)**                                       | **IPS (Prevention)**                                         |
| ---------------- | --------------------------------------------------------- | ------------------------------------------------------------ |
| AcciÃ³n principal | Detecta y alerta                                          | Detecta y bloquea                                            |
| Funcionamiento   | Pasivo                                                    | Activo                                                       |
| Ejemplo          | Te avisa que alguien estÃ¡ intentando entrar a tu servidor | Bloquea automÃ¡ticamente la IP del atacante                   |
| Riesgo           | El ataque puede completarse si no se actÃºa rÃ¡pido         | Puede generar falsos positivos que bloqueen trÃ¡fico legÃ­timo |

ğŸ‘‰ En la prÃ¡ctica, muchos sistemas modernos combinan ambas funciones (**IDPS: Intrusion Detection and Prevention System**).

### âš™ï¸ Â¿CÃ³mo funciona un IDS?

Un IDS puede operar a nivel de **red (NIDS)** o de **host (HIDS)** y sigue este flujo:

1. **Captura de datos** â†’ recopila trÃ¡fico de red o logs del sistema.
2. **AnÃ¡lisis** â†’ compara contra bases de firmas conocidas o busca anomalÃ­as.
3. **GeneraciÃ³n de alertas** â†’ envÃ­a notificaciones al SOC (Security Operations Center).

Ejemplo:

- Si un usuario normal descarga 10 MB diarios y de repente sube 1 GB a un servidor externo, el IDS detecta la **anomalÃ­a de trÃ¡fico** y genera una alerta.

### ğŸ› ï¸ Tipos de detecciÃ³n en IDS

1. **Basado en firmas** ğŸ”

   - Detecta ataques conocidos comparando patrones con una base de datos.
   - Ejemplo: reconoce un malware especÃ­fico si coincide con la firma de trÃ¡fico.
   - LimitaciÃ³n: no detecta ataques nuevos (**zero-day**).

2. **Basado en anomalÃ­as** ğŸ“Š

   - Crea un perfil de trÃ¡fico â€œnormalâ€ y detecta desviaciones.
   - Ejemplo: detecta que un usuario de oficina intenta conectarse a la base de datos del servidor central a medianoche.
   - Ventaja: puede identificar amenazas desconocidas.

3. **Basado en comportamiento** ğŸ‘¤

   - Analiza las acciones de usuarios o aplicaciones y detecta comportamientos maliciosos.
   - Ejemplo: un empleado intenta copiar toda la carpeta de clientes a un USB.

### ğŸ” IDS vs. Cortafuegos

| CaracterÃ­stica     | **IDS**                                                                 | **Firewall**                                           |
| ------------------ | ----------------------------------------------------------------------- | ------------------------------------------------------ |
| FunciÃ³n            | Detectar intrusiones                                                    | Bloquear accesos no autorizados                        |
| Nivel de operaciÃ³n | Capa de red y aplicaciÃ³n                                                | Capa de red (principalmente)                           |
| ReacciÃ³n           | Genera alertas                                                          | Permite o deniega trÃ¡fico                              |
| Ejemplo            | Detecta que alguien estÃ¡ intentando explotar una vulnerabilidad en HTTP | Bloquea todo el trÃ¡fico entrante al puerto 23 (Telnet) |

ğŸ‘‰ En conjunto: El **firewall controla el acceso** y el **IDS detecta ataques dentro del trÃ¡fico permitido**.

### ğŸ•µï¸â€â™‚ï¸ TÃ©cnicas de evasiÃ³n de IDS

Los atacantes intentan pasar inadvertidos ante el IDS usando tÃ©cnicas como:

- **FragmentaciÃ³n de paquetes** â†’ dividir un ataque en paquetes pequeÃ±os.
- **OfuscaciÃ³n** â†’ modificar el payload para que no coincida con firmas conocidas.
- **EvasiÃ³n de tiempo** â†’ enviar trÃ¡fico malicioso muy lentamente para no generar anomalÃ­as.
- **Cifrado** â†’ usar HTTPS o VPN para ocultar el contenido.

Ejemplo: un atacante puede ocultar un ataque SQL Injection dentro de una peticiÃ³n encriptada por HTTPS, lo que dificulta que un IDS basado en firmas lo detecte.

### ğŸ“Œ Â¿Por quÃ© son importantes los sistemas de detecciÃ³n de intrusiones?

1. **DetecciÃ³n temprana de amenazas** antes de que causen daÃ±o.
2. **Cumplimiento regulatorio** (PCI DSS, ISO 27001, HIPAA).
3. **Visibilidad de la red** â†’ saber quÃ© sucede dentro de la organizaciÃ³n.
4. **Respuesta a incidentes mÃ¡s rÃ¡pida**.
5. **ProtecciÃ³n contra amenazas internas y externas**.

### â“ Preguntas frecuentes sobre IDS

#### ğŸ”¹ Â¿Un IDS reemplaza al firewall?

No ğŸš«. El IDS complementa al firewall. El firewall **bloquea accesos no autorizados**, mientras que el IDS **detecta intrusiones en el trÃ¡fico que ya pasÃ³ el firewall**.

#### ğŸ”¹ Â¿IDS siempre bloquea ataques?

No. Un IDS solo **detecta y alerta**. Para bloquear ataques se necesita un **IPS**.

#### ğŸ”¹ Â¿DÃ³nde se instala un IDS?

- En el **punto de entrada/salida de la red** (NIDS).
- En servidores o estaciones especÃ­ficas (HIDS).

#### ğŸ”¹ Â¿Ejemplos de IDS conocidos?

- **Snort** (open source, muy usado).
- **Suricata** (mÃ¡s avanzado, multihilo).
- **OSSEC** (para HIDS).

### âœ… Resumen

- El **IDS** es un sistema que **detecta intrusiones pero no las bloquea**.
- Se diferencia del **IPS**, que ademÃ¡s **previene**.
- Puede trabajar **basado en firmas, anomalÃ­as o comportamiento**.
- Es un **complemento del firewall**, no un reemplazo.
- Es crucial para la **detecciÃ³n temprana y respuesta a incidentes**.

---

[ğŸ”¼](#Ã­ndice)

---

## **384. Â¿QuÃ© es un sistema de detecciÃ³n de intrusiones en red (NIDS)?**

Un **NIDS** es un **IDS (Intrusion Detection System)** especializado en monitorear el **trÃ¡fico de red** para detectar ataques, accesos no autorizados o anomalÃ­as.

ğŸ‘‰ En lugar de analizar solo un host especÃ­fico (como hace un **HIDS**), el **NIDS** observa todo lo que pasa por segmentos de la red.

ğŸ“Œ Ejemplo:

- Si un atacante lanza un **escaneo de puertos** contra todos los equipos de una red corporativa, el NIDS lo detecta y genera una alerta.

### âš™ï¸ Â¿CÃ³mo funciona un NIDS?

Un NIDS sigue este proceso:

1. **Captura de trÃ¡fico**

   - Se conecta a un switch en modo "port mirroring" o a un punto de enlace de red para inspeccionar los paquetes.

2. **AnÃ¡lisis**

   - Compara los paquetes con **firmas conocidas** (ataques ya registrados).
   - O analiza patrones en busca de **anomalÃ­as**.

3. **GeneraciÃ³n de alertas**

   - Si detecta actividad sospechosa, **notifica al administrador de seguridad** o al **SOC (Security Operations Center)**.

4. **Registro de eventos (logs)**

   - Guarda evidencia de los intentos de ataque para un anÃ¡lisis forense posterior.

ğŸ“Œ Ejemplo prÃ¡ctico:

- El NIDS detecta un paquete con la cadena "`' OR '1'='1`", que corresponde a un intento de **SQL Injection** en una aplicaciÃ³n web, y lanza una alerta.

### ğŸ”€ Varios tipos de IDS

Existen diferentes enfoques de IDS segÃºn **quÃ© monitorean**:

1. **NIDS (Network-based IDS)**

   - Vigila el trÃ¡fico de red.
   - Ejemplo: **Snort**, **Suricata**.

2. **HIDS (Host-based IDS)**

   - Se instala en un servidor o equipo individual y vigila su comportamiento.
   - Ejemplo: **OSSEC**.

3. **IDPS (Intrusion Detection and Prevention System)**

   - Combinan IDS + IPS (prevenciÃ³n).
   - Ejemplo: algunos NGFW modernos.

### ğŸ“Š Tipos de detecciÃ³n de IDS basados en anomalÃ­as

Cuando hablamos de **detecciÃ³n por anomalÃ­as**, el sistema compara la actividad actual con lo que se considera â€œnormalâ€. Hay varios tipos:

1. **Basado en comportamiento (behavioral-based)**

   - Detecta patrones de uso anormales en usuarios o dispositivos.
   - Ejemplo: un empleado que siempre accede a la red de 9am-6pm empieza a conectarse a las 3am.

2. **Basado en estadÃ­stica (statistical-based)**

   - Usa mÃ©tricas de trÃ¡fico y genera alertas cuando hay desviaciones significativas.
   - Ejemplo: el trÃ¡fico promedio en un servidor es de 10 Mbps, pero de repente sube a 500 Mbps â†’ posible ataque DDoS.

3. **Basado en machine learning o IA**

   - Usa algoritmos de aprendizaje automÃ¡tico para identificar amenazas nuevas (zero-day).
   - Ejemplo: un sistema entrenado detecta que un flujo de trÃ¡fico encriptado tiene un patrÃ³n similar al de un ransomware.

### âœ… Resumen

- Un **NIDS** analiza **todo el trÃ¡fico de red**, a diferencia del HIDS que protege solo un host.
- Funciona capturando paquetes, comparando con firmas y buscando anomalÃ­as.
- Los **tipos de IDS** incluyen NIDS, HIDS e IDPS.
- Los **IDS basados en anomalÃ­as** pueden usar comportamiento, estadÃ­sticas o IA para detectar amenazas desconocidas.

---

[ğŸ”¼](#Ã­ndice)

---

| **Inicio**         | **atrÃ¡s 13**          | **Siguiente 15**      |
| ------------------ | --------------------- | --------------------- |
| [ğŸ ](../README.md) | [âª](./12_13_HIPS.md) | [â©](./12_15_NIPS.md) |
