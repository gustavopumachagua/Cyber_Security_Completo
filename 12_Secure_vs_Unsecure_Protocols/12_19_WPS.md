| **Inicio**         | **atr√°s 18**                 | **Siguiente 20**     |
| ------------------ | ---------------------------- | -------------------- |
| [üè†](../README.md) | [‚è™](./12_18_EAP_vs_PEAP.md) | [‚è©](./12_20_ACL.md) |

---

## **√çndice**

| Temario                                                                            |
| ---------------------------------------------------------------------------------- |
| [392. ¬øQu√© es WPS y por qu√© es peligroso?](#392-qu√©-es-wps-y-por-qu√©-es-peligroso) |
| [393. WPS ‚Äì ¬øQu√© es y c√≥mo funciona?](#393-wps--qu√©-es-y-c√≥mo-funciona)            |
| [394. ¬øQu√© es WPS en WiFi?](#394-qu√©-es-wps-en-wifi)                               |

# **WPS**

## **392. ¬øQu√© es WPS y por qu√© es peligroso?**

![WPS](/img/12_Secure_vs_Unsecure_Protocols/WPS.jpg "WPS")

- **WPS (Wi-Fi Protected Setup)** es una funci√≥n creada para **facilitar la conexi√≥n de dispositivos Wi-Fi** a la red sin necesidad de introducir manualmente la contrase√±a.

- Se puede usar de dos formas:

  1. **Bot√≥n f√≠sico (WPS Button):** presionas el bot√≥n en el router y en el dispositivo, y se conectan autom√°ticamente.
  2. **PIN WPS:** introduces un PIN de 8 d√≠gitos para conectarte.

‚ö†Ô∏è El problema: aunque fue dise√±ado para la comodidad del usuario, **tiene vulnerabilidades graves** que permiten a atacantes conectarse a tu red sin conocer la clave Wi-Fi.

### üîπ Debilidades de la funci√≥n WPS

1. **PIN predecible:**

   - El PIN tiene **8 d√≠gitos**, pero en realidad solo **7 son √∫tiles** (el √∫ltimo es un d√≠gito de verificaci√≥n).
   - Adem√°s, se valida en dos mitades:

     - Los 4 primeros d√≠gitos ‚Üí validados primero.
     - Los 3 siguientes ‚Üí validados despu√©s.

   - Esto reduce enormemente el n√∫mero de intentos necesarios.

2. **Ataques de fuerza bruta factibles:**

   - Un atacante puede probar todas las combinaciones posibles en cuesti√≥n de horas.
   - Una vez que obtiene el PIN, puede recuperar la clave **WPA/WPA2-PSK** de la red.

3. **No siempre se puede deshabilitar:**

   - Muchos routers traen WPS **habilitado por defecto** y en algunos casos no se puede desactivar completamente.

### üîπ Descifrando el PIN WPS de 8 d√≠gitos

- Te√≥ricamente tendr√≠a **100 millones de combinaciones (10‚Å∏)**.
- En la pr√°ctica:

  - Validaci√≥n por mitades ‚Üí solo necesitas probar **10‚Å¥ + 10¬≥ = 11,000 intentos**.
  - Con hardware especializado, esto puede tardar **pocas horas**.

### üîπ Herramientas para descifrar el PIN WPS

Estas herramientas de auditor√≠a de seguridad se usan en entornos de **pentesting √©tico**:

- **Reaver** ‚Üí una de las m√°s conocidas para ataques de fuerza bruta WPS.
- **Bully** ‚Üí alternativa m√°s r√°pida, dise√±ada para sistemas Linux.
- **Wifite** ‚Üí automatiza ataques contra WPA/WPA2 y WPS.

### üîπ C√≥mo deshabilitar WPS en tu red

1. Ingresa al **panel de administraci√≥n del router** (ejemplo: `192.168.1.1`).
2. Ve a **Configuraci√≥n inal√°mbrica / Seguridad**.
3. Busca la opci√≥n **WPS** y selecciona **Deshabilitar**.
4. Guarda los cambios y reinicia el router.

### üîπ Acceder a la funci√≥n WPS

- Algunos routers permiten habilitar/deshabilitar WPS desde la **interfaz web**, otros desde una **app del fabricante**, y en muchos casos solo se activa presionando el **bot√≥n f√≠sico**.

### üîπ ¬øQu√© pasa si mi enrutador no proporciona la funci√≥n de desactivaci√≥n?

- En algunos modelos antiguos, aunque marques ‚Äúdeshabilitado‚Äù, el servicio WPS sigue activo.
- En ese caso:

  - Busca **actualizar el firmware del router**.
  - Si sigue sin deshabilitarse, lo m√°s seguro es **cambiar de router**.

### üîπ ¬øQu√© sucede despu√©s de deshabilitar la funci√≥n WPS?

- Tu red Wi-Fi seguir√° funcionando normalmente.
- Simplemente perder√°s la **funci√≥n de conexi√≥n r√°pida** con bot√≥n o PIN.
- Seguridad **mucho m√°s alta**, ya que eliminas una puerta de entrada com√∫n para atacantes.

### üîπ WPA-PSK, la alternativa segura

- La mejor pr√°ctica es usar **WPA2-PSK (AES)** o, si tu router lo soporta, **WPA3-PSK**.
- Usa una contrase√±a **larga, compleja y √∫nica** (m√≠nimo 12-16 caracteres con may√∫sculas, min√∫sculas, n√∫meros y s√≠mbolos).
- Ejemplo: `M1cR0s0ft$2025_Segur1dad!`

‚úÖ En conclusi√≥n: **WPS es inseguro y debe deshabilitarse siempre**. La alternativa segura es usar **WPA2/WPA3 con una clave fuerte**.

---

[üîº](#√≠ndice)

---

## **393. WPS ‚Äì ¬øQu√© es y c√≥mo funciona?**

### ¬øQu√© es WPS?

WPS (Wi-Fi Protected Setup) es un conjunto de mecanismos dise√±ados para **facilitar la conexi√≥n de dispositivos** a una red Wi-Fi sin tener que teclear manualmente la contrase√±a (PSK). Su objetivo era hacer m√°s simple conectar impresoras, c√°maras, televisores y otros dispositivos dom√©sticos.

Formas habituales de WPS:

**PBC (Push Button Configuration)**: pulsar un bot√≥n en el router y en el dispositivo para emparejar.

- **PIN (8 d√≠gitos)**: introducir un PIN de 8 d√≠gitos (impreso en el router o mostrado por el dispositivo).
- **Otros**: m√©todos menos comunes incluyen NFC o intercambio por USB en algunos equipos.

### ¬øC√≥mo funciona WPS? (visi√≥n pr√°ctica)

WPS define dos roles:

- **Registrar** (normalmente el router / punto de acceso) ‚Äî tiene la contrase√±a de la red.
- **Enrollee** (el dispositivo que quiere conectarse) ‚Äî solicita la credencial.

Flujo simplificado seg√∫n m√©todo:

**PBC (bot√≥n) ‚Äî ejemplo pr√°ctico:**

1. Pulsas el bot√≥n WPS en el router (abre una ventana corta de ‚Äúregistro‚Äù).
2. En el dispositivo (ej. impresora) activas la opci√≥n WPS.
3. Router y dispositivo intercambian la informaci√≥n de la red (SSID + clave) y el dispositivo queda conectado sin introducir la contrase√±a.

**PIN (8 d√≠gitos) ‚Äî c√≥mo funciona a alto nivel:**

1. El router act√∫a como registrar y el cliente (enrollee) env√≠a el PIN al registrar.
2. Si el PIN es correcto, el router env√≠a las credenciales de la red al dispositivo y √©ste queda conectado.

> Nota: el PIN de 8 d√≠gitos suena grande, pero el dise√±o del protocolo reduce dr√°sticamente la complejidad pr√°ctica ‚Äî ver secci√≥n de debilidades.

### Debilidades y por qu√© WPS es peligroso

WPS fue creado para conveniencia, pero tiene fallas de dise√±o que lo hacen inseguro:

1. **PIN de 8 d√≠gitos ‚Äî validaci√≥n en dos partes**

   - Aunque parecen $10^8 = 100{,}000{,}000$ combinaciones te√≥ricas, en la pr√°ctica **el √∫ltimo d√≠gito es un d√≠gito de verificaci√≥n (checksum)** y la validaci√≥n se realiza en dos bloques:

     - primeros 4 d√≠gitos (10‚Å¥ combinaciones)
     - siguientes 3 d√≠gitos (10¬≥ combinaciones)

   - C√°lculo (paso a paso):

     - $10^4 = 10 \times 10 \times 10 \times 10 = 10{,}000$
     - $10^3 = 10 \times 10 \times 10 = 1{,}000$
     - intentos necesarios ‚âà $10{,}000 + 1{,}000 = 11{,}000$

   - Resultado: en vez de decenas de millones, el espacio de b√∫squeda efectivo es del orden de **once mil** combinaciones, que es trivial para herramientas automatizadas si no hay protecciones (bloqueos, l√≠mites de reintentos, etc.).

2. **Ausencia de l√≠mites / bloqueo**

   - Muchos equipos no implementan limitaci√≥n de intentos o penalizaciones por reintentos, por lo que un atacante en rango puede probar muchas combinaciones hasta acertar.

3. **PIN por defecto / PIN imprimible**

   - Algunos routers traen PINs por defecto impresos en la etiqueta; si estos no se cambian, cualquiera con acceso f√≠sico al router o que haya visto la etiqueta puede conectarse.

4. **WPS PBC ‚Äî riesgo f√≠sico**

   - En entornos p√∫blicos o mal gestionados, alguien podr√≠a aprovechar la ventana de configuraci√≥n (si el bot√≥n fue activado o un panel de administraci√≥n lo permite) para conectar un dispositivo no autorizado.

5. **Implementaciones defectuosas**

   - Algunos fabricantes no siguieron bien las recomendaciones; existen modelos cuyos WPS no se apagan realmente aun cuando el usuario lo desactiva.

### Ejemplos pr√°cticos (ilustrativos y defensivos)

**Ejemplo A ‚Äî Hogar (conveniencia vs riesgo):**

- Situaci√≥n: quieres conectar una impresora nueva. Pulsas el bot√≥n WPS del router y pulsas WPS en la impresora ‚Üí f√°cil y r√°pido.
- Riesgo: si dejas WPS siempre habilitado (especialmente el m√©todo PIN), un atacante en la calle o edificio contiguo podr√≠a intentar explotar el PIN.

**Ejemplo B ‚Äî Caf√© o hotspot p√∫blico:**

- Nunca habilites PBC en un punto de acceso p√∫blico sin control: cualquiera podr√≠a conectarse durante la ventana WPS. En entornos p√∫blicos la recomendaci√≥n es **deshabilitar WPS**.

### Recomendaciones y mitigaciones (qu√© hacer)

1. **Desactiva WPS** en tu router si no lo necesitas. Es la mejor medida.

   - Accede a la interfaz de administraci√≥n del router (o app del fabricante) ‚Üí secci√≥n inal√°mbrica / seguridad ‚Üí desactivar WPS.

2. **Actualiza el firmware** del router: algunos modelos reciben parches que mejoran o corrigen comportamientos inseguros.
3. **Cambia contrase√±as por defecto** del administrador del router y desactiva acceso remoto a la configuraci√≥n.
4. **Usa WPA2-PSK (AES) o WPA3** con una contrase√±a larga y √∫nica (m√≠nimo 12‚Äì16 caracteres, preferible m√°s).
5. **Para empresas**: usa WPA2/WPA3-Enterprise (802.1X) en lugar de PSK y asegura un servidor RADIUS + certificados.
6. **Si no puedes desactivar WPS**: contacta al fabricante o considera reemplazar el equipo por uno moderno y gestionable.
7. **Registrar dispositivos invitados**: usa opciones alternativas seguras (QR para invitados, VLANs para aislamiento, captive portal para acceso temporal).

### ¬øQu√© sucede despu√©s de desactivar WPS?

- La red Wi-Fi seguir√° funcionando con la contrase√±a (PSK).
- Ya no podr√°s usar el bot√≥n WPS ni el PIN para emparejar dispositivos ‚Äî deber√°s introducir la contrase√±a manualmente o usar m√©todos seguros alternativos (QR, aprovisionamiento por administrador).
- Aumenta significativamente la seguridad al eliminar una puerta de entrada ampliamente explotada.

### Resumen y checklist r√°pido

- WPS = conveniencia, **pero inseguro**, especialmente el m√©todo PIN.
- El espacio efectivo de la clave PIN es ‚âà **11 000** intentos (no las 100 millones aparentes).
- **Recomendaci√≥n:** desact√≠valo; usa WPA2/WPA3 con contrase√±a fuerte o WPA-Enterprise en entornos corporativos.
- Si tu router no permite desactivar WPS: actualiza firmware, contacta al fabricante o cambia de equipo.

---

[üîº](#√≠ndice)

---

## **394. ¬øQu√© es WPS en WiFi?**

**WPS (Wi-Fi Protected Setup)** es un conjunto de mecanismos dise√±ados para **facilitar la conexi√≥n de dispositivos** a una red Wi-Fi sin tener que escribir la contrase√±a (PSK) manualmente. Apareci√≥ para que usuarios dom√©sticos pudieran emparejar impresoras, c√°maras, smart-TVs y smartphones de forma r√°pida y sin errores de tipeo.

Los m√©todos m√°s comunes de WPS son:

- **PBC (Push Button Configuration)** ‚Äî emparejamiento con un bot√≥n f√≠sico o virtual.
- **PIN (8 d√≠gitos)** ‚Äî introducci√≥n de un PIN que act√∫a como credencial temporal.
- M√©todos menos comunes: **NFC**, intercambio por **USB** o c√≥digos QR en algunos dispositivos.

### ¬øC√≥mo funciona? (visi√≥n general)

WPS involucra dos roles:

- **Registrar**: normalmente el router / punto de acceso (tiene la clave de la red).
- **Enrollee**: el dispositivo que quiere conectarse (impresora, tel√©fono, etc.).

Flujos simplificados:

- **PBC (bot√≥n)**: presionas el bot√≥n WPS en el router y activas WPS en el dispositivo dentro de una ventana de tiempo. Router y dispositivo negocian y el enrollee recibe la informaci√≥n de la red (SSID + clave) sin introducirla manualmente.
- **PIN**: el enrollee env√≠a un PIN de 8 d√≠gitos al registrar; si el router lo acepta, env√≠a la credencial Wi-Fi al dispositivo.

### Ejemplos pr√°cticos (leg√≠timos)

- **Conectar una impresora dom√©stica:** la impresora tiene una opci√≥n ‚ÄúConectar v√≠a WPS‚Äù. Presionas el bot√≥n WPS del router y luego inicias la b√∫squeda en la impresora ‚Üí se conectan sin escribir la contrase√±a.
- **Configurar un smart-TV:** algunos televisores muestran la opci√≥n ‚ÄúConectar con WPS PIN‚Äù: introduces el PIN que muestra el TV en el panel web del router (si el router lo solicita) y el televisor se conecta.
  Estos ejemplos muestran la conveniencia: ideal para usuarios no t√©cnicos o dispositivos sin teclado.

### ¬øPor qu√© WPS es peligroso? (debilidades principales)

WPS fue pensado para conveniencia, pero **tiene fallas de dise√±o y de implementaci√≥n** que lo hacen inseguro:

1. **Estructura del PIN de 8 d√≠gitos (y por qu√© es d√©bil)**

   - El PIN WPS tiene 8 d√≠gitos, pero **el √∫ltimo d√≠gito es un d√≠gito de verificaci√≥n (checksum)**.
   - Adem√°s, muchos implementaciones validan el PIN en **dos partes**: primeros 4 d√≠gitos y luego los siguientes 3 (el 8.¬∫ es checksum).
   - Matem√°ticamente:

     - Combinaciones te√≥ricas para 8 d√≠gitos:

       - $10 \times 10 \times 10 \times 10 \times 10 \times 10 \times 10 \times 10$
       - $=10^8$
       - $=10 \times 10 \times 10 \times 10 \times 10 \times 10 \times 10 \times 10$
       - $=100\,000\,000$ (cien millones).

     - Pero por la validaci√≥n en dos fases el espacio efectivo se reduce a:

       - primeros 4 d√≠gitos: $10 \times 10 \times 10 \times 10 = 10^4 = 10\,000$.
       - siguientes 3 d√≠gitos: $10 \times 10 \times 10 = 10^3 = 1\,000$.
       - intentos ‚âà $10\,000 + 1\,000 = 11\,000$.

     - Resultado: el espacio efectivo es del orden de **once mil** combinaciones, no cien millones ‚Äî eso lo hace susceptible a ataques automatizados.

2. **Falta (en muchos routers) de limitaci√≥n de intentos o bloqueo**

   - Si el router no impone retardos o bloqueos tras varios intentos err√≥neos, un atacante puede probar sistem√°ticamente esas \~11k combinaciones.

3. **PIN por defecto o imprimible en la etiqueta**

   - Muchos routers traen el PIN impreso en la etiqueta. Si no se cambia, cualquiera con acceso f√≠sico o que haya visto la etiqueta lo puede usar.

4. **Ventana de PBC**

   - El bot√≥n WPS abre una ventana breve para emparejar; si alguien malintencionado est√° en rango y activa su dispositivo en ese momento, puede conectarse.

5. **Implementaciones defectuosas**

   - Algunos modelos no desactivan realmente WPS aun cuando el UI indica que est√° ‚Äúoff‚Äù, o no aplican parches para vulnerabilidades conocidas.

> Nota importante: describir la vulnerabilidad y la matem√°tica del PIN es v√°lido para comprender el riesgo. No proporcionar√© instrucciones paso a paso ni comandos para explotar WPS.

### Escenarios ‚Äî ejemplo ilustrativo (no t√©cnico)

- **Casa**: Dejas WPS habilitado ‚Äúpor comodidad‚Äù. Un vecino con conocimientos t√©cnicos, estando dentro del rango Wi-Fi, puede usar herramientas de auditor√≠a para intentar los PINs hasta encontrar el correcto y obtener tu contrase√±a Wi-Fi.
- **Cafeter√≠a / hotspot**: Un empleado no autorizado podr√≠a activar PBC y conectar un dispositivo malicioso durante la ventana WPS si no hay controles.

### Herramientas (menci√≥n orientativa, uso √©tico)

En auditor√≠a de redes y pentesting autorizado se usan herramientas que automatizan intentos para comprobar la seguridad. Ejemplos conocidos (menciones, no instrucciones): **Reaver**, **Bully**, **Wifite**.
‚Äî Estas herramientas existen para pruebas de seguridad **con permiso expl√≠cito**; su uso en redes ajenas sin autorizaci√≥n es ilegal.

### C√≥mo proteger tu red (medidas pr√°cticas)

1. **Desactiva WPS** si no lo necesitas.

   - Accede al panel de administraci√≥n del router (p. ej. `192.168.1.1` o la app del fabricante) ‚Üí secci√≥n inal√°mbrica/seguridad ‚Üí opci√≥n WPS ‚Üí **Desactivar**.
   - Si tu modelo tiene un bot√≥n f√≠sico WPS, revisa su comportamiento (si es posible, desact√≠valo desde la UI).

2. **Actualiza el firmware** del router: corrige fallos de implementaci√≥n.
3. **Cambia la contrase√±a de administrador** del router (no usar ‚Äúadmin/admin‚Äù) y desactiva acceso remoto al panel.
4. **Usa WPA2-PSK (AES) o WPA3-PSK** con una contrase√±a larga y √∫nica (m√≠nimo 12‚Äì16 caracteres; idealmente m√°s).
5. **En entornos corporativos**, usa **WPA2/WPA3-Enterprise (802.1X + RADIUS)**, que evita PSK compartidos y es m√°s seguro.
6. **Si tu router no permite desactivar WPS**: contactar al fabricante, actualizar firmware o evaluar reemplazo por un equipo que permita gesti√≥n completa.
7. **Para invitados**: crea una red de invitados con PSK independiente o usa un portal cautivo o c√≥digos QR temporales para no compartir la clave principal.
8. **Registro de dispositivos**: si precisas facilidad para muchos dispositivos, centraliza aprovisionamiento seguro (MDM / perfil corporativo), no WPS.

### ¬øQu√© pasa cuando desactivas WPS?

- La Wi-Fi sigue funcionando normalmente con la contrase√±a (PSK).
- Pierdes la comodidad instant√°nea del bot√≥n o PIN, pero ganas seguridad: eliminas una vector de ataque explotado frecuentemente.

### Resumen pr√°ctico ‚Äî checklist r√°pido

- ‚úÖ ¬øWPS habilitado? ‚Üí **Desact√≠valo** si no lo necesitas.
- ‚úÖ ¬øRouter con firmware actualizado? ‚Üí Actualiza.
- ‚úÖ ¬øContrase√±a Wi-Fi fuerte? ‚Üí Usa WPA2/WPA3 con PSK largo y seguro.
- ‚úÖ ¬øEntorno corporativo? ‚Üí Migra a WPA-Enterprise (802.1X).
- ‚úÖ ¬øNo puedes desactivar WPS? ‚Üí Contacta fabricante o reemplaza hardware.

---

[üîº](#√≠ndice)

---

| **Inicio**         | **atr√°s 18**                 | **Siguiente 20**     |
| ------------------ | ---------------------------- | -------------------- |
| [üè†](../README.md) | [‚è™](./12_18_EAP_vs_PEAP.md) | [‚è©](./12_20_ACL.md) |
