| **Inicio**         | **atrÃ¡s 18**                 | **Siguiente 20**     |
| ------------------ | ---------------------------- | -------------------- |
| [ğŸ ](../README.md) | [âª](./12_18_EAP_vs_PEAP.md) | [â©](./12_20_ACL.md) |

---

## **Ãndice**

| Temario                                                                            |
| ---------------------------------------------------------------------------------- |
| [392. Â¿QuÃ© es WPS y por quÃ© es peligroso?](#392-quÃ©-es-wps-y-por-quÃ©-es-peligroso) |
| [393. WPS â€“ Â¿QuÃ© es y cÃ³mo funciona?](#393-wps--quÃ©-es-y-cÃ³mo-funciona)            |
| [394. Â¿QuÃ© es WPS en WiFi?](#394-quÃ©-es-wps-en-wifi)                               |

# **WPS**

## **392. Â¿QuÃ© es WPS y por quÃ© es peligroso?**

![WPS](/img/12_Secure_vs_Unsecure_Protocols/WPS.jpg "WPS")

- **WPS (Wi-Fi Protected Setup)** es una funciÃ³n creada para **facilitar la conexiÃ³n de dispositivos Wi-Fi** a la red sin necesidad de introducir manualmente la contraseÃ±a.

- Se puede usar de dos formas:

  1. **BotÃ³n fÃ­sico (WPS Button):** presionas el botÃ³n en el router y en el dispositivo, y se conectan automÃ¡ticamente.
  2. **PIN WPS:** introduces un PIN de 8 dÃ­gitos para conectarte.

âš ï¸ El problema: aunque fue diseÃ±ado para la comodidad del usuario, **tiene vulnerabilidades graves** que permiten a atacantes conectarse a tu red sin conocer la clave Wi-Fi.

### ğŸ”¹ Debilidades de la funciÃ³n WPS

1. **PIN predecible:**

   - El PIN tiene **8 dÃ­gitos**, pero en realidad solo **7 son Ãºtiles** (el Ãºltimo es un dÃ­gito de verificaciÃ³n).
   - AdemÃ¡s, se valida en dos mitades:

     - Los 4 primeros dÃ­gitos â†’ validados primero.
     - Los 3 siguientes â†’ validados despuÃ©s.

   - Esto reduce enormemente el nÃºmero de intentos necesarios.

2. **Ataques de fuerza bruta factibles:**

   - Un atacante puede probar todas las combinaciones posibles en cuestiÃ³n de horas.
   - Una vez que obtiene el PIN, puede recuperar la clave **WPA/WPA2-PSK** de la red.

3. **No siempre se puede deshabilitar:**

   - Muchos routers traen WPS **habilitado por defecto** y en algunos casos no se puede desactivar completamente.

### ğŸ”¹ Descifrando el PIN WPS de 8 dÃ­gitos

- TeÃ³ricamente tendrÃ­a **100 millones de combinaciones (10â¸)**.
- En la prÃ¡ctica:

  - ValidaciÃ³n por mitades â†’ solo necesitas probar **10â´ + 10Â³ = 11,000 intentos**.
  - Con hardware especializado, esto puede tardar **pocas horas**.

### ğŸ”¹ Herramientas para descifrar el PIN WPS

Estas herramientas de auditorÃ­a de seguridad se usan en entornos de **pentesting Ã©tico**:

- **Reaver** â†’ una de las mÃ¡s conocidas para ataques de fuerza bruta WPS.
- **Bully** â†’ alternativa mÃ¡s rÃ¡pida, diseÃ±ada para sistemas Linux.
- **Wifite** â†’ automatiza ataques contra WPA/WPA2 y WPS.

### ğŸ”¹ CÃ³mo deshabilitar WPS en tu red

1. Ingresa al **panel de administraciÃ³n del router** (ejemplo: `192.168.1.1`).
2. Ve a **ConfiguraciÃ³n inalÃ¡mbrica / Seguridad**.
3. Busca la opciÃ³n **WPS** y selecciona **Deshabilitar**.
4. Guarda los cambios y reinicia el router.

### ğŸ”¹ Acceder a la funciÃ³n WPS

- Algunos routers permiten habilitar/deshabilitar WPS desde la **interfaz web**, otros desde una **app del fabricante**, y en muchos casos solo se activa presionando el **botÃ³n fÃ­sico**.

### ğŸ”¹ Â¿QuÃ© pasa si mi enrutador no proporciona la funciÃ³n de desactivaciÃ³n?

- En algunos modelos antiguos, aunque marques â€œdeshabilitadoâ€, el servicio WPS sigue activo.
- En ese caso:

  - Busca **actualizar el firmware del router**.
  - Si sigue sin deshabilitarse, lo mÃ¡s seguro es **cambiar de router**.

### ğŸ”¹ Â¿QuÃ© sucede despuÃ©s de deshabilitar la funciÃ³n WPS?

- Tu red Wi-Fi seguirÃ¡ funcionando normalmente.
- Simplemente perderÃ¡s la **funciÃ³n de conexiÃ³n rÃ¡pida** con botÃ³n o PIN.
- Seguridad **mucho mÃ¡s alta**, ya que eliminas una puerta de entrada comÃºn para atacantes.

### ğŸ”¹ WPA-PSK, la alternativa segura

- La mejor prÃ¡ctica es usar **WPA2-PSK (AES)** o, si tu router lo soporta, **WPA3-PSK**.
- Usa una contraseÃ±a **larga, compleja y Ãºnica** (mÃ­nimo 12-16 caracteres con mayÃºsculas, minÃºsculas, nÃºmeros y sÃ­mbolos).
- Ejemplo: `M1cR0s0ft$2025_Segur1dad!`

âœ… En conclusiÃ³n: **WPS es inseguro y debe deshabilitarse siempre**. La alternativa segura es usar **WPA2/WPA3 con una clave fuerte**.

---

[ğŸ”¼](#Ã­ndice)

---

## **393. WPS â€“ Â¿QuÃ© es y cÃ³mo funciona?**

### Â¿QuÃ© es WPS?

WPS (Wi-Fi Protected Setup) es un conjunto de mecanismos diseÃ±ados para **facilitar la conexiÃ³n de dispositivos** a una red Wi-Fi sin tener que teclear manualmente la contraseÃ±a (PSK). Su objetivo era hacer mÃ¡s simple conectar impresoras, cÃ¡maras, televisores y otros dispositivos domÃ©sticos.

Formas habituales de WPS:

**PBC (Push Button Configuration)**: pulsar un botÃ³n en el router y en el dispositivo para emparejar.

- **PIN (8 dÃ­gitos)**: introducir un PIN de 8 dÃ­gitos (impreso en el router o mostrado por el dispositivo).
- **Otros**: mÃ©todos menos comunes incluyen NFC o intercambio por USB en algunos equipos.

### Â¿CÃ³mo funciona WPS? (visiÃ³n prÃ¡ctica)

WPS define dos roles:

- **Registrar** (normalmente el router / punto de acceso) â€” tiene la contraseÃ±a de la red.
- **Enrollee** (el dispositivo que quiere conectarse) â€” solicita la credencial.

Flujo simplificado segÃºn mÃ©todo:

**PBC (botÃ³n) â€” ejemplo prÃ¡ctico:**

1. Pulsas el botÃ³n WPS en el router (abre una ventana corta de â€œregistroâ€).
2. En el dispositivo (ej. impresora) activas la opciÃ³n WPS.
3. Router y dispositivo intercambian la informaciÃ³n de la red (SSID + clave) y el dispositivo queda conectado sin introducir la contraseÃ±a.

**PIN (8 dÃ­gitos) â€” cÃ³mo funciona a alto nivel:**

1. El router actÃºa como registrar y el cliente (enrollee) envÃ­a el PIN al registrar.
2. Si el PIN es correcto, el router envÃ­a las credenciales de la red al dispositivo y Ã©ste queda conectado.

> Nota: el PIN de 8 dÃ­gitos suena grande, pero el diseÃ±o del protocolo reduce drÃ¡sticamente la complejidad prÃ¡ctica â€” ver secciÃ³n de debilidades.

### Debilidades y por quÃ© WPS es peligroso

WPS fue creado para conveniencia, pero tiene fallas de diseÃ±o que lo hacen inseguro:

1. **PIN de 8 dÃ­gitos â€” validaciÃ³n en dos partes**

   - Aunque parecen $10^8 = 100{,}000{,}000$ combinaciones teÃ³ricas, en la prÃ¡ctica **el Ãºltimo dÃ­gito es un dÃ­gito de verificaciÃ³n (checksum)** y la validaciÃ³n se realiza en dos bloques:

     - primeros 4 dÃ­gitos (10â´ combinaciones)
     - siguientes 3 dÃ­gitos (10Â³ combinaciones)

   - CÃ¡lculo (paso a paso):

     - $10^4 = 10 \times 10 \times 10 \times 10 = 10{,}000$
     - $10^3 = 10 \times 10 \times 10 = 1{,}000$
     - intentos necesarios â‰ˆ $10{,}000 + 1{,}000 = 11{,}000$

   - Resultado: en vez de decenas de millones, el espacio de bÃºsqueda efectivo es del orden de **once mil** combinaciones, que es trivial para herramientas automatizadas si no hay protecciones (bloqueos, lÃ­mites de reintentos, etc.).

2. **Ausencia de lÃ­mites / bloqueo**

   - Muchos equipos no implementan limitaciÃ³n de intentos o penalizaciones por reintentos, por lo que un atacante en rango puede probar muchas combinaciones hasta acertar.

3. **PIN por defecto / PIN imprimible**

   - Algunos routers traen PINs por defecto impresos en la etiqueta; si estos no se cambian, cualquiera con acceso fÃ­sico al router o que haya visto la etiqueta puede conectarse.

4. **WPS PBC â€” riesgo fÃ­sico**

   - En entornos pÃºblicos o mal gestionados, alguien podrÃ­a aprovechar la ventana de configuraciÃ³n (si el botÃ³n fue activado o un panel de administraciÃ³n lo permite) para conectar un dispositivo no autorizado.

5. **Implementaciones defectuosas**

   - Algunos fabricantes no siguieron bien las recomendaciones; existen modelos cuyos WPS no se apagan realmente aun cuando el usuario lo desactiva.

### Ejemplos prÃ¡cticos (ilustrativos y defensivos)

**Ejemplo A â€” Hogar (conveniencia vs riesgo):**

- SituaciÃ³n: quieres conectar una impresora nueva. Pulsas el botÃ³n WPS del router y pulsas WPS en la impresora â†’ fÃ¡cil y rÃ¡pido.
- Riesgo: si dejas WPS siempre habilitado (especialmente el mÃ©todo PIN), un atacante en la calle o edificio contiguo podrÃ­a intentar explotar el PIN.

**Ejemplo B â€” CafÃ© o hotspot pÃºblico:**

- Nunca habilites PBC en un punto de acceso pÃºblico sin control: cualquiera podrÃ­a conectarse durante la ventana WPS. En entornos pÃºblicos la recomendaciÃ³n es **deshabilitar WPS**.

### Recomendaciones y mitigaciones (quÃ© hacer)

1. **Desactiva WPS** en tu router si no lo necesitas. Es la mejor medida.

   - Accede a la interfaz de administraciÃ³n del router (o app del fabricante) â†’ secciÃ³n inalÃ¡mbrica / seguridad â†’ desactivar WPS.

2. **Actualiza el firmware** del router: algunos modelos reciben parches que mejoran o corrigen comportamientos inseguros.
3. **Cambia contraseÃ±as por defecto** del administrador del router y desactiva acceso remoto a la configuraciÃ³n.
4. **Usa WPA2-PSK (AES) o WPA3** con una contraseÃ±a larga y Ãºnica (mÃ­nimo 12â€“16 caracteres, preferible mÃ¡s).
5. **Para empresas**: usa WPA2/WPA3-Enterprise (802.1X) en lugar de PSK y asegura un servidor RADIUS + certificados.
6. **Si no puedes desactivar WPS**: contacta al fabricante o considera reemplazar el equipo por uno moderno y gestionable.
7. **Registrar dispositivos invitados**: usa opciones alternativas seguras (QR para invitados, VLANs para aislamiento, captive portal para acceso temporal).

### Â¿QuÃ© sucede despuÃ©s de desactivar WPS?

- La red Wi-Fi seguirÃ¡ funcionando con la contraseÃ±a (PSK).
- Ya no podrÃ¡s usar el botÃ³n WPS ni el PIN para emparejar dispositivos â€” deberÃ¡s introducir la contraseÃ±a manualmente o usar mÃ©todos seguros alternativos (QR, aprovisionamiento por administrador).
- Aumenta significativamente la seguridad al eliminar una puerta de entrada ampliamente explotada.

### Resumen y checklist rÃ¡pido

- WPS = conveniencia, **pero inseguro**, especialmente el mÃ©todo PIN.
- El espacio efectivo de la clave PIN es â‰ˆ **11 000** intentos (no las 100 millones aparentes).
- **RecomendaciÃ³n:** desactÃ­valo; usa WPA2/WPA3 con contraseÃ±a fuerte o WPA-Enterprise en entornos corporativos.
- Si tu router no permite desactivar WPS: actualiza firmware, contacta al fabricante o cambia de equipo.

---

[ğŸ”¼](#Ã­ndice)

---

## **394. Â¿QuÃ© es WPS en WiFi?**

**WPS (Wi-Fi Protected Setup)** es un conjunto de mecanismos diseÃ±ados para **facilitar la conexiÃ³n de dispositivos** a una red Wi-Fi sin tener que escribir la contraseÃ±a (PSK) manualmente. ApareciÃ³ para que usuarios domÃ©sticos pudieran emparejar impresoras, cÃ¡maras, smart-TVs y smartphones de forma rÃ¡pida y sin errores de tipeo.

Los mÃ©todos mÃ¡s comunes de WPS son:

- **PBC (Push Button Configuration)** â€” emparejamiento con un botÃ³n fÃ­sico o virtual.
- **PIN (8 dÃ­gitos)** â€” introducciÃ³n de un PIN que actÃºa como credencial temporal.
- MÃ©todos menos comunes: **NFC**, intercambio por **USB** o cÃ³digos QR en algunos dispositivos.

### Â¿CÃ³mo funciona? (visiÃ³n general)

WPS involucra dos roles:

- **Registrar**: normalmente el router / punto de acceso (tiene la clave de la red).
- **Enrollee**: el dispositivo que quiere conectarse (impresora, telÃ©fono, etc.).

Flujos simplificados:

- **PBC (botÃ³n)**: presionas el botÃ³n WPS en el router y activas WPS en el dispositivo dentro de una ventana de tiempo. Router y dispositivo negocian y el enrollee recibe la informaciÃ³n de la red (SSID + clave) sin introducirla manualmente.
- **PIN**: el enrollee envÃ­a un PIN de 8 dÃ­gitos al registrar; si el router lo acepta, envÃ­a la credencial Wi-Fi al dispositivo.

### Ejemplos prÃ¡cticos (legÃ­timos)

- **Conectar una impresora domÃ©stica:** la impresora tiene una opciÃ³n â€œConectar vÃ­a WPSâ€. Presionas el botÃ³n WPS del router y luego inicias la bÃºsqueda en la impresora â†’ se conectan sin escribir la contraseÃ±a.
- **Configurar un smart-TV:** algunos televisores muestran la opciÃ³n â€œConectar con WPS PINâ€: introduces el PIN que muestra el TV en el panel web del router (si el router lo solicita) y el televisor se conecta.
  Estos ejemplos muestran la conveniencia: ideal para usuarios no tÃ©cnicos o dispositivos sin teclado.

### Â¿Por quÃ© WPS es peligroso? (debilidades principales)

WPS fue pensado para conveniencia, pero **tiene fallas de diseÃ±o y de implementaciÃ³n** que lo hacen inseguro:

1. **Estructura del PIN de 8 dÃ­gitos (y por quÃ© es dÃ©bil)**

   - El PIN WPS tiene 8 dÃ­gitos, pero **el Ãºltimo dÃ­gito es un dÃ­gito de verificaciÃ³n (checksum)**.
   - AdemÃ¡s, muchos implementaciones validan el PIN en **dos partes**: primeros 4 dÃ­gitos y luego los siguientes 3 (el 8.Âº es checksum).
   - MatemÃ¡ticamente:

     - Combinaciones teÃ³ricas para 8 dÃ­gitos:

       - $10 \times 10 \times 10 \times 10 \times 10 \times 10 \times 10 \times 10$
       - $=10^8$
       - $=10 \times 10 \times 10 \times 10 \times 10 \times 10 \times 10 \times 10$
       - $=100\,000\,000$ (cien millones).

     - Pero por la validaciÃ³n en dos fases el espacio efectivo se reduce a:

       - primeros 4 dÃ­gitos: $10 \times 10 \times 10 \times 10 = 10^4 = 10\,000$.
       - siguientes 3 dÃ­gitos: $10 \times 10 \times 10 = 10^3 = 1\,000$.
       - intentos â‰ˆ $10\,000 + 1\,000 = 11\,000$.

     - Resultado: el espacio efectivo es del orden de **once mil** combinaciones, no cien millones â€” eso lo hace susceptible a ataques automatizados.

2. **Falta (en muchos routers) de limitaciÃ³n de intentos o bloqueo**

   - Si el router no impone retardos o bloqueos tras varios intentos errÃ³neos, un atacante puede probar sistemÃ¡ticamente esas \~11k combinaciones.

3. **PIN por defecto o imprimible en la etiqueta**

   - Muchos routers traen el PIN impreso en la etiqueta. Si no se cambia, cualquiera con acceso fÃ­sico o que haya visto la etiqueta lo puede usar.

4. **Ventana de PBC**

   - El botÃ³n WPS abre una ventana breve para emparejar; si alguien malintencionado estÃ¡ en rango y activa su dispositivo en ese momento, puede conectarse.

5. **Implementaciones defectuosas**

   - Algunos modelos no desactivan realmente WPS aun cuando el UI indica que estÃ¡ â€œoffâ€, o no aplican parches para vulnerabilidades conocidas.

> Nota importante: describir la vulnerabilidad y la matemÃ¡tica del PIN es vÃ¡lido para comprender el riesgo. No proporcionarÃ© instrucciones paso a paso ni comandos para explotar WPS.

### Escenarios â€” ejemplo ilustrativo (no tÃ©cnico)

- **Casa**: Dejas WPS habilitado â€œpor comodidadâ€. Un vecino con conocimientos tÃ©cnicos, estando dentro del rango Wi-Fi, puede usar herramientas de auditorÃ­a para intentar los PINs hasta encontrar el correcto y obtener tu contraseÃ±a Wi-Fi.
- **CafeterÃ­a / hotspot**: Un empleado no autorizado podrÃ­a activar PBC y conectar un dispositivo malicioso durante la ventana WPS si no hay controles.

### Herramientas (menciÃ³n orientativa, uso Ã©tico)

En auditorÃ­a de redes y pentesting autorizado se usan herramientas que automatizan intentos para comprobar la seguridad. Ejemplos conocidos (menciones, no instrucciones): **Reaver**, **Bully**, **Wifite**.
â€” Estas herramientas existen para pruebas de seguridad **con permiso explÃ­cito**; su uso en redes ajenas sin autorizaciÃ³n es ilegal.

### CÃ³mo proteger tu red (medidas prÃ¡cticas)

1. **Desactiva WPS** si no lo necesitas.

   - Accede al panel de administraciÃ³n del router (p. ej. `192.168.1.1` o la app del fabricante) â†’ secciÃ³n inalÃ¡mbrica/seguridad â†’ opciÃ³n WPS â†’ **Desactivar**.
   - Si tu modelo tiene un botÃ³n fÃ­sico WPS, revisa su comportamiento (si es posible, desactÃ­valo desde la UI).

2. **Actualiza el firmware** del router: corrige fallos de implementaciÃ³n.
3. **Cambia la contraseÃ±a de administrador** del router (no usar â€œadmin/adminâ€) y desactiva acceso remoto al panel.
4. **Usa WPA2-PSK (AES) o WPA3-PSK** con una contraseÃ±a larga y Ãºnica (mÃ­nimo 12â€“16 caracteres; idealmente mÃ¡s).
5. **En entornos corporativos**, usa **WPA2/WPA3-Enterprise (802.1X + RADIUS)**, que evita PSK compartidos y es mÃ¡s seguro.
6. **Si tu router no permite desactivar WPS**: contactar al fabricante, actualizar firmware o evaluar reemplazo por un equipo que permita gestiÃ³n completa.
7. **Para invitados**: crea una red de invitados con PSK independiente o usa un portal cautivo o cÃ³digos QR temporales para no compartir la clave principal.
8. **Registro de dispositivos**: si precisas facilidad para muchos dispositivos, centraliza aprovisionamiento seguro (MDM / perfil corporativo), no WPS.

### Â¿QuÃ© pasa cuando desactivas WPS?

- La Wi-Fi sigue funcionando normalmente con la contraseÃ±a (PSK).
- Pierdes la comodidad instantÃ¡nea del botÃ³n o PIN, pero ganas seguridad: eliminas una vector de ataque explotado frecuentemente.

### Resumen prÃ¡ctico â€” checklist rÃ¡pido

- âœ… Â¿WPS habilitado? â†’ **DesactÃ­valo** si no lo necesitas.
- âœ… Â¿Router con firmware actualizado? â†’ Actualiza.
- âœ… Â¿ContraseÃ±a Wi-Fi fuerte? â†’ Usa WPA2/WPA3 con PSK largo y seguro.
- âœ… Â¿Entorno corporativo? â†’ Migra a WPA-Enterprise (802.1X).
- âœ… Â¿No puedes desactivar WPS? â†’ Contacta fabricante o reemplaza hardware.

---

[ğŸ”¼](#Ã­ndice)

---

| **Inicio**         | **atrÃ¡s 18**                 | **Siguiente 20**     |
| ------------------ | ---------------------------- | -------------------- |
| [ğŸ ](../README.md) | [âª](./12_18_EAP_vs_PEAP.md) | [â©](./12_20_ACL.md) |
