| **Inicio**         | **atr√°s 19**         | **Siguiente 21**                            |
| ------------------ | -------------------- | ------------------------------------------- |
| [üè†](../README.md) | [‚è™](./12_19_WPS.md) | [‚è©](./12_21_WPA_vs_WPA2_vs_WPA3_vs_WEP.md) |

---

## **√çndice**

| Temario                                                                                                              |
| -------------------------------------------------------------------------------------------------------------------- |
| [392. Lista de control de acceso: definici√≥n, tipos y usos](#392-lista-de-control-de-acceso-definici√≥n-tipos-y-usos) |
| [393. Listas de control de acceso](#393-listas-de-control-de-acceso)                                                 |

# **ACL**

## **392. Lista de control de acceso: definici√≥n, tipos y usos**

![ACL](/img/12_Secure_vs_Unsecure_Protocols/ACL.webp "ACL")

### üìå Lista de control de acceso (ACL)

#### üîπ Definici√≥n

Una **Lista de Control de Acceso (ACL, Access Control List)** es un **conjunto de reglas** que definen qu√© usuarios, dispositivos, procesos o paquetes de red pueden acceder a un recurso espec√≠fico, y bajo qu√© condiciones.

- Se usan tanto en **sistemas operativos** (archivos, directorios) como en **redes** (routers, firewalls).
- Cada regla suele indicar:

  - **Qu√© entidad** (usuario, IP, aplicaci√≥n) intenta acceder.
  - **Qu√© acci√≥n** est√° permitida o denegada (leer, escribir, ejecutar, reenviar, bloquear).

üëâ Piensa en la ACL como una **lista de instrucciones para un portero**: qui√©n entra, qui√©n no, y qu√© puede hacer adentro.

### üîπ Tipos de listas de control de acceso

#### 1. **ACLs de Sistema de Archivos**

- Definen permisos sobre archivos y carpetas.
- Ejemplo en Linux (modo POSIX):

  - Usuario puede `leer` y `escribir`.
  - Grupo puede solo `leer`.
  - Otros no tienen acceso.

- Ejemplo en Windows (NTFS):

  - Se pueden definir permisos granulares: `Full Control`, `Read`, `Modify`, etc.

#### 2. **ACLs de Red**

- Usadas en routers, switches y firewalls.
- Regulan tr√°fico seg√∫n par√°metros como **IP origen/destino, puerto, protocolo**.
- Dos subtipos principales:

  - **ACL Est√°ndar**: filtran solo por direcci√≥n IP de origen.
  - **ACL Extendida**: filtran por IP origen/destino, puerto y protocolo (mucho m√°s granulares).

Ejemplo de ACL extendida en Cisco:

```bash
access-list 101 permit tcp 192.168.1.0 0.0.0.255 any eq 80
access-list 101 deny ip any any
```

üëâ Esto permite tr√°fico **HTTP** desde la red interna `192.168.1.0/24`, y bloquea todo lo dem√°s.

#### 3. **ACLs en Aplicaciones**

- Definen qu√© usuarios o roles pueden acceder a funciones espec√≠ficas en software.
- Ejemplo: en una app web, la ACL puede indicar que un usuario est√°ndar puede ‚Äúver‚Äù productos, pero solo el administrador puede ‚Äúcrear‚Äù o ‚Äúeliminar‚Äù.

### üîπ ¬øPor qu√© utilizar una ACL?

1. **Seguridad**: limita el acceso a recursos sensibles.
2. **Control de tr√°fico**: en redes, evita que dispositivos no autorizados lleguen a ciertos servidores.
3. **Cumplimiento normativo**: necesario en marcos como GDPR, HIPAA, ISO 27001.
4. **Auditor√≠a y trazabilidad**: permite registrar qui√©n accedi√≥ a qu√©.
5. **Segmentaci√≥n de redes**: divide la red en zonas seguras (ejemplo: separar servidores de usuarios).

### üîπ C√≥mo funcionan las listas de control de acceso

- Cuando un **paquete** (en redes) o una **petici√≥n de acceso** (en sistemas) llega al recurso:

  1. El sistema **compara** con las reglas de la ACL en orden.
  2. Se aplica la **primera coincidencia** encontrada (regla de acci√≥n: permitir o denegar).
  3. Si no coincide con ninguna regla, suele aplicarse una **regla impl√≠cita de denegar todo**.

Ejemplo simple en un firewall:

```
1. Permitir tr√°fico HTTP (puerto 80).
2. Permitir tr√°fico HTTPS (puerto 443).
3. Denegar todo lo dem√°s.
```

### üîπ Mejores pr√°cticas para el uso de ACL

‚úÖ **Principio de m√≠nimo privilegio**: solo permitir lo estrictamente necesario.

‚úÖ **Documentar reglas**: describir qu√© hace cada ACL para facilitar auditor√≠as.

‚úÖ **Ordenar reglas correctamente**: reglas m√°s espec√≠ficas antes que las generales.

‚úÖ **Monitorear y auditar**: revisar logs para detectar accesos indebidos.

‚úÖ **Actualizar regularmente**: eliminar reglas obsoletas o excesivamente amplias.

‚úÖ **Evitar ‚Äúpermitir todo‚Äù**: ejemplo t√≠pico `permit ip any any` que rompe el prop√≥sito de la ACL.

### üîπ RBAC frente a ACL

- **ACL (Access Control List)**: controla accesos a nivel de **objeto/recurso**. Define **qui√©n puede hacer qu√©** sobre un recurso espec√≠fico.

  - Ejemplo: "El usuario Ana puede leer el archivo X".

- **RBAC (Role-Based Access Control)**: controla accesos bas√°ndose en **roles** predefinidos, no en usuarios individuales.

  - Ejemplo: "Todos los usuarios con rol `Administrador` pueden modificar cualquier archivo de configuraci√≥n".

üëâ Diferencia clave:

- **ACL** = m√°s granular, se enfoca en el recurso y los permisos espec√≠ficos.
- **RBAC** = m√°s escalable en organizaciones grandes, se basa en roles (los permisos se asignan al rol, no al individuo).

### üîπ Recursos adicionales

- Documentaci√≥n oficial de Cisco sobre ACLs de red.
- Manuales de **Windows NTFS ACL**.
- Linux `man setfacl` para ACL en sistemas de archivos.
- Normas ISO/IEC 27001 (seguridad de la informaci√≥n).

---

[üîº](#√≠ndice)

---

## **393. Listas de control de acceso**

### ¬øQu√© es una ACL?

Una **Lista de Control de Acceso (ACL, Access Control List)** es un conjunto ordenado de reglas que indica **qu√© entidades** (usuarios, hosts, procesos, paquetes) **pueden o no pueden** realizar determinadas acciones sobre un recurso (archivo, interfaz de red, endpoint de API, etc.).
Piensa en la ACL como la **lista que sigue un portero**: lee las reglas en orden y decide permitir o denegar la entrada.

### Tipos principales de ACL (y d√≥nde se usan)

1. **ACL de red (routers, switches, firewalls)**

   - Filtran tr√°fico por IP origen/destino, puerto y protocolo.
   - Subtipos: _est√°ndar_ (filtran por IP origen) y _extendida_ (filtran por IP origen/destino, puertos, protocolos).

2. **ACL de sistema de archivos**

   - Controlan permisos sobre archivos y carpetas (ej. POSIX ACL en Linux, NTFS ACL en Windows).

3. **ACL a nivel de aplicaci√≥n / recurso**

   - Definen qu√© roles o usuarios pueden ejecutar acciones sobre recursos de software (APIs, endpoints, funciones).

4. **ACL a nivel de enlace (MAC ACLs / 802.1X)**

   - Filtran por direcciones MAC o usan control de acceso por puerto (ej. en switches con 802.1X).

### ¬øC√≥mo funcionan (conceptos clave)?

- **Evaluaci√≥n ordenada:** las ACL suelen evaluarse en orden; la **primera regla que coincide** determina la acci√≥n (permitir/denegar).
- **Regla impl√≠cita 'deny all':** si ninguna regla coincide, por defecto suele negarse el acceso (buena pr√°ctica de seguridad).
- **Granularidad:** desde ‚Äúpermitir todo el tr√°fico desde una subred‚Äù hasta ‚Äúpermitir solo TCP puerto 443 desde X a Y‚Äù.
- **Herencia (en archivos):** en sistemas de archivos, permisos pueden heredarse de carpetas padres.
- **M√°scara / comodines en redes:** en Cisco las ACL usan _wildcard masks_ (inverso de la m√°scara). Ej.: `192.168.1.0 0.0.0.255` = red /24.

### Ejemplos pr√°cticos

#### 1) ACL de red ‚Äî Cisco (ACL extendida)

Objetivo: permitir HTTP/HTTPS desde la red 192.168.1.0/24 hacia cualquier destino; denegar todo lo dem√°s.

```cisco
ip access-list extended LAN_ALLOW_WEB
 permit tcp 192.168.1.0 0.0.0.255 any eq 80
 permit tcp 192.168.1.0 0.0.0.255 any eq 443
 deny ip any any
!
interface GigabitEthernet0/1
 ip access-group LAN_ALLOW_WEB in
```

Explicaci√≥n:

- `192.168.1.0 0.0.0.255` es la subred /24 (wildcard = complemento de la m√°scara).
- Paquetes entrantes en la interfaz son revisados en orden; si coinciden con `permit tcp ... eq 80` se permiten; si no coinciden con ninguna regla, la `deny ip any any` los bloquea.

#### 2) ACL simple en iptables (Linux) ‚Äî permitir SSH solo desde administraci√≥n

```bash
# permitir SSH desde la subred de administradores
iptables -A INPUT -p tcp --dport 22 -s 10.10.0.0/24 -j ACCEPT
# registrar y luego denegar el resto de SSH
iptables -A INPUT -p tcp --dport 22 -j LOG --log-prefix "SSH_DROP: "
iptables -A INPUT -p tcp --dport 22 -j DROP
```

Nota: el orden importa: la primera regla que coincide se aplica.

#### 3) ACL de sistema de archivos ‚Äî Linux (setfacl/getfacl)

Dar a `juan` permiso de lectura sobre `/srv/archivo.txt`:

```bash
echo "secreto" > /srv/archivo.txt
chmod 640 /srv/archivo.txt
setfacl -m u:juan:r-- /srv/archivo.txt
getfacl /srv/archivo.txt
```

Salida t√≠pica de `getfacl`:

```
# file: srv/archivo.txt
# owner: root
# group: root
user::rw-
user:juan:r--
group::r--
mask::r--
other::---
```

- `mask` controla el permiso m√°ximo efectivo para usuarios/grupos no propietarios.
- Para directorios existe `d:` (default) para que los permisos se hereden a nuevos archivos:
  `setfacl -m d:u:juan:rwX /srv/proy/`

#### 4) ACL en Windows (NTFS) ‚Äî usando icacls

Conceder lectura a la usuaria `ANA` y quitar permisos a `Users`:

```powershell
icacls "C:\Datos\confidencial.txt" /grant "DOMINIO\ANA:(R)"
icacls "C:\Datos\confidencial.txt" /remove "BUILTIN\Users"
```

- En Windows las entradas _Deny_ suelen prevalecer sobre _Allow_ para el mismo sujeto.

#### 5) ACL a nivel de aplicaci√≥n ‚Äî ejemplo JSON

Pol√≠tica de permisos para recurso `orders`:

```json
{
  "resource": "orders",
  "permissions": {
    "admin": ["create", "read", "update", "delete"],
    "support": ["read", "update"],
    "user": ["create", "read"]
  }
}
```

- En la aplicaci√≥n, un middleware verifica el rol del usuario y lo compara con la lista antes de ejecutar la acci√≥n.

### Casos de uso t√≠picos

- Permitir s√≥lo gesti√≥n SSH desde la subred administrativa.
- Restringir acceso a una API por rol (solo `admin` puede borrar).
- Separar segmentos de red (usuarios vs servidores vs DMZ).
- Controlar acceso a archivos sensibles en un servidor de ficheros.
- Aislar impresoras o sistemas de control industrial.

### Buenas pr√°cticas (imprescindibles)

- **Principio del m√≠nimo privilegio**: conceder solo lo necesario.
- **Orden l√≥gico y espec√≠fico ‚Üí general**: reglas espec√≠ficas antes que generales.
- **Documentar y comentar** cada ACL (qu√© hace y por qu√©).
- **Usar deny expl√≠cito con cuidado** ‚Äî una regla Deny puede interferir con otras reglas; documenta por qu√© existe.
- **Logs y monitoreo**: registrar coincidencias importantes (intentos denegados).
- **Pol√≠tica de revisi√≥n** peri√≥dica: elimina reglas obsoletas.
- **Control de cambios**: versiona y guarda cambios de ACL (rollback posible).
- **Probar en entorno controlado** antes de aplicar en producci√≥n.
- **Evitar reglas ‚Äúpermit any any‚Äù** salvo casos muy controlados.
- **Backups de configuraci√≥n** (especialmente en routers / firewalls).

### Errores y problemas comunes

- **Orden incorrecto**: una regla permisiva arriba puede anular reglas espec√≠ficas colocadas despu√©s.
- **Wildcard mask vs netmask** (Cisco): confusi√≥n entre `0.0.0.255` (wildcard) y `255.255.255.0` (netmask). El wildcard es el complemento (bits permitidos a variar).
- **Mask/Masking en archivos (mask en POSIX ACL)**: olvida ajustar `mask` y los permisos efectivos no funcionan como esperabas.
- **Herencia inesperada** en NTFS o POSIX: permisos heredados desde directorios padres que rompen esquemas.
- **Reglas duplicadas / contradictorias**: provoca comportamiento dif√≠cil de depurar.
- **No registrar denegaciones**: pierdes visibilidad de intentos maliciosos.

### ACL vs RBAC vs ABAC (breve)

- **ACL**: especifica por recurso _qui√©n_ puede hacer _qu√©_ (granular, directo).
- **RBAC (Role-Based Access Control)**: asigna permisos a _roles_ y usuarios a roles (m√°s escalable).
- **ABAC (Attribute-Based Access Control)**: decisiones basadas en atributos (usuario, recurso, contexto), muy flexible para pol√≠ticas din√°micas.

  En la pr√°ctica se combinan: RBAC para gesti√≥n, ACLs para controles puntuales y ABAC para escenarios con condiciones (ej. horario, ubicaci√≥n).

### Checklist r√°pido para aplicar una ACL segura

1. Define el objetivo exacto de la ACL.
2. Escribe reglas espec√≠ficas (origen, destino, protocolo, puerto).
3. Coloca excepciones/negaciones expl√≠citas con comentarios.
4. Prueba en entorno controlado / simula tr√°fico.
5. Habilita logging y monitoreo.
6. Revisa y documenta.
7. Automatiza despliegues en infra moderna (IaC) y versiona.

---

[üîº](#√≠ndice)

---

| **Inicio**         | **atr√°s 19**         | **Siguiente 21**                            |
| ------------------ | -------------------- | ------------------------------------------- |
| [üè†](../README.md) | [‚è™](./12_19_WPS.md) | [‚è©](./12_21_WPA_vs_WPA2_vs_WPA3_vs_WEP.md) |
