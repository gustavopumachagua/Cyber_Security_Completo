| **Inicio**         | **atr√°s 27**                      |
| ------------------ | --------------------------------- |
| [üè†](../README.md) | [‚è™](./12_27_Known_vs_Unknown.md) |

---

## **√çndice**

| Temario                                                                                        |
| ---------------------------------------------------------------------------------------------- |
| [410. Amenaza persistente avanzada (APT)](#410-amenaza-persistente-avanzada-apt)               |
| [411. ¬øQu√© es una amenaza persistente avanzada?](#411-qu√©-es-una-amenaza-persistente-avanzada) |

# **APT**

## **410. Amenaza persistente avanzada (APT)**

![APT](/img/12_Secure_vs_Unsecure_Protocols/apt.jpg "APT")

### 1) ¬øQu√© es una amenaza persistente avanzada (APT)?

Una **APT (Advanced Persistent Threat)** es un tipo de ataque **sofisticado, prolongado y dirigido**, normalmente realizado por grupos organizados (a menudo respaldados por estados o grandes organizaciones criminales).

Su objetivo no es causar ruido inmediato, sino **infiltrarse, permanecer ocultos durante mucho tiempo y robar datos valiosos o espiar**.

üëâ Ejemplo sencillo:

Un malware com√∫n puede cifrar tus archivos en minutos (ransomware).
Un **APT**, en cambio, se infiltra silenciosamente en la red de una empresa, estudia c√≥mo funciona, roba credenciales y datos cr√≠ticos durante meses sin ser detectado.

### 2) Las 3 etapas de un ataque APT

Aunque un APT puede tener muchas fases, se resumen en **3 grandes etapas**:

1. **Intrusi√≥n inicial**

   - El atacante consigue acceso a la red.
   - Vectores comunes: phishing dirigido (_spear phishing_), explotaci√≥n de vulnerabilidades zero-day, ataques a la cadena de suministro, accesos RDP expuestos.
   - Ejemplo: un empleado abre un correo con un adjunto malicioso que instala un _backdoor_.

2. **Expansi√≥n y persistencia**

   - Una vez dentro, el atacante se mueve lateralmente por la red.
   - Roba credenciales, aprovecha t√©cnicas _living off the land_ (uso de herramientas leg√≠timas como PowerShell o WMI).
   - Instala mecanismos de persistencia (servicios ocultos, backdoors, cuentas administrativas falsas).

3. **Extracci√≥n y explotaci√≥n de datos**

   - Los atacantes recopilan informaci√≥n cr√≠tica: propiedad intelectual, datos de clientes, secretos gubernamentales.
   - La informaci√≥n se exfiltra de forma sigilosa (ej.: usando DNS, HTTP cifrado o servidores proxy).
   - Ejemplo: robar planos de un sat√©lite y venderlos o usarlos en espionaje.

### 3) Caracter√≠sticas de un ataque APT

Un ataque APT tiene diferencias clave respecto a malware com√∫n:

- **Avanzado:** usan herramientas personalizadas, exploits de d√≠a cero o malware polim√≥rfico.
- **Persistente:** no buscan un golpe r√°pido, sino **permanecer meses o a√±os** dentro sin ser detectados.
- **Dirigido:** el ataque no es masivo; est√° enfocado en un objetivo estrat√©gico (empresa, gobierno, banco, industria tecnol√≥gica).
- **Sigiloso:** ocultan sus actividades en tr√°fico normal, encriptan comunicaciones y usan infraestructura distribuida (botnets, proxys, C2).
- **Multifase:** no es un √∫nico malware; es toda una campa√±a con ingenier√≠a social, malware, movimiento lateral y exfiltraci√≥n.
- **Respaldado:** suelen tener financiamiento estatal o de organizaciones criminales de alto nivel.

### 4) Ejemplos de amenazas persistentes avanzadas

- **APT28 (Fancy Bear)**: grupo vinculado a Rusia, conocido por ataques a la OTAN, elecciones en EE.UU. y organismos europeos.
- **APT29 (Cozy Bear)**: vinculado a inteligencia rusa; comprometi√≥ la campa√±a presidencial de EE.UU. en 2016 y atac√≥ la cadena de suministro de SolarWinds en 2020.
- **APT10 (Stone Panda)**: vinculado a China; rob√≥ propiedad intelectual de empresas tecnol√≥gicas y farmac√©uticas en todo el mundo.
- **Stuxnet (2010)**: ataque dirigido contra plantas nucleares iran√≠es. Infect√≥ sistemas SCADA/PLC y destruy√≥ centrifugadoras. Fue uno de los primeros APT conocidos p√∫blicamente.
- **APT33**: vinculado a Ir√°n; especializado en ataques contra empresas de aviaci√≥n y energ√≠a.

### 5) ¬øC√≥mo protegerse contra los ataques APT?

La defensa frente a un APT requiere una **estrategia integral**, porque las defensas tradicionales (antivirus, firewalls simples) no son suficientes.

üîë **Medidas clave de protecci√≥n:**

1. **Prevenci√≥n**

   - Parches r√°pidos de vulnerabilidades cr√≠ticas.
   - Minimizar superficie de ataque: segmentaci√≥n de red, control de accesos, MFA obligatorio.
   - Control de endpoints: listas blancas de aplicaciones, privilegios m√≠nimos.

2. **Detecci√≥n temprana**

   - Implementar EDR/XDR (Endpoint/Extended Detection and Response).
   - Monitorear comportamiento en lugar de solo firmas (ej.: procesos an√≥malos, tr√°fico extra√±o).
   - UEBA (User and Entity Behavior Analytics) para detectar actividades sospechosas de usuarios.

3. **Respuesta a incidentes**

   - Playbooks claros: aislar host, tomar im√°genes forenses, analizar persistencia, erradicar y recuperar.
   - Threat hunting proactivo (buscar indicios aunque no haya alerta).

4. **Defensa en profundidad**

   - SIEM centralizado para correlaci√≥n de eventos.
   - Monitoreo de DNS y tr√°fico de red (detecci√≥n de exfiltraci√≥n oculta).
   - Honeypots / canaries para exponer movimientos sospechosos.

5. **Concienciaci√≥n y formaci√≥n**

   - Capacitaci√≥n de empleados contra phishing y spear phishing.
   - Ejercicios de Red Team / Purple Team para probar defensas.

### 6) Protecci√≥n avanzada contra amenazas de CrowdStrike: la importancia de la velocidad

CrowdStrike es un referente en **detecci√≥n y respuesta r√°pida contra APTs** gracias a su plataforma **Falcon**.

Ellos enfatizan un concepto clave:

- En ataques avanzados, **cada segundo cuenta**.
- Si un atacante logra persistir en tu red por horas o d√≠as, las probabilidades de da√±o aumentan exponencialmente.

#### üöÄ Regla de CrowdStrike (1-10-60):

- **1 minuto** para detectar una intrusi√≥n.
- **10 minutos** para entender y analizar el incidente.
- **60 minutos** para contener y erradicar la amenaza.

Ejemplo:

Si un grupo APT roba credenciales de un servidor cr√≠tico y t√∫ tardas **24 horas en detectarlo**, probablemente ya movieron datos fuera y establecieron persistencia en m√∫ltiples sistemas.
Si lo detectas en **1 minuto**, puedes aislar el host antes de que logren moverse lateralmente.

La **velocidad de respuesta** es la diferencia entre un incidente controlado y una brecha catastr√≥fica.

‚úÖ **En resumen:**

Un **APT** es un ataque silencioso, dirigido y financiado que puede comprometer a una organizaci√≥n durante meses.
Defenderse requiere **detecci√≥n basada en comportamiento, caza de amenazas, segmentaci√≥n y respuesta ultrarr√°pida**.
La **velocidad**, como destaca CrowdStrike, es tu mejor aliada para impedir que un intruso desconocido se convierta en una cat√°strofe.

---

[üîº](#√≠ndice)

---

## **411. ¬øQu√© es una amenaza persistente avanzada?**

Una **APT (Advanced Persistent Threat)** es un **ataque dirigido, sofisticado y de larga duraci√≥n** realizado por un actor con recursos (por ejemplo un grupo criminal organizado o un actor estatal) cuyo objetivo principal es **infiltrarse, permanecer oculto y extraer informaci√≥n valiosa** (propiedad intelectual, secretos industriales, datos gubernamentales, etc.).
No busca ruido ni da√±o inmediato: busca acceso sostenido y discreto para cumplir una misi√≥n concreta.

### Caracter√≠sticas clave (qu√© la distingue)

- **Avanzada:** uso de herramientas personalizadas, exploits 0-day, t√©cnicas de ofuscaci√≥n y cadenas de ataque complejas.
- **Persistente:** permanecer dentro de la red durante semanas, meses o a√±os sin ser detectado.
- **Dirigida:** selecciona objetivos concretos (sector, empresa, organismo).
- **Sigilosa:** evita detecciones mediante living-off-the-land, cifrado de comunicaciones y uso de infraestructura distribuida.
- **Multifase:** campa√±a que combina ingenier√≠a social, explotaci√≥n t√©cnica, movimiento lateral y exfiltraci√≥n.
- **Bien financiada/organizada:** planes, fases y m√∫ltiple personal (desarrollo malware, intel, operaciones).

### Ciclo t√≠pico de un ataque APT (3‚Äì6 fases resumidas)

1. **Reconocimiento y selecci√≥n**

   - Recolectan informaci√≥n p√∫blica y privada (LinkedIn, sitios, exposici√≥n de servicios).

2. **Intrusi√≥n inicial**

   - Vectores: spear phishing, adjuntos maliciosos, exploits de d√≠a cero, compromisos de proveedores (supply-chain).

3. **Establecimiento de persistencia**

   - Instalan backdoors, crean cuentas, manipulan tareas/servicios, modifican pol√≠ticas.

4. **Escalada y movimiento lateral**

   - Roban credenciales, usan t√©cnicas LOTL (PowerShell, WMI), abren t√∫neles, comprometen servidores intermedios.

5. **Recolecci√≥n y exfiltraci√≥n**

   - Agregan datos, los comprimen/cifran y los sacan con canales encubiertos (DNS, HTTPS, cloud storage).

6. **Cobertura de huellas y mantenimiento**

   - Borran logs, instalan nuevas puertas traseras, esperan la pr√≥xima ventana de extracci√≥n.

### TTPs comunes (mapa r√°pido a MITRE ATT\&CK)

- **Initial Access:** spear-phishing, exploit p√∫blico, supply-chain.
- **Execution:** scripts ofuscados, macros, procesos leg√≠timos (cmd/powershell).
- **Persistence:** servicios, tareas programadas, cuentas nuevas, credential dumping.
- **Privilege Escalation:** exploits locales, token theft.
- **Defense Evasion:** timestomping, log wiping, living-off-the-land.
- **Credential Access:** LLMNR/NetNTLM relaying, Mimikatz, keylogging.
- **Lateral Movement:** PsExec, WMI, SMB, RDP.
- **Command & Control (C2):** C2 sobre HTTPS/DNS, domain fronting.
- **Exfiltration:** DNS tunneling, encrypted HTTP uploads, cloud storage.

> Nota: conocer estas categor√≠as ayuda a dise√±ar detecciones y playbooks sin entrar en t√©cnicas de explotaci√≥n.

### Ejemplos reales (alto nivel)

- **APT29 / Cozy Bear:** campa√±as de espionaje altamente sofisticadas (incluyendo la intrusi√≥n relacionada con la cadena SolarWinds).
- **APT28 / Fancy Bear:** campa√±as dirigidas a organizaciones gubernamentales y electorales.
- **Stuxnet:** ejemplo de ataque dirigido a infraestructuras industriales con objetivo f√≠sico (SCADA).
- **Lazarus Group:** operaciones vinculadas a robo financiero y sabotaje (atribuciones a Corea del Norte).
- **APT10 (Cloud Hopper):** campa√±as contra proveedores de servicios y clientes para extraer IP.

(Estos son ejemplos p√∫blicos y permiten entender la variedad de objetivos y t√°cticas, no instrucciones.)

### Indicadores de compromiso (IoC) y se√±ales de alerta

- Sesiones fuera de horario o desde ubicaciones/geos inusuales.
- Creaci√≥n de cuentas administrativas no planificada.
- Procesos leg√≠timos invocando comandos sospechosos (ex.: Word ‚Üí PowerShell).
- Tr√°fico DNS inusual: subdominios largos, muchos NXDOMAIN, patrones de DNS flux.
- Alta tasa de lecturas/compresiones de ficheros en servidores sensibles.
- Archivos o binarios no firmados en rutas cr√≠ticas; hashes apareciendo en feeds TI.
- Logs borrados/rotados de forma an√≥mala; sincronizaci√≥n de relojes alterada.

### C√≥mo detectar y defenderse (estrategia pr√°ctica)

**1. Prevenci√≥n ‚Äî minimizar la superficie**

- Patching r√°pido y gesti√≥n de vulnerabilidades.
- MFA obligatorio en accesos cr√≠ticos y SSO con control de sesiones.
- Principio de m√≠nimo privilegio y gesti√≥n de cuentas privilegiadas (PAM).
- Hardenizaci√≥n: application allow-listing, deshabilitar servicios innecesarios, restringir RDP/SSH.
- Validaci√≥n de la cadena de suministro: firmar/validar im√°genes y paquetes.

**2. Detecci√≥n ‚Äî visibilidad y anal√≠tica**

- **EDR/XDR** con telemetr√≠a de procesos, conexiones y parent-child trees.
- **SIEM + correlaci√≥n** de eventos across logs (endpoints, AD, proxies, network).
- **DNS/Network monitoring** (Zeek/Bro, NetFlow) y detecci√≥n de exfiltraci√≥n.
- **UEBA/Anomaly detection** para detectar desviaciones del comportamiento normal.
- Threat intelligence feeds y compartir IoC (MISP, ISACs).

**3. Respuesta y hunting**

- Playbooks IR (isolate host, snapshot, collect RAM/disk, triage).
- Threat hunting programado (hip√≥tesis + queries).
- SOAR para orquestar acciones no destructivas y acelerar respuesta.

**4. Resiliencia**

- Backups offline/immutables y pruebas frecuentes de restore.
- Segmentaci√≥n de red y microsegmentaci√≥n para limitar movimiento lateral.
- Registro y retenci√≥n de logs con protecci√≥n WORM/immutable storage.

### L√≠nea de tiempo de ejemplo (escenario simplificado)

1. **D√≠a 0‚Äì7 (recon & initial access):** spear-phish a empleado de I+D; payload dropea backdoor.
2. **D√≠a 8‚Äì30 (persistence & reconnaissance):** atacante obtiene credenciales de bajo nivel; crea backdoor y cuenta de servicio.
3. **Mes 2 (lateral movement):** escalada y acceso a servidor de archivos mediante SMB; utiliza scripts leg√≠timos para moverse.
4. **Mes 3 (exfiltration):** comprime datos, los cifra y los sube por HTTPS a un servidor proxy en el extranjero.
5. **Detecci√≥n & respuesta:** detecci√≥n por EDR (actividad de proceso an√≥mala), aislamiento r√°pido, snapshots forenses, erradicaci√≥n, rotaci√≥n de credenciales, reinstalaci√≥n, mejora de controles.

### Recomendaciones operativas (lista accionable)

- Desarrolla y prueba un **plan IR** con playbooks espec√≠ficos para APT (contenci√≥n, erradicaci√≥n, recuperaci√≥n).
- Implementa **EDR + SIEM + Network monitoring** y aseg√∫rate de cobertura completa de endpoints y servidores.
- Establece **threat hunting** regular y ejercicios purple/red team.
- Usa **PAM**, rotaci√≥n autom√°tica de claves y pol√≠ticas de acceso temporal.
- Habilita **CloudTrail / audit logging** y preserva logs en buckets con Object Lock (inmutables).
- Comparte y consume inteligencia (ISACs, MISP) y automatiza ingesti√≥n de IoC.
- Segmenta la red y limita lateral movement (microsegmentation).
- Mant√©n backups offline y probados; ten procedimientos de restauraci√≥n documentados.

### Resumen corto

Una **APT** es un ataque altamente dirigido y sostenido orientado a robar o espiar sin ser detectado. Defenderse requiere **visibilidad profunda, detecci√≥n basada en comportamiento, respuesta ultrarr√°pida y resiliencia operativa** (backups, segmentaci√≥n, least-privilege). La caza proactiva y el uso de plataformas EDR/XDR + SIEM + threat intelligence son fundamentales para descubrir actores que intentan permanecer ocultos.

---

[üîº](#√≠ndice)

---

| **Inicio**         | **atr√°s 27**                      |
| ------------------ | --------------------------------- |
| [üè†](../README.md) | [‚è™](./12_27_Known_vs_Unknown.md) |
