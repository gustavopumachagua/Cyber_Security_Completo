| **Inicio**         | **atrÃ¡s 9**          | **Siguiente 11**          |
| ------------------ | -------------------- | ------------------------- |
| [ğŸ ](../README.md) | [âª](./13_9_head.md) | [â©](./13_11_nslookup.md) |

---

## **Ãndice**

| Temario                                                  |
| -------------------------------------------------------- |
| [430. comando grep en Linux](#430-comando-grep-en-linux) |
| [431. El comando grep](#431-el-comando-grep)             |

# **grep**

## **430. comando grep en Linux**

![grep](/img/13_Tools_for_Incident_Response_and_Discovery/grep.webp "grep")

### 1. Â¿QuÃ© es Grep?

`grep` (Global Regular Expression Print) es una herramienta de lÃ­nea de comandos en Linux/Unix que sirve para **buscar texto dentro de archivos o flujos de datos**.

- Utiliza **expresiones regulares** para encontrar coincidencias.
- Puede buscar dentro de **uno o varios archivos**.
- Resalta o imprime las **lÃ­neas que coinciden** con el patrÃ³n indicado.

En palabras simples: es como un **CTRL+F** pero desde la terminal y mucho mÃ¡s poderoso.

### 2. Comando Grep en Linux

#### Sintaxis bÃ¡sica

```bash
grep [OPCIONES] 'patrÃ³n' archivo
```

#### Opciones mÃ¡s usadas

- `-i` â†’ ignora mayÃºsculas/minÃºsculas.
- `-n` â†’ muestra el nÃºmero de lÃ­nea.
- `-r` o `-R` â†’ bÃºsqueda recursiva en directorios.
- `-v` â†’ muestra lÃ­neas que **NO** coinciden.
- `-c` â†’ muestra el nÃºmero de coincidencias.
- `-l` â†’ muestra solo los nombres de archivos con coincidencias.
- `-w` â†’ busca palabras completas.
- `--color=auto` â†’ resalta coincidencias.

### 3. Casos de uso mÃ¡s comunes del comando `grep`

#### ğŸ”¹ 1) Buscar una palabra en un archivo

```bash
grep "error" archivo.log
```

ğŸ‘‰ Muestra todas las lÃ­neas que contienen la palabra `error`.

#### ğŸ”¹ 2) Ignorar mayÃºsculas y minÃºsculas

```bash
grep -i "error" archivo.log
```

ğŸ‘‰ Coincide con `error`, `Error`, `ERROR`, etc.

#### ğŸ”¹ 3) Mostrar nÃºmero de lÃ­nea

```bash
grep -n "warning" archivo.log
```

ğŸ‘‰ Ejemplo de salida:

```
23:2025-09-15 10:02:34 WARNING Connection timeout
57:2025-09-15 10:03:10 WARNING Slow response
```

#### ğŸ”¹ 4) Buscar en varios archivos

```bash
grep "main()" *.c
```

ğŸ‘‰ Busca la palabra `main()` en todos los archivos `.c` del directorio.

#### ğŸ”¹ 5) Buscar recursivamente en carpetas

```bash
grep -r "TODO" /home/usuario/proyecto/
```

ğŸ‘‰ Encuentra comentarios `TODO` en todo el proyecto.

#### ğŸ”¹ 6) Mostrar solo el nombre de los archivos que coinciden

```bash
grep -l "ERROR" *.log
```

ğŸ‘‰ Lista solo los archivos que contienen la palabra `ERROR`.

#### ğŸ”¹ 7) Contar coincidencias

```bash
grep -c "failed" archivo.log
```

ğŸ‘‰ Ejemplo de salida:

```
12
```

(12 coincidencias encontradas)

#### ğŸ”¹ 8) Mostrar lÃ­neas que **NO** coinciden

```bash
grep -v "DEBUG" archivo.log
```

ğŸ‘‰ Muestra todas las lÃ­neas **excepto** las que contienen `DEBUG`.

#### ğŸ”¹ 9) Buscar una palabra completa

```bash
grep -w "cat" animales.txt
```

ğŸ‘‰ Coincide con `cat`, pero **no** con `category` o `concatenate`.

#### ğŸ”¹ 10) Usar expresiones regulares

```bash
grep -E "ERROR|WARNING" archivo.log
```

ğŸ‘‰ Busca todas las lÃ­neas que contengan **ERROR** o **WARNING**.

#### ğŸ”¹ 11) Combinar con otros comandos

- Ver procesos que contienen `ssh`:

```bash
ps aux | grep ssh
```

- Ver conexiones que usan el puerto 80:

```bash
netstat -tulnp | grep 80
```

- Buscar usuarios en `/etc/passwd`:

```bash
grep "/bin/bash" /etc/passwd
```

### 4. Preguntas frecuentes (FAQ)

**â“ grep es sensible a mayÃºsculas/minÃºsculas?**

ğŸ‘‰ SÃ­, pero puedes usar `-i` para ignorarlas.

**â“ Puedo buscar en subdirectorios?**

ğŸ‘‰ SÃ­, con `grep -r`.

**â“ CÃ³mo busco varias palabras?**

ğŸ‘‰ Usa expresiones regulares con `-E`, ejemplo:

```bash
grep -E "error|fail|critical" archivo.log
```

**â“ Puedo combinar `grep` con `tail` o `head`?**

ğŸ‘‰ SÃ­, ejemplo:

```bash
tail -f archivo.log | grep "ERROR"
```

Muestra en tiempo real solo las lÃ­neas con `ERROR`.

### 5. ConclusiÃ³n

El comando **`grep`** es una de las herramientas mÃ¡s potentes de Linux/Unix para **buscar, filtrar y analizar texto**. Desde localizar errores en logs hasta buscar patrones complejos con expresiones regulares, `grep` es indispensable tanto para administradores de sistemas como para programadores.

ğŸ‘‰ **Aprender `grep` es dar un gran paso hacia el dominio de la terminal en Linux.**

---

[ğŸ”¼](#Ã­ndice)

---

## **431. El comando grep**

# El comando `grep` â€” explicaciÃ³n bien detallada con ejemplos

`grep` (**G**lobal **R**egular **E**xpression **P**rint) es la herramienta de bÃºsqueda por excelencia en Unix/Linux. Busca patrones (normalmente expresiones regulares) en archivos o en la entrada estÃ¡ndar y devuelve las lÃ­neas que coinciden. Es pequeÃ±o, rÃ¡pido y enormemente flexible â€” imprescindible para depurar, analizar logs, buscar en cÃ³digo, pipelines, etc.

A continuaciÃ³n tienes una guÃ­a completa: quÃ© hace, sintaxis, opciones clave, ejemplos prÃ¡cticos (desde lo bÃ¡sico hasta regex avanzadas), trucos de rendimiento y errores comunes.

---

# 1) Â¿QuÃ© es `grep`?

`grep` es un filtro de texto que:

- recibe uno o varios archivos o lee `stdin`,
- busca coincidencias con un _patrÃ³n_ (texto literal o expresiÃ³n regular),
- imprime las lÃ­neas que contienen ese patrÃ³n (por defecto),
- tiene muchas opciones: bÃºsquedas recursivas, insensitivas, mostrar nÃºmero de lÃ­nea, contexto, etc.

Es una herramienta no interactiva, pensada para usarse en scripts o en la terminal.

---

# 2) Sintaxis bÃ¡sica

```bash
grep [OPCIONES] 'PATRÃ“N' [ARCHIVO...]
```

Si no indicas `ARCHIVO`, `grep` lee de la entrada estÃ¡ndar:

```bash
command | grep 'error'
```

### Salida tÃ­pica

Por cada lÃ­nea que coincida, `grep` imprime la lÃ­nea completa (salvo que uses `-o` para imprimir solo la porciÃ³n coincidente).

---

# 3) Opciones esenciales (cheat-sheet rÃ¡pido)

- `-i` â†’ ignorar mayÃºsculas/minÃºsculas.
- `-n` â†’ mostrar nÃºmero de lÃ­nea.
- `-r` / `-R` â†’ recursivo en directorios.
- `-v` â†’ invertir la coincidencia (mostrar lÃ­neas que **no** coinciden).
- `-c` â†’ contar coincidencias por archivo.
- `-l` â†’ listar sÃ³lo nombres de archivos que contienen coincidencias.
- `-L` â†’ listar archivos **sin** coincidencias.
- `-w` â†’ palabra completa (coincide `cat` pero no `category`).
- `-o` â†’ mostrar sÃ³lo la parte coincidente (una por lÃ­nea).
- `-E` â†’ usar expresiones regulares extendidas (equivalente a `egrep`).
- `-F` â†’ _fixed strings_ (bÃºsqueda literal, muy rÃ¡pida; equivalente a `fgrep`).
- `-P` â†’ usar PCRE (Perl-compatible regex) â€” mÃ¡s potente (lookarounds, lazy quantifiers) â€” no siempre disponible en todas las builds.
- `--color=auto` â†’ resaltar coincidencias.
- `-A NUM` â†’ mostrar NUM lÃ­neas **After** (despuÃ©s) de la coincidencia.
- `-B NUM` â†’ mostrar NUM lÃ­neas **Before** (antes) de la coincidencia.
- `-C NUM` â†’ contexto: `-A NUM -B NUM` (ambos).
- `--exclude`, `--include` â†’ incluir/excluir archivos por patrÃ³n en bÃºsquedas recursivas.
- `-s` â†’ suprimir mensajes de error por archivos inexistentes.

---

# 4) Comportamiento / cÃ³digos de salida

- CÃ³digo `0` â†’ al menos una coincidencia encontrada.
- CÃ³digo `1` â†’ no se encontrÃ³ ninguna coincidencia.
- CÃ³digo `2` â†’ error (por ejemplo, archivo no accesible).

Esto es Ãºtil en scripts (`if grep -q 'pat' file; then ...`).

---

# 5) Ejemplos bÃ¡sicos y su explicaciÃ³n

### a) Buscar texto simple en un archivo

```bash
grep "error" /var/log/syslog
```

Imprime todas las lÃ­neas que contienen la cadena `error` (sensible a mayÃºsculas).

### b) Ignorar mayÃºsculas

```bash
grep -i "error" /var/log/syslog
```

Coincide con `Error`, `ERROR`, etc.

### c) Mostrar nÃºmero de lÃ­nea

```bash
grep -n "TODO" *.py
# salida ejemplo:
# script.py:42:# TODO: mejorar validaciÃ³n
```

### d) BÃºsqueda recursiva en un proyecto

```bash
grep -R --color=auto "deprecated_function" src/
```

### e) Mostrar sÃ³lo nombres de archivos que contienen el patrÃ³n

```bash
grep -l "main(" *.c
```

Devuelve una lista de archivos que deben inspeccionarse mÃ¡s a fondo.

### f) Contar coincidencias

```bash
grep -c "ERROR" app.log
# salida: 17
```

### g) Mostrar sÃ³lo la porciÃ³n que coincide

```bash
echo "user:juan@example.com" | grep -o '[[:alnum:]._-]\+@[[:alnum:].-]\+'
# salida: juan@example.com
```

---

# 6) Contexto alrededor de la coincidencia

A veces interesa ver las lÃ­neas antes/despuÃ©s:

```bash
grep -n -C 3 "Exception" app.log   # 3 lÃ­neas de contexto (antes y despuÃ©s)
grep -n -A 2 "Started" app.log      # 2 lÃ­neas AFTER
grep -n -B 4 "ERROR" app.log        # 4 lÃ­neas BEFORE
```

---

# 7) BÃºsqueda de palabra completa y patrones literales

- `-w` asegura coincidencia por palabra:

```bash
grep -w "cat" file.txt   # no casarÃ¡ "category"
```

- `-F` busca literales (Ãºtil si el patrÃ³n contiene metacaracteres que no quieres interpretar):

```bash
grep -F 'a+b' file.txt   # buscarÃ¡ la cadena literal "a+b"
```

---

# 8) Expresiones regulares â€” ejemplos prÃ¡cticos

### Expresiones POSIX bÃ¡sicas con `grep` (sin `-E`)

- `^` inicio de lÃ­nea, `$` fin de lÃ­nea, `.` cualquier carÃ¡cter, `*` repeticiÃ³n 0+, `[]` clases, `\{m,n\}` repeticiones.

```bash
grep "^ERROR" logs.txt     # lÃ­neas que empiezan por ERROR
grep "timeout$" logs.txt   # lÃ­neas que terminan en timeout
grep "^[0-9]\{4\}-[0-9]\{2\}-[0-9]\{2\}" logs.txt  # fechas YYYY-MM-DD al inicio
```

### Regex extendidas con `-E`

```bash
grep -E "ERROR|WARN" logs.txt     # OR alternation
```

### PCRE con `-P` (lookarounds, lazy, etc.)

```bash
# extraer lo que estÃ¡ entre parÃ©ntesis (sin incluir los parÃ©ntesis)
echo "foo(bar) baz" | grep -Po '(?<=\().+?(?=\))'
# salida: bar
```

`-P` y `-o` juntos son muy Ãºtiles para extracciÃ³n.

---

# 9) Usos prÃ¡cticos en pipelines

### Buscar procesos

```bash
ps aux | grep -i ssh
```

### Ver conexiones de red en puerto 80

```bash
ss -tnlp | grep ':80 '
# o
netstat -tulnp | grep ':80'
```

### Filtrar logs en tiempo real

```bash
tail -F /var/log/nginx/access.log | grep --line-buffered ' 500 '
```

`--line-buffered` evita buffers y muestra coincidencias enseguida.

---

# 10) BÃºsquedas recursivas avanzadas e ignorar archivos

```bash
# buscar en directorio pero excluir node_modules
grep -R --exclude-dir=node_modules "TODO" .

# buscar sÃ³lo en .py y .sh
grep -R --include='*.py' --include='*.sh' "import " project/
```

---

# 11) ExtracciÃ³n y transformaciÃ³n (ejemplos Ãºtiles)

### Extraer emails de archivos

```bash
grep -oP '[\w.+-]+@[\w.-]+' file.txt | sort -u
```

### Mostrar sÃ³lo URLs

```bash
grep -oP 'https?://[^\s]+' file.txt
```

### Buscar lÃ­neas duplicadas o contarlas por patrÃ³n

```bash
grep -oP '^[^ ]+' access.log | sort | uniq -c | sort -nr
# cuenta accesos por IP (ejemplo)
```

---

# 12) Performance y buenas prÃ¡cticas

- Para bÃºsquedas literales rÃ¡pidas usa `-F`.
- Para mÃ¡xima velocidad en texto plano puedes forzar la localizaciÃ³n a C:

```bash
LC_ALL=C grep -R "patrÃ³n" .
```

`LC_ALL=C` suele acelerar porque usa ordenamiento/colaciÃ³n simple (ASCII).

- Para proyectos grandes considera `ripgrep` (`rg`) o `the_silver_searcher (ag)` â€” son alternativas mucho mÃ¡s rÃ¡pidas y con sintaxis similar.
- Evita `cat file | grep pattern` cuando `grep pattern file` funciona (evita un proceso extra).

---

# 13) Gotchas y puntos a tener en cuenta

- **Escapar caracteres**: en la shell, caracteres especiales (`*`, `?`, `[]`, `$`, `()`, `\`) pueden necesitar comillas o escape.

  ```bash
  grep '\$PATH' file        # busca literal $PATH; es mejor con comillas simples
  grep -F '$PATH' file      # o fixed-string
  ```

- **Binary files**: si pasas binarios, `grep` puede decir `Binary file matches`. Usa `-a` (`--binary-files=text`) para tratarlos como texto.
- **Unicode/locale**: coincidencias con caracteres multibyte dependen de la locale; `LC_ALL=C` cambia comportamiento.
- **Salida en scripts**: usa `-q` (quiet) si sÃ³lo te interesa el cÃ³digo de salida:

  ```bash
  if grep -q 'ERROR' file; then echo "hay error"; fi
  ```

---

# 14) Ejemplos avanzados (combinados)

### Encontrar funciones en cÃ³digo (Python)

```bash
grep -n -E "^def [a-zA-Z0-9_]+\(" -R src/
```

### Detectar TODOs y mostrar contexto

```bash
grep -n -R -C 2 "TODO" project/
```

### Buscar archivos sin un patrÃ³n (por ejemplo, sin license)

```bash
grep -L "Copyright" *.py
```

---

# 15) Alternativas y herramientas relacionadas

- `egrep` / `fgrep` (obsoletos; `-E` y `-F` son preferibles).
- `ripgrep (rg)` â€” bÃºsqueda recursiva ultra rÃ¡pida y sensible a .gitignore.
- `ag (the_silver_searcher)` â€” otra alternativa veloz.
- `awk` / `sed` â€” para procesamientos mÃ¡s complejos de las lÃ­neas encontradas.

---

# 16) ConclusiÃ³n

`grep` es la herramienta fundamental para buscar y filtrar texto en Unix/Linux. Dominar sus opciones (contexto, recursividad, expresiones regulares y modos `-F`, `-P`) multiplicarÃ¡ tu productividad al trabajar con logs, cÃ³digo y pipelines. Para tareas muy grandes o de desarrollo, considera `ripgrep` por rendimiento, pero `grep` sigue siendo imprescindible para scripts y administraciÃ³n.

---

Â¿Quieres que te prepare un **cheat-sheet imprimible** con los comandos `grep` mÃ¡s usados y sus ejemplos rÃ¡pidos?
O si prefieres, puedo darte **5 ejercicios prÃ¡cticos** con soluciones para que practiques (buscar emails, contar errores, extraer URLs, etc.). Â¿CuÃ¡l quieres?

---

[ğŸ”¼](#Ã­ndice)

---

| **Inicio**         | **atrÃ¡s 9**          | **Siguiente 11**          |
| ------------------ | -------------------- | ------------------------- |
| [ğŸ ](../README.md) | [âª](./13_9_head.md) | [â©](./13_11_nslookup.md) |
