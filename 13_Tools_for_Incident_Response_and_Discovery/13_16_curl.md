| **Inicio**         | **atr√°s 15**              | **Siguiente 17**           |
| ------------------ | ------------------------- | -------------------------- |
| [üè†](../README.md) | [‚è™](./13_15_ipconfig.md) | [‚è©](./13_17_Wireshark.md) |

---

## **√çndice**

| Temario                                                                            |
| ---------------------------------------------------------------------------------- |
| [442. ¬øQu√© es el comando cURL?](#442-qu√©-es-el-comando-curl)                       |
| [443. Necesitas saber c√≥mo utilizar cURL](#443-necesitas-saber-c√≥mo-utilizar-curl) |

# **Curl**

## **442. ¬øQu√© es el comando cURL?**

- **cURL** significa **Client URL**.
- Es una herramienta de l√≠nea de comandos usada para **transferir datos** hacia o desde un servidor, utilizando diferentes protocolos de red (HTTP, HTTPS, FTP, SMTP, etc.).
- Permite hacer **peticiones web** directamente desde la terminal, probar APIs, descargar archivos o enviar formularios.
- Est√° disponible en **Linux, macOS y Windows**.

üëâ Piensa en `cURL` como un **navegador en la terminal**, que no muestra gr√°ficos, solo datos.

### üìå ¬øPor qu√© utilizar `cURL`?

1. **Pruebas r√°pidas de red**: comprobar si un servidor responde.
2. **Trabajo con APIs**: enviar y recibir datos JSON/XML.
3. **Descargar archivos** sin usar un navegador.
4. **Automatizaci√≥n** en scripts (bash, PowerShell, etc.).
5. **Depuraci√≥n**: ver encabezados HTTP, c√≥digos de estado, certificados SSL.
6. Funciona con **muchos protocolos**, no solo HTTP/HTTPS.

### üìå ¬øQu√© necesitas para utilizar `cURL`?

- **Linux/macOS** ‚Üí cURL viene preinstalado.
  Verifica con:

  ```bash
  curl --version
  ```

- **Windows** ‚Üí Desde Windows 10 ya viene incluido. En versiones anteriores se puede instalar manualmente.

### üìå Sintaxis b√°sica de `cURL`

```
curl [opciones] [URL]
```

Ejemplo m√≠nimo:

```bash
curl https://example.com
```

üëâ Descarga el HTML de la p√°gina.

Opciones comunes:

- `-o archivo` ‚Üí Guardar salida en un archivo.
- `-O` ‚Üí Guardar con el mismo nombre del servidor.
- `-I` ‚Üí Solo mostrar encabezados HTTP.
- `-L` ‚Üí Seguir redirecciones.
- `-v` ‚Üí Modo verbose (detallado).
- `-X` ‚Üí Especificar m√©todo HTTP (GET, POST, PUT, DELETE).
- `-d` ‚Üí Enviar datos en un POST.
- `-H` ‚Üí A√±adir encabezados personalizados.

### üìå Ejemplos de comandos `cURL`

#### 1. Obtener el HTML de una web

```bash
curl https://www.google.com
```

#### 2. Descargar un archivo y guardarlo con nombre espec√≠fico

```bash
curl -o logo.png https://www.example.com/logo.png
```

#### 3. Descargar con el nombre original

```bash
curl -O https://www.example.com/logo.png
```

#### 4. Ver solo los encabezados HTTP

```bash
curl -I https://www.example.com
```

Salida:

```
HTTP/1.1 200 OK
Content-Type: text/html; charset=UTF-8
Content-Length: 1256
```

#### 5. Seguir redirecciones

```bash
curl -L http://example.com
```

#### 6. Hacer una petici√≥n POST con datos

```bash
curl -X POST -d "usuario=gustavo&clave=1234" https://api.example.com/login
```

##### 7. Enviar datos JSON a una API

```bash
curl -X POST https://api.example.com/users \
     -H "Content-Type: application/json" \
     -d '{"nombre":"Gustavo","rol":"admin"}'
```

#### 8. Descargar m√∫ltiples archivos

```bash
curl -O https://example.com/file1.txt -O https://example.com/file2.txt
```

#### 9. Autenticaci√≥n con usuario y contrase√±a

```bash
curl -u usuario:contrase√±a https://api.example.com/data
```

#### 10. Guardar salida en un archivo log

```bash
curl -v https://example.com > salida.txt 2> debug.log
```

### üìå Protocolos y formatos compatibles con `cURL`

#### üîπ Protocolos m√°s usados:

- HTTP / HTTPS
- FTP / FTPS
- SCP / SFTP
- SMTP / IMAP / POP3
- LDAP
- FILE (archivos locales)

#### üîπ Formatos de datos comunes:

- **HTML** (p√°ginas web)
- **JSON** (APIs REST)
- **XML**
- **Archivos binarios** (im√°genes, PDFs, etc.)

### üìå Salidas del comando `cURL`

Por defecto:

- Imprime la respuesta del servidor en la terminal.
- Puedes redirigirla a un archivo (`-o`).
- Con `-v` o `--verbose` muestra todo el proceso de conexi√≥n.
- Con `-w` (`--write-out`) puedes personalizar la salida (ej. solo c√≥digo HTTP):

  ```bash
  curl -o /dev/null -s -w "%{http_code}\n" https://example.com
  ```

  üëâ Esto imprime solo el c√≥digo de estado (`200`, `404`, etc.).

### üìå Resumen r√°pido (Cheat Sheet)

| Uso                                     | Comando                                                             |
| --------------------------------------- | ------------------------------------------------------------------- |
| Ver HTML                                | `curl https://example.com`                                          |
| Descargar archivo con nombre espec√≠fico | `curl -o archivo.txt URL`                                           |
| Descargar archivo con nombre original   | `curl -O URL`                                                       |
| Ver encabezados HTTP                    | `curl -I URL`                                                       |
| Seguir redirecciones                    | `curl -L URL`                                                       |
| POST con datos                          | `curl -X POST -d "a=1&b=2" URL`                                     |
| POST JSON                               | `curl -X POST -H "Content-Type: application/json" -d '{"x":1}' URL` |
| Autenticaci√≥n b√°sica                    | `curl -u user:pass URL`                                             |
| Mostrar c√≥digo HTTP                     | `curl -o /dev/null -s -w "%{http_code}" URL`                        |

‚úÖ **En conclusi√≥n**: `cURL` es una herramienta **muy poderosa** para desarrolladores, administradores de sistemas y especialistas en ciberseguridad. Te permite **probar APIs, descargar archivos, depurar problemas de red y automatizar procesos de transferencia de datos**.

---

[üîº](#√≠ndice)

---

## **443. Necesitas saber c√≥mo utilizar cURL**

`curl` es la navaja suiza para ejecutar peticiones de red desde la terminal. Si vas a trabajar con APIs, automatizar descargas, depurar conexiones HTTP/S o integrarlo en scripts ‚Äî dominar `curl` te ahorra horas. Aqu√≠ tienes todo lo imprescindible, con ejemplos listos para copiar y adaptar.

### 1) ¬øPor qu√© aprender `curl`?

- Probar APIs REST sin escribir c√≥digo.
- Descargar/continuar archivos desde consola.
- Depurar cabeceras HTTP, cookies y certificados.
- Automatizar tareas en scripts (CI, backups, monitoreo).
- Trabajar con FTP/SFTP, SMTP u otros protocolos soportados.

### 2) Requisitos / instalaci√≥n r√°pida

- Linux/macOS: normalmente ya instalado. Verifica:

```bash
curl --version
```

- Windows 10+: viene incluido; en versiones antiguas instala desde [https://curl.se](https://curl.se).
- Recomiendo adem√°s instalar `jq` para procesar JSON (`sudo apt install jq` o `brew install jq`).

### 3) Sintaxis b√°sica

```
curl [OPCIONES] URL
```

Ejemplo m√≠nimo:

```bash
curl https://example.com
```

Por defecto muestra la respuesta en stdout (tu terminal).

### 4) Conceptos y opciones clave (grupo por prop√≥sito)

#### Mostrar/guardar respuestas

- `-o archivo` ‚Üí guardar respuesta en `archivo`.
- `-O` ‚Üí guardar con el nombre remoto.
- `-s` ‚Üí silencioso (sin barra de progreso).
- `-S` ‚Üí mostrar errores cuando `-s` est√° activo.
- `-#` ‚Üí mostrar barra de progreso.

Ejemplo:

```bash
curl -L -o index.html https://example.com    # seguir redirecciones y guardar
curl -O https://example.com/files/app.zip     # guardar como app.zip
```

#### Cabeceras y metadatos

- `-I` ‚Üí s√≥lo encabezados (HEAD request).
- `-i` ‚Üí encabezados + cuerpo.
- `-H "Header: valor"` ‚Üí a√±adir header.

Ejemplo:

```bash
curl -I https://api.example.com
curl -i -H "Accept: application/json" https://api.example.com/resource
```

#### M√©todos HTTP y datos

- `-X VERB` ‚Üí m√©todo expl√≠cito (GET/POST/PUT/DELETE/PATCH).
- `-d 'a=1&b=2'` ‚Üí enviar datos (form-urlencoded).
- `--data-urlencode` ‚Üí codificar valores.
- `-F "file=@mi.jpg"` ‚Üí multipart/form-data (files).

Ejemplos:

```bash
# POST form
curl -X POST -d "user=juan&pass=secreto" https://api.example.com/login

# POST JSON desde la terminal
curl -X POST https://api.example.com/users \
  -H "Content-Type: application/json" \
  -d '{"name":"Mar√≠a","role":"dev"}'

# POST JSON desde archivo
curl -X POST https://api.example.com/users \
  -H "Content-Type: application/json" \
  -d @payload.json

# Subir archivo multipart
curl -F "avatar=@foto.jpg" -F "user=juan" https://api.example.com/upload
```

#### Autenticaci√≥n

- Basic auth: `-u usuario:contrase√±a`.
- Bearer token: `-H "Authorization: Bearer TOKEN"`.
- Certificado cliente: `--cert cert.pem --key key.pem`.

Ejemplos:

```bash
curl -u admin:pass https://service.local/api
curl -H "Authorization: Bearer $TOKEN" https://api.example.com/secure
curl --cert client.pem --key client.key https://secure.example.com
```

#### Cookies

- `--cookie-jar cookies.txt` ‚Üí guardar cookies.
- `--cookie cookies.txt` ‚Üí enviar cookies guardadas.

Ejemplo (login con cookies y luego usar sesi√≥n):

```bash
curl -c cookies.txt -d "user=ju&pass=1" https://site/login
curl -b cookies.txt https://site/dashboard
```

#### SSL / TLS

- `--insecure` / `-k` ‚Üí no verificar certificado (evitar en producci√≥n).
- `--cacert CA.pem` ‚Üí usar CA personalizada.

Ejemplo:

```bash
curl --cacert myCA.pem https://internal.example
curl -k https://self-signed.example    # s√≥lo en pruebas
```

#### Redirecciones

- `-L` ‚Üí seguir redirecciones 3xx.

#### Limitaciones y tiempos

- `--max-time <s>` ‚Üí tiempo m√°ximo total.
- `--connect-timeout <s>` ‚Üí tiempo hasta conectar.
- `--retry N` y `--retry-delay S` ‚Üí reintentar en fallos transitorios.

Ejemplo:

```bash
curl --connect-timeout 5 --max-time 30 --retry 3 --retry-delay 2 https://api.example
```

#### Depuraci√≥n y logging

- `-v` ‚Üí verbose (mostrar TLS handshake, headers).
- `--trace trace.txt` ‚Üí traza completa.
- `--trace-ascii` ‚Üí traza legible.

Ejemplo:

```bash
curl -v https://api.example.com 2>curl-debug.txt
curl --trace-ascii trace.txt https://api.example.com
```

#### Resumir/limitar descargas

- `-C -` ‚Üí reanudar descarga desde donde qued√≥.
- `--limit-rate 200k` ‚Üí limitar velocidad.

Ejemplo:

```bash
curl -C - -O http://bigfile.example.com/large.iso
curl --limit-rate 500k -O http://server/file.zip
```

#### Protocolos y caracter√≠sticas extra

- `--ftp-ssl` / `--ssl` / `--sftp` / `--scp` ‚Üí FTP/SFTP/SCP.
- `--http2` / `--http3` ‚Üí forzar HTTP/2 o HTTP/3 (si compilado con soporte).
- `--compressed` ‚Üí solicitar y descomprimir gzip/deflate.

### 5) Ejemplos pr√°cticos seg√∫n tareas reales

#### A) Comprobar si una API responde y obtener c√≥digo HTTP

```bash
curl -s -o /dev/null -w "%{http_code} %{time_total}s\n" https://api.example.com/health
# salida: 200 0.123s
```

`-w` (`--write-out`) permite extraer m√©tricas: `%{http_code}`, `%{time_total}`, `%{size_download}`, `%{url_effective}`.

#### B) Obtener JSON y extraer campos con `jq`

```bash
curl -s https://api.example.com/user/42 | jq '.name, .email'
```

#### C) Autenticaci√≥n OAuth (obt√©n token y √∫salo)

```bash
# 1) solicitar token
TOKEN=$(curl -s -X POST https://auth.example.com/token \
  -d "grant_type=client_credentials&client_id=ID&client_secret=SECRET" | jq -r '.access_token')

# 2) usar token
curl -H "Authorization: Bearer $TOKEN" https://api.example.com/protected
```

#### D) Subir form-data con archivo y campos extras

```bash
curl -F "user=juan" -F "file=@/home/juan/report.pdf" https://upload.example.com
```

#### E) Descargar y reanudar

```bash
curl -C - -O https://example.com/huge.iso
```

#### F) Interactuar v√≠a FTP (descarga an√≥nima)

```bash
curl -O ftp://ftp.example.org/pub/file.tar.gz
```

#### G) Usar proxy

```bash
curl -x http://proxy.company:3128 https://example.com
```

### 6) `curl` en scripts: patr√≥n robusto

Ejemplo de script Bash que llama API y gestiona fallos:

```bash
#!/usr/bin/env bash
set -euo pipefail

URL="https://api.example.com/data"
OUT="/tmp/response.json"

http_code=$(curl -s -w "%{http_code}" -o "$OUT" --max-time 10 --retry 3 "$URL")

if [[ "$http_code" -ne 200 ]]; then
  echo "Error: HTTP $http_code"
  cat "$OUT"
  exit 1
fi

jq '.' "$OUT"
```

Puntos: `-s -w`, comprobar c√≥digo, salida en archivo temporal y parseo con `jq`.

### 7) Depuraci√≥n avanzada

- ¬øProblemas TLS? `curl -v --trace-ascii trace.txt` y revisar handshake.
- ¬øHeader faltante? usar `-i` o `-v` para ver headers de request/response.
- ¬øRedirecciones extra√±as? `-L -v` para seguir y ver cada hop.

### 8) Seguridad y buenas pr√°cticas

- **Nunca** incluyas credenciales en comandos compartidos; usa variables de entorno o archivos con permisos restringidos.
- **Evita** `--insecure` en producci√≥n.
- Prefiere tokens con scopes limitados y corta vida.
- Guarda cookies y tokens en archivos con permisos `600`.
- Registra `curl --trace` s√≥lo en entornos seguros (evita filtrar secretos).

### 9) Notas espec√≠ficas para Windows / PowerShell

- En PowerShell `curl` es alias de `Invoke-WebRequest`. Para ejecutar el binario real usa `curl.exe`.
- Ejemplo PowerShell real con curl.exe:

```powershell
curl.exe -s -o page.html https://example.com
```

### 10) Cheatsheet r√°pido (comandos √∫tiles)

- GET simple: `curl https://example.com`
- Guardar: `curl -L -o file.html https://example.com`
- Follow redirect: `-L`
- Headers: `-I` (HEAD), `-i` (headers+bodey)
- POST JSON: `-X POST -H "Content-Type: application/json" -d @payload.json URL`
- Multipart: `-F "file=@archivo.jpg"`
- Auth Basic: `-u user:pass`
- Bearer token: `-H "Authorization: Bearer $TOKEN"`
- Resumir: `-C - -O URL`
- Debug: `-v`, `--trace-ascii file`
- SSL insecure: `-k` (no recomendado)
- Timeouts/retries: `--connect-timeout 5 --max-time 30 --retry 3`
- Write-out: `-w "%{http_code} %{time_total}\n"`

### 11) Cosas que **no** hace `curl` (y herramientas complementarias)

- No es un cliente Web interactivo (usa navegador para JS/DOM).
- No maneja tests complejos de APIs con aserciones (usa `httpie`, `Postman`, `pytest + requests` u otras).
- Para an√°lisis de tokens/flow OAuth, combina `curl` con `jq` y scripts.

### 12) Ejercicio pr√°ctico corto para empezar

1. Obtener status de una API:

```bash
curl -s -o /dev/null -w "%{http_code} %{time_total}\n" https://api.github.com
```

2. Hacer POST JSON (simulado):

```bash
curl -X POST https://httpbin.org/post \
  -H "Content-Type: application/json" \
  -d '{"test":123}' | jq .
```

3. Descargar archivo y reanudar:

```bash
curl -C - -O https://speed.hetzner.de/1GB.bin
```

---

[üîº](#√≠ndice)

---

| **Inicio**         | **atr√°s 15**              | **Siguiente 17**           |
| ------------------ | ------------------------- | -------------------------- |
| [üè†](../README.md) | [‚è™](./13_15_ipconfig.md) | [‚è©](./13_17_Wireshark.md) |
