| **Inicio**         | **atr√°s 34**               | **Siguiente 36**              |
| ------------------ | -------------------------- | ----------------------------- |
| [üè†](../README.md) | [‚è™](./13_34_NAC_based.md) | [‚è©](./13_36_Group_Policy.md) |

---

## **√çndice**

| Temario                                                                                                                                                            |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| [479. ¬øQu√© es el bloqueo de puertos?](#479-qu√©-es-el-bloqueo-de-puertos)                                                                                           |
| [480. ¬øTu router est√° bloqueando tus puertos? Aqu√≠ te explicamos c√≥mo averiguarlo](#480-tu-router-est√°-bloqueando-tus-puertos-aqu√≠-te-explicamos-c√≥mo-averiguarlo) |

# **Port Blocking**

## **479. ¬øQu√© es el bloqueo de puertos?**

![Port Blocking](/img/13_Tools_for_Incident_Response_and_Discovery/Port_Blocking.jpg "Port Blocking")

Un **puerto** es un n√∫mero que identifica una aplicaci√≥n/servicio en un host (p. ej. 80 ‚Üí HTTP, 443 ‚Üí HTTPS, 22 ‚Üí SSH).
El **bloqueo de puertos** significa impedir el tr√°fico hacia o desde un puerto concreto en un host o en la red. Se puede hacer en varios puntos: firewall del equipo, firewall de red (router, appliance), pol√≠ticas del ISP, reglas NAT, o por la propia aplicaci√≥n.

**Efecto:** si el puerto est√° bloqueado, una aplicaci√≥n que escucha en ese puerto no recibir√° conexiones (o no podr√° establecer salidas), y quien intente conectarse obtendr√° timeout o rechazo.

### ¬øPor qu√© se bloquean puertos? (motivos)

- **Seguridad:** reducir superficie de ataque (cerrar puertos innecesarios).
- **Pol√≠tica/operativa:** ISPs bloquean puertos usados para spam (p. ej. 25) o para administrar servicios.
- **Control de acceso / QoS:** restringir servicios a VLANs o redes de confianza.
- **Protecci√≥n de endpoint:** antivirus/endpoint firewall bloquea puertos para impedir exploits o C2.
- **Errores de configuraci√≥n** o NAT mal hecho tambi√©n pueden ‚Äúparecer‚Äù bloqueos.

### Redes seguras: papel del bloqueo de puertos en ciberseguridad

- **Regla m√≠nima (least privilege):** s√≥lo abrir los puertos necesarios.
- **Compensaci√≥n:** cerrar puertos p√∫blicos evita escaneo/ataques autom√°ticos (worms, exploits).
- **Segmentaci√≥n:** diferentes zonas con diferentes puertos abiertos; as√≠ si un segmento cae, no compromete todo.
- **Capa en defensa en profundidad:** bloqueo de puertos + IDS/IPS + EDR + autenticaci√≥n multi-factor.

### ¬øPor qu√© los antivirus usan bloqueo de puertos?

Las suites de seguridad modernas incluyen **firewall de aplicaciones/host** que:

- Evitan que **procesos maliciosos** abran listeners (ej. backdoors).
- Bloquean conexiones salientes sospechosas (comando y control, exfiltraci√≥n).
- Previenen exploits en servicios que abren puertos (por ejemplo, detener que un proceso descargue un payload por un puerto no autorizado).

En la pr√°ctica: el antivirus/hardening intercepta intentos de escucha o conexiones y los bloquea si no son de una app autorizada.

### ¬øPuede el bloqueo de puertos afectar mi velocidad de Internet?

- **Directo:** No ‚Äî bloquear un puerto concreto no reduce el ancho de banda de otros puertos/protocolos (p. ej. el bloqueo del puerto 25 no hace que HTTPS vaya m√°s lento).
- **Indirecto:** s√≠ puede aparentar impacto si:

  - Bloqueas los puertos usados por una aplicaci√≥n (p. ej. un juego o CDN) y la app usa fallback por rutas ineficientes ‚Üí menos rendimiento.
  - Un firewall/Proxy inspecciona todo el tr√°fico (deep packet inspection) y a√±ade latencia.
  - NAT table saturada o CPU del firewall al filtrar mucho tr√°fico causa cuello de botella.

En resumen: el bloqueo _en s√≠_ no baja la velocidad, pero la configuraci√≥n de seguridad y la inspecci√≥n s√≠ pueden afectar latencia/throughput.

### ¬øC√≥mo comprobar si un puerto est√° bloqueado? ‚Äî M√©todos y comandos

> **Aviso**: realizar escaneos o pruebas fuera de tu red sin permiso puede ser ilegal. Usa estas pruebas en tus hosts/redes o con autorizaci√≥n.

#### 1) Comprobar localmente (¬øhay servicio escuchando?)

**Windows (PowerShell)**

```powershell
# ver puertos escuchando
Get-NetTCPConnection -State Listen | Format-Table LocalAddress,LocalPort,OwningProcess

# o con netstat
netstat -ano | findstr LISTEN
```

**Linux/macOS**

```bash
# ss (moderno)
ss -tuln
# o lsof
sudo lsof -iTCP -sTCP:LISTEN -P -n
# netstat (legacy)
netstat -tuln
```

Si no aparece el puerto en `LISTEN`, el servicio no est√° activo; no es bloqueo de red sino falta de servicio.

#### 2) Probar conexi√≥n **saliente** desde tu equipo

**Telnet / nc / curl / PowerShell Test-NetConnection**

- **Linux / macOS**:

```bash
# prueba TCP al puerto 22 en host remoto
nc -vz example.com 22
# o
telnet example.com 22
```

- **Windows PowerShell**:

```powershell
Test-NetConnection -ComputerName example.com -Port 22
```

- **curl** para puertos HTTP/S:

```bash
curl -v http://example.com:8080/
```

**Resultados**:

- `succeeded` / `Connected` ‚Üí puerto accesible (no bloqueado para salida).
- `connection timed out` ‚Üí probablemente filtrado por firewall (drop).
- `connection refused` ‚Üí el host rechaz√≥ la conexi√≥n (puerto cerrado en destino, no necesariamente bloqueado en la red).

#### 3) Probar **entrante** (desde Internet hacia tu host)

Si quieres saber si tu host es accesible desde Internet (p. ej. servidor en casa detr√°s de router/NAT):

- **Desde un servidor en la nube (o m√≥vil en 4G)**:

```bash
nc -vz tu-ip-publica 3389
```

- **Herramientas online** (port scanners p√∫blicos) ‚Äî ejemplos: ‚ÄúOpen Port Check Tool‚Äù, ‚ÄúShieldsUP‚Äù (usa con permiso).
- **nmap** (desde otro host):

```bash
nmap -p 22,80,443 tu-ip-publica
```

Si `filtered` ‚Üí firewall est√° bloqueando. Si `closed` ‚Üí puerto no est√° abierto por servicio/NAT.

#### 4) Ver reglas de firewall en tu equipo / router

**Windows Firewall (GUI)** ‚Äî ‚ÄúWindows Defender Firewall with Advanced Security‚Äù ‚Üí Inbound Rules / Outbound Rules.

**PowerShell**:

```powershell
Get-NetFirewallRule | Where-Object { $_.Enabled -eq "True" } | Format-Table DisplayName,Direction,Action
```

**Linux (iptables/nftables/ufw)**:

```bash
# iptables
sudo iptables -L -n -v
# ufw
sudo ufw status verbose
# nftables
sudo nft list ruleset
```

**Router**: entra a la interfaz web/CLI del router y revisa reglas de firewall / port forwarding / NAT.

#### 5) Diagn√≥stico con ICMP y traceroute

- `ping` y `traceroute` ayudan a saber si hay conectividad general.
- Si `ping` OK pero TCP al puerto falla ‚Üí bloqueo espec√≠fico de puerto.

#### 6) Logs y herramientas de diagn√≥stico

- Revisa logs del firewall local (`/var/log/ufw.log` / syslog) o del router para entradas de denegaci√≥n.
- Revisa logs del antivirus/host firewall (por ej. Windows Security/Windows Defender).

### Puertos frecuentemente bloqueados (ejemplos reales)

- **25 (SMTP)**: muchos ISPs lo bloquean para evitar spam saliente.
- **135‚Äì139, 445 (NetBIOS/SMB)**: a menudo bloqueados desde Internet por seguridad.
- **23 (Telnet)**: bloqueado por inseguro.
- **3306 (MySQL), 5432 (Postgres)**: generalmente no se exponen a Internet.
- **Rango alto**: puertos din√°micos/ephemeral no suelen bloquearse, pero policies pueden afectar.

### Qu√© hacer si un puerto est√° bloqueado (remedios)

1. **Verifica servicio local**: aseg√∫rate que el daemon/service est√© `LISTEN`.
2. **Revisa firewall local** (Windows Firewall, ufw, iptables). Permite el puerto si procede.
3. **Revisa NAT/port forwarding** en tu router si esperas accesos desde Internet.
4. **Consulta al ISP**: algunos bloqueos (p.ej. 25) los impone el proveedor. Solicita desbloqueo si justificas caso de uso.
5. **Usa VPN o t√∫nel** si debes permitir tr√°fico desde fuera (con precauci√≥n y seguridad).
6. **Audita antivirus/EDR**: puede bloquear por pol√≠tica; crea excepci√≥n segura para la app si es leg√≠tima.

### Buenas pr√°cticas de seguridad con bloqueo de puertos

- Abrir s√≥lo lo estrictamente necesario (principio de m√≠nimo privilegio).
- Usar autenticaci√≥n fuerte y cifrado en servicios expuestos (TLS, SSH con keys).
- Mantener servicios actualizados y parches aplicados.
- Segmentar redes (VLANs) y usar ACLs para limitar alcance.
- Registrar (logging) y monitorizar rechazos/inten√ß√µes recurrentes (SIEM).
- No depender solo de puerto cerrado ‚Äî complementar con IDS/IPS y controles en capa aplicaci√≥n.

### Resumen pr√°ctico r√°pido (cheat-sheet)

- **¬øComprobar servicio local?** `ss -tuln` / `netstat -ano` / `Get-NetTCPConnection -State Listen`
- **¬øProbar salida a puerto remoto?** `nc -vz host port` / `Test-NetConnection -Port` / `curl -v`
- **¬øProbar desde Internet a mi IP?** `nmap -p port mi-ip-publica` (desde host externo) o usar herramienta en l√≠nea.
- **¬øVer reglas de firewall?** `iptables -L` / `sudo ufw status` / Windows Firewall GUI / `Get-NetFirewallRule`
- **¬øSi est√° bloqueado?** revisar servicio local ‚Üí firewall host ‚Üí router/NAT ‚Üí ISP ‚Üí pol√≠ticas de seguridad (EDR/AV).

---

[üîº](#√≠ndice)

---

## **480. ¬øTu router est√° bloqueando tus puertos? Aqu√≠ te explicamos c√≥mo averiguarlo**

### üîé Comprensi√≥n de puertos y enrutadores

- Un **puerto** es un n√∫mero l√≥gico que identifica un servicio en un dispositivo (ej. 80 ‚Üí HTTP, 443 ‚Üí HTTPS, 22 ‚Üí SSH).
- Un **router** conecta tu red interna con Internet y suele incluir un **firewall** que bloquea o filtra tr√°fico para protegerte.
- El router puede:

  - Bloquear puertos por defecto para evitar ataques.
  - Permitir abrir puertos manualmente con **Port Forwarding**.

### üö´ ¬øPor qu√© est√°n bloqueados los puertos en los enrutadores?

1. **Seguridad:** Evitar accesos no autorizados a tu red local.
2. **Prevenci√≥n de malware:** Proteger contra gusanos o bots que usan puertos inseguros (ej. 135‚Äì139 SMB, 23 Telnet).
3. **Restricciones del ISP:** Algunos proveedores bloquean puertos como el 25 (SMTP) o el 80 (HTTP) para evitar abuso.
4. **Configuraci√≥n por defecto:** Muchos routers cierran todo excepto el tr√°fico saliente (puertos abiertos solo desde dentro hacia fuera).

### üïµÔ∏è C√≥mo comprobar si un puerto est√° bloqueado en tu enrutador

#### ‚úÖ M√©todo 1: Usar la interfaz web del router

1. Con√©ctate al router (ej. [http://192.168.1.1](http://192.168.1.1) o [http://192.168.0.1](http://192.168.0.1)).
2. Inicia sesi√≥n con usuario y contrase√±a (por defecto: admin/admin o el que hayas configurado).
3. Busca la secci√≥n: **Firewall**, **Port Forwarding**, **NAT** o **Virtual Server**.
4. Revisa si el puerto aparece en la lista de reglas bloqueadas o si necesitas abrirlo manualmente.

**Ejemplo:** Quieres usar un servidor de juegos en el puerto 25565 (Minecraft).

En la interfaz del router agregas una regla de **Port Forwarding** para tu IP local (192.168.1.100 ‚Üí 25565).

#### ‚úÖ M√©todo 2: Utilizar un esc√°ner de puertos

Puedes usar herramientas locales o en l√≠nea para comprobar accesibilidad de puertos desde Internet.

- **nmap** (Linux/Windows con WSL):

```bash
nmap -p 80,443,25565 mi-ip-publica
```

Salida:

- `open` ‚Üí puerto abierto.

- `closed` ‚Üí servicio no escucha.

- `filtered` ‚Üí probablemente firewall/router bloqueando.

- **Herramientas web**:

  - "Open Port Check Tool" (canyouseeme.org).
  - ShieldsUP de Gibson Research.

#### ‚úÖ M√©todo 3: Usar el s√≠mbolo del sistema

**Windows (PowerShell):**

```powershell
Test-NetConnection -ComputerName mi-ip-publica -Port 25565
```

**Linux/macOS:**

```bash
nc -vz mi-ip-publica 25565
```

Si devuelve **Timeout o Filtered**, el router/ISP est√° bloqueando.

Si devuelve **Connection Refused**, el router pasa el tr√°fico, pero no hay servicio escuchando.

### üõ†Ô∏è Soluci√≥n de problemas de bloqueo de puertos

#### üîπ Paso 1: Verifique la configuraci√≥n del enrutador

- Entre en la interfaz web.
- Revise si hay reglas de **Port Forwarding** configuradas correctamente.
- Aseg√∫rese de asignar la **IP local correcta** del dispositivo.

#### üîπ Paso 2: Verifique las reglas del firewall

- Algunos routers tienen firewalls adicionales que bloquean puertos.
- En routers avanzados, puedes definir **ACLs** (listas de control de acceso).

#### üîπ Paso 3: Verifique el bloqueo del ISP

- Pregunta a tu proveedor si bloquean puertos espec√≠ficos.
- Ejemplo: muchos ISPs bloquean **puerto 25 (SMTP)** por spam.

#### üîπ Paso 4: Reiniciar el enrutador

- A veces un reinicio aplica nuevas reglas de firewall o limpia sesiones bloqueadas.

### üìå Preguntas frecuentes

#### üîπ ¬øQu√© es el bloqueo de puertos y por qu√© ocurre?

Es la denegaci√≥n de tr√°fico entrante/saliente en un puerto espec√≠fico, normalmente por seguridad o pol√≠ticas del ISP.

#### üîπ ¬øC√≥mo s√© si mi enrutador est√° bloqueando puertos?

- Si desde dentro funciona (localhost o red interna) pero desde fuera no, lo m√°s probable es que sea el router/firewall.
- Usa herramientas como `nmap`, `Test-NetConnection`, `canyouseeme.org`.

#### üîπ ¬øCu√°les son los puertos m√°s comunes que est√°n bloqueados?

- **25 (SMTP):** evitar spam.
- **135‚Äì139 y 445 (NetBIOS/SMB):** evitar gusanos.
- **23 (Telnet):** inseguro.
- **80 (HTTP) en algunos ISPs:** para que no hospedes servidores web en casa.

#### üîπ ¬øC√≥mo puedo verificar qu√© puertos est√°n bloqueados?

- Revisando logs del router.
- Escaneando con `nmap`.
- Usando servicios en l√≠nea de port check.

#### üîπ ¬øPuedo desbloquear puertos en mi enrutador?

S√≠, creando reglas de **Port Forwarding** o **DMZ** (menos recomendable).

Ejemplo:

Router TP-Link ‚Üí Forwarding ‚Üí Virtual Servers ‚Üí Agregar ‚Üí Servicio: 25565 ‚Üí IP local 192.168.1.100.

#### üîπ ¬øCu√°les son los riesgos de desbloquear puertos?

- Dejas tu red expuesta a Internet.
- Un servicio mal configurado puede ser atacado (ej. RDP en puerto 3389).
- Riesgo de malware, fuerza bruta o explotaci√≥n remota.

#### üîπ ¬øC√≥mo evitar problemas de bloqueo de puertos en el futuro?

1. Mant√©n actualizado el firmware del router.
2. Usa reglas claras de Port Forwarding en lugar de abrir todos los puertos.
3. Usa **VPN** para acceso remoto en vez de exponer servicios directos.
4. Documenta los puertos que abras.
5. Monitorea los logs de firewall y tr√°fico sospechoso.

### üéØ Conclusi√≥n

El bloqueo de puertos en routers no es un error, es una **medida de seguridad por defecto**.

Para saber si el tuyo bloquea puertos:

- Usa la **interfaz web** (f√°cil y directo).
- Haz pruebas con **esc√°neres de puertos** o comandos (`nmap`, `Test-NetConnection`).
- Si confirmas que el puerto est√° bloqueado, revisa reglas del router y pregunta a tu ISP.

‚ö†Ô∏è Solo abre puertos que realmente necesites y protege siempre los servicios expuestos con contrase√±as fuertes, TLS o VPN.

---

[üîº](#√≠ndice)

---

| **Inicio**         | **atr√°s 34**               | **Siguiente 36**              |
| ------------------ | -------------------------- | ----------------------------- |
| [üè†](../README.md) | [‚è™](./13_34_NAC_based.md) | [‚è©](./13_36_Group_Policy.md) |
