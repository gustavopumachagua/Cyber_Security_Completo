| **Inicio**         | **atr√°s 3**          | **Siguiente 5**     |
| ------------------ | -------------------- | ------------------- |
| [üè†](../README.md) | [‚è™](./13_3_ping.md) | [‚è©](./13_5_cat.md) |

---

## **√çndice**

| Temario                                                                                                          |
| ---------------------------------------------------------------------------------------------------------------- |
| [418. ¬øQu√© es el Protocolo de Resoluci√≥n de Direcciones?](#418-qu√©-es-el-protocolo-de-resoluci√≥n-de-direcciones) |
| [419. ARP explicado](#419-arp-explicado)                                                                         |

# **ARP**

## **418. ¬øQu√© es el Protocolo de Resoluci√≥n de Direcciones?**

![ARP](/img/13_Tools_for_Incident_Response_and_Discovery/ARP.webp "ARP")

### 1 ‚Äî ¬øQu√© es el Protocolo de Resoluci√≥n de Direcciones (ARP)? ‚Äî Definici√≥n

**ARP (Address Resolution Protocol)** es un protocolo de la capa de red/Enlace (principalmente en redes IPv4 sobre Ethernet) cuyo prop√≥sito es **mapear una direcci√≥n IP IPv4 a una direcci√≥n MAC (hardware)** en la misma red local (broadcast domain).

En otras palabras: dado `192.168.1.10` ARP responde: ‚Äúesa IP corresponde a la MAC `aa:bb:cc:dd:ee:ff`‚Äù.

### 2 ‚Äî ¬øQu√© hace ARP y c√≥mo funciona? (flujo b√°sico)

Paso a paso t√≠pico en una red Ethernet:

1. Host A quiere enviar un paquete IP a `192.168.1.20`.
2. Si no conoce la MAC de `192.168.1.20`, A env√≠a un **ARP Request** en broadcast:

   - ‚Äú¬øQui√©n tiene la IP 192.168.1.20? ‚Äî dime tu MAC.‚Äù

3. Todos los hosts de la subred reciben el broadcast. El host con esa IP responde **unicast** con **ARP Reply**:

   - ‚ÄúYo (192.168.1.20) tengo la MAC aa\:bb\:cc\:dd\:ee\:ff‚Äù.

4. Host A guarda la asociaci√≥n en su **cache ARP** (tabla ARP) por un tiempo (TTL local) y luego env√≠a el frame Ethernet a la MAC destino.

Puntos clave:

- ARP usa frames Ethernet y paquetes ARP (no usa TCP/UDP).
- ARP es **inseguro por dise√±o**: no existe autenticaci√≥n nativa.
- La cache ARP evita repetir requests constantemente.

### 3 ‚Äî Relaci√≥n de ARP con DHCP y DNS ‚Äî diferencias

- **ARP**: resuelve **IP ‚Üí MAC** dentro de la LAN (capa de enlace).
- **DHCP**: asigna din√°micamente **direcciones IP** (y gateway/DNS) a hosts. DHCP puede distribuir una IP que despu√©s se resuelve con ARP para obtener la MAC.
- **DNS**: resuelve **nombre ‚Üí IP** (ej.: `www.ej.com` ‚Üí `93.184.216.34`) y opera a nivel de capa de aplicaci√≥n.
  Diferencias r√°pidas:
- DNS = nombres a IP (global/entre redes).
- ARP = IP a MAC (solo dentro de la misma red f√≠sica).
- DHCP = asignaci√≥n/gesti√≥n de IPs (puede estar vinculado a MAC mediante reservas).

Interacci√≥n:

- Tras recibir IP por DHCP, un host puede enviar **gratuitous ARP** para anunciarla (evita conflictos y actualiza caches).
- DNS no afecta ARP directamente; pero si cambias un A record (DNS) y el cliente contacta la IP resultante dentro de la LAN, ARP se usa para encontrar la MAC.

### 4 ‚Äî 4 tipos clave / variantes de ARP (explicadas)

#### 1) Proxy ARP

- Un router o gateway responde **en nombre** de otra IP dentro de la LAN.
- Uso t√≠pico: hacer que dos subredes parezcan en la misma red sin reconfigurar hosts; o cuando un host o dispositivo no soporta rutas.
- Ejemplo: Host A hace ARP por `192.168.1.50`, pero router R responde: ‚Äúesa IP est√° en la otra red ‚Äî cont√°ctame a mi MAC‚Äù (R act√∫a como proxy).
- Riesgos: puede aumentar la superficie de ataque si mal configurado; dificulta diagn√≥stico.

#### 2) Gratuitous ARP (ARP gratuito / ARP anuncio)

- Un host env√≠a un **ARP Reply** sin que nadie lo haya preguntado ‚Äî en broadcast ‚Äî para anunciar: ‚ÄúYo tengo la IP X y mi MAC es Y‚Äù.
- Usos:

  - Actualizar caches ARP en la LAN (p. ej. despu√©s de failover de HA).
  - Detectar conflictos de IP (si otro responde con la misma IP, hay conflicto).
  - Informar a switches de nueva asociaci√≥n MAC‚Üípuerto.

- Comando com√∫n: `arping -S 192.168.1.10 -c 2` o `ip neigh replace ...` seg√∫n sistema.

#### 3) RARP ‚Äî Reverse ARP (hist√≥rico)

- **RARP (Reverse ARP)** ped√≠a a una m√°quina ‚Äú¬øCu√°l es mi IP?‚Äù dado que conoc√≠a su MAC (usado en m√°quinas sin disco para boot por red).
- Hoy est√° **obsoleto**; reemplazado por **BOOTP** y **DHCP**, que son mucho m√°s flexibles.

#### 4) InARP ‚Äî Inverse ARP (IARP)

- **InARP** permite a una interfaz solicitar informaci√≥n de capa 3 para una direcci√≥n de capa 2 ya conocida (t√≠pico en tecnolog√≠as como Frame Relay originalmente).
- Menos presente en Ethernet; su uso es espec√≠fico de ciertos enlaces virtuales/legacy.

### 5 ‚Äî ¬øPara qu√© es √∫til ARP en redes? (casos de uso)

- Permitir la comunicaci√≥n IPv4 dentro de la LAN (sin ARP no hay env√≠o de tramas Ethernet a direcciones IP locales).
- Diagn√≥stico de red: ver qu√© MAC tiene cada IP.
- Implementar alta disponibilidad y failover (gratuitous ARP para mover IP virtual entre hosts).
- Aprender mapeos MAC‚ÜîIP √∫tiles para inventario o seguridad (por ejemplo, detectar duplicados).

### 6 ‚Äî Resoluci√≥n de conflictos de direcciones IP (IP conflict) ‚Äî c√≥mo detectarlo y arreglarlo

**S√≠ntoma**: un host indica que otra m√°quina tiene su IP; ca√≠da intermitente; ARP responde con una MAC que no corresponde.

Detecci√≥n:

- Mensajes en OS: ‚ÄúAnother device is using your IP address‚Äù (Windows) o errores ARP en syslog.
- `arp -a` o `ip neigh show` para ver mapeos y detectarlos.
- `arping -c 5 192.168.1.50` para ver qu√© MAC responde a esa IP.
- Captura con `tcpdump -i eth0 arp` para ver requests/replies y ver cu√°l MAC responde.

Resoluci√≥n:

1. Identifica las MACs en conflicto: `arping -c 3 192.168.1.50` y `arp -a | grep 192.168.1.50`.
2. Localiza el puerto del switch con la MAC: en switches gestionados usa `show mac address-table | include aa:bb:cc:dd:ee:ff`.
3. Revisa si hay un host con IP fija duplicada o un servidor DHCP mal configurado (asignando la misma IP a distinta MAC).
4. Si fue asignada por DHCP, verifica leases en el servidor DHCP (`dhcpd.leases`, interfaz de gesti√≥n) y reserva/ajusta.
5. Para resolver temporalmente: saca la m√°quina duplicada de la red o cambia su IP; o renueva lease (`dhclient -r && dhclient`) si usa DHCP.
6. Si el conflicto es por **gratuitous ARP** (por failover), confirma que las m√°quinas de HA est√°n configuradas correctamente para anunciar IP.

Ejemplo de comandos:

```bash
# Ver tabla ARP local (Linux)
ip neigh show

# o
arp -n

# Probar respuesta ARP
sudo arping -c 4 192.168.1.50

# Capturar tr√°fico ARP en la interfaz
sudo tcpdump -n -i eth0 arp
```

### 7 ‚Äî Los peligros de la suplantaci√≥n de ARP (ARP spoofing / poisoning)

**Qu√© es**: un atacante env√≠a ARP replies falsos para asociar su MAC con la IP de otro equipo (por ejemplo, la gateway). Resultado: el tr√°fico de la v√≠ctima pasa por el atacante (MITM ‚Äî man-in-the-middle), permitiendo sniffing, manipulaci√≥n o interrupci√≥n.

Efectos comunes:

- Intercepci√≥n de tr√°fico (contrase√±as, sesiones no cifradas).
- Interrupci√≥n de servicio (DoS) si el atacante responde con MAC inv√°lida.
- Redirecci√≥n a hosts maliciosos (phishing interno).

C√≥mo detectarlo:

- Cambios constantes en la cache ARP: `ip neigh` mostrando que la MAC de la gateway cambia frecuentemente.
- Duplicados MAC para diferentes IPs.
- Herramientas: `arpwatch`, `arping`, `ettercap` (detecci√≥n), `snort` con reglas ARP spoofing.
- Monitoreo con `tcpdump -n -i eth0 arp` para ver replies no solicitados.

Mitigaciones:

- **Dynamic ARP Inspection (DAI)** en switches gestionados: valida ARP contra binding table (p. ej. DHCP snooping lease table) y descarta ARP falsos.
- **DHCP Snooping**: registra bindings IP‚ÜîMAC‚Üîpuerto; es prerrequisito para DAI.
- **Entradas ARP est√°ticas** en hosts importantes (gateway, servidores), s√≥lo si la red es peque√±a y administrable: `arp -s 192.168.1.1 aa:bb:cc:dd:ee:ff`. Nota: mantenimiento costoso en redes grandes.
- **Segmentaci√≥n de red** y uso de **switches gestionados** que puedan proteger puertos (port security: limitar MACs por puerto).
- **Uso obligatorio de cifrado** (HTTPS, SSH, TLS) para reducir impacto del sniffing.
- **Herramientas de detecci√≥n**: arpwatch, ArpON, XArp, sistemas IDS/IPS.

Importante: no explicar√© c√≥mo realizar ataques (eso es malicioso). Aqu√≠ la intenci√≥n es defender y detectar.

### 8 ‚Äî ¬øC√≥mo se utiliza ARP? (comandos pr√°cticos y ejemplos)

Comandos √∫tiles en Linux/macOS/Windows para ver, probar y manipular ARP:

#### Ver la tabla ARP

- Linux:

```bash
ip neigh show
# o
arp -n
```

- macOS:

```bash
arp -a
```

- Windows (PowerShell o cmd):

```powershell
arp -a
```

#### Probar/solicitar ARP (herramienta `arping`)

- Probar qui√©n responde por una IP:

```bash
sudo arping -c 3 192.168.1.50
```

Salida t√≠pica: responder√° con la MAC y tiempo.

- Enviar gratuitous ARP (anuncio):

```bash
sudo arping -S 192.168.1.50 -c 2 -I eth0
```

(`-S` para source IP en algunas versiones; otras usan `-U` o `-A` para gratuitous)

#### A√±adir / borrar entradas ARP est√°ticas (temporal en la tabla local)

- A√±adir (Linux):

```bash
sudo ip neigh add 192.168.1.1 lladdr aa:bb:cc:dd:ee:ff dev eth0 nud permanent
```

- Borrar:

```bash
sudo ip neigh del 192.168.1.1 dev eth0
```

- En Windows:

```powershell
arp -s 192.168.1.1 aa-bb-cc-dd-ee-ff
arp -d 192.168.1.1
```

#### Limpiar la cache ARP

- Linux:

```bash
sudo ip -s neigh flush all
```

o para una IP:

```bash
sudo ip neigh del 192.168.1.50 dev eth0
```

#### Capturar tr√°fico ARP

```bash
sudo tcpdump -n -i eth0 arp
```

Ver√°s requests y replies; ayuda a depurar conflictos y detectar spoofing.

#### Ver bindings DHCP (√∫til con DAI / DHCP snooping)

- Revisa el servidor DHCP (ej.: `dhcpd.leases` o interfaz de administraci√≥n) para ver qu√© IP fue entregada a qu√© MAC y puerto.

### 9 ‚Äî Buenas pr√°cticas para administrar ARP en una red corporativa

1. **Implementar DHCP snooping** en switches y servidores DHCP confiables.
2. Habilitar **Dynamic ARP Inspection (DAI)** en switches gestionados para bloquear ARP falsos.
3. Usar **port security** para limitar MACs por puerto en switches.
4. Para infra cr√≠tica: usar **entradas ARP est√°ticas** en servidores/gateways (con control y automaci√≥n).
5. **Monitoreo**: deployar `arpwatch` o soluciones SIEM que detecten cambios inusuales en ARP.
6. Forzar **cifrado** en servicios (HTTPS, SSH, VPN) para mitigar riesgo aunque el atacante capture tr√°fico.
7. **Segmentar** la red (VLANs) para reducir dominio broadcast y exposici√≥n.
8. Educar al equipo: advertir sobre BYOD y dispositivos desconocidos que puedan causar conflictos.

### 10 ‚Äî Caso pr√°ctico: detectando y solucionando un conflicto IP (pasos concretos)

1. Usuario A reporta ‚Äúmi PC me dice que otra m√°quina usa mi IP‚Äù.
2. En tu m√°quina admin:

```bash
# Ver ARP local
ip neigh show | grep 192.168.1.50

# Probar con arping
sudo arping -c 3 192.168.1.50
```

3. Si recibes respuestas de una MAC desconocida, captura tr√°fico:

```bash
sudo tcpdump -n -i eth0 arp and host 192.168.1.50 -vv
```

4. Localiza puerto en switch via MAC:

```text
# En switch (ejemplo Cisco)
show mac address-table | include aa:bb:cc:dd:ee:ff
```

5. Ac√©rcate al puerto f√≠sico y verifica host. Si es un dispositivo no autorizado, descon√©ctalo.
6. En DHCP: chequea si hay dos leases para la misma IP; corrige server config.
7. Si el problema fue por una VM o por clone de imagen, corrige su configuraci√≥n de red (cambiar IP o usar DHCP).

### 11 ‚Äî Resumen (para llevar)

- **ARP** es esencial para la comunicaci√≥n IPv4 en la LAN: convierte IP ‚Üí MAC.
- Funciona con ARP Request (broadcast) y ARP Reply (unicast).
- Est√° relacionado con DHCP (asignaci√≥n IP) y complementa a DNS (nombre‚ÜíIP), pero opera en capas distintas.
- **Variantes**: Proxy ARP, Gratuitous ARP, RARP (obsoleto) e InARP (espec√≠fico).
- **Riesgos**: ARP spoofing/poisoning ‚Üí MITM; mitigaci√≥n: DAI, DHCP snooping, port security, entradas est√°ticas y cifrado.
- **Herramientas**: `ip neigh`, `arp`, `arping`, `tcpdump`, `arpwatch`, comandos en switches para localizar MACs.

---

[üîº](#√≠ndice)

---

## **419. ARP explicado**

### 1) ¬øQu√© es ARP (definici√≥n breve)?

**ARP** es el protocolo que traduce una **direcci√≥n IPv4** a una **direcci√≥n MAC** (hardware) dentro de la misma red local (broadcast domain).

Sin ARP no podr√≠as enviar tramas Ethernet a una IP local porque necesitas la MAC destino para construir el header de enlace.

### 2) ¬øC√≥mo funciona ARP? ‚Äî flujo t√≠pico (paso a paso)

1. Host A quiere enviar un paquete IP a `192.168.1.20`.
2. Comprueba su **cache ARP** (tabla local) si ya tiene la MAC asociada.
3. Si no la tiene, A env√≠a un **ARP Request** en broadcast a `ff:ff:ff:ff:ff:ff`:

   > ‚ÄúWho has 192.168.1.20? Tell 192.168.1.10‚Äù

4. El host con IP `192.168.1.20` responde con **ARP Reply** (unicast) a A:

   > ‚Äú192.168.1.20 is-at aa\:bb\:cc\:dd\:ee\:ff‚Äù

5. A guarda la entrada en su **cache ARP** durante un tiempo (aging) y env√≠a la trama Ethernet a la MAC `aa:bb:cc:dd:ee:ff`.

Notas:

- ARP usa frames Ethernet y no TCP/UDP.
- ARP Request = broadcast; ARP Reply = unicast.
- ARP es _no autenticado_ por dise√±o (por eso existe el spoofing).

### 3) Formato b√°sico del paquete ARP (campos importantes)

Un paquete ARP contiene (entre otros) estos campos:

- **HTYPE**: Hardware type (1 = Ethernet)
- **PTYPE**: Protocol type (0x0800 = IPv4)
- **HLEN**: hardware address length (6 para MAC)
- **PLEN**: protocol address length (4 para IPv4)
- **OPER**: operaci√≥n (1=request, 2=reply)
- **SHA**: Sender hardware address (MAC del emisor)
- **SPA**: Sender protocol address (IP del emisor)
- **THA**: Target hardware address (MAC destino; en request = 00:00:00:00:00:00)
- **TPA**: Target protocol address (IP objetivo)

### 4) Ejemplo de captura (tcpdump / wireshark) ‚Äî ARP Request/Reply

Salida t√≠pica de `tcpdump -n -i eth0 arp`:

```
15:04:32.123456 ARP, Request who-has 192.168.1.20 tell 192.168.1.10, length 46
15:04:32.123487 ARP, Reply 192.168.1.20 is-at aa:bb:cc:dd:ee:ff, length 46
```

Interpretaci√≥n:

- La primera l√≠nea es el **ARP Request** en broadcast.
- La segunda l√≠nea es el **ARP Reply** unicast con la MAC real.

### 5) Ver y manipular la tabla ARP (comandos √∫tiles)

Linux:

```bash
# Ver tabla ARP
ip neigh show
# o
arp -n

# Ejemplo de salida
# 192.168.1.20 dev eth0 lladdr aa:bb:cc:dd:ee:ff REACHABLE

# Probar qui√©n responde a una IP (arping)
sudo arping -c 3 -I eth0 192.168.1.20

# A√±adir entrada ARP est√°tica temporal
sudo ip neigh add 192.168.1.1 lladdr aa:bb:cc:dd:ee:ff dev eth0 nud permanent

# Borrar una entrada
sudo ip neigh del 192.168.1.20 dev eth0

# Limpiar cache ARP
sudo ip -s neigh flush all
```

macOS:

```bash
arp -a
```

Windows (cmd / PowerShell):

```powershell
arp -a        # ver
arp -s 192.168.1.1 aa-bb-cc-dd-ee-ff   # agregar est√°tica
arp -d 192.168.1.1                     # borrar
```

### 6) ARP cache ‚Äî aging y entradas est√°ticas

- Las entradas aprendidas por ARP expiran tras un periodo (variable por sistema).
- Puedes crear entradas **est√°ticas** (√∫tiles para servidores cr√≠ticos) pero son dif√≠ciles de mantener en redes grandes.
- Limpiar la cache puede resolver problemas de mapeo obsoleto tras cambios de red.

### 7) Variantes y tipos de ARP

**Gratuitous ARP (ARP gratuito / ARP announcement)**

- Un host anuncia su propia IP con un ARP Reply broadcast (sin que se lo pidan).
- Usos: detectar conflictos de IP, actualizar tablas de switches, anunciar IP virtual tras failover (Keepalived/VRRP).
- Ejemplo con `arping`:

```bash
sudo arping -c 2 -A -I eth0 192.168.1.100   # -A o -U seg√∫n versi√≥n: anuncio gratuito
```

**Proxy ARP**

- Un router responde a ARP Requests por una IP que _no_ est√° en la misma subred, actuando "en nombre" del host remoto.
- En Linux se puede habilitar con sysctl (ejemplo):

```bash
sudo sysctl -w net.ipv4.conf.eth0.proxy_arp=1
```

- √ötil para compatibilidad o placas/migraciones, pero puede complicar la red.

**RARP (Reverse ARP)** ‚Äî _hist√≥rico_

- Permit√≠a a una m√°quina sin IP preguntar ‚Äú¬øCu√°l es mi IP?‚Äù conociendo s√≥lo su MAC. Reemplazado por BOOTP/DHCP.

**InARP (Inverse ARP / IARP)**

- Usado en enlaces como Frame Relay para descubrir la direcci√≥n IP de la contraparte ya conocida su MAC/VC. Hoy poco usado en Ethernet.

### 8) Conflictos de IP ‚Äî c√≥mo detectarlos y resolverlos (caso pr√°ctico)

S√≠ntomas: mensajes del OS ‚ÄúAnother device is using your IP‚Äù, conexiones intermitentes.

Pasos para diagnosticar:

1. Ver la tabla ARP local:

```bash
ip neigh show | grep 192.168.1.50
```

2. Probar qui√©n responde:

```bash
sudo arping -c 4 192.168.1.50
# devuelve MAC de quien responde
```

3. Capturar tr√°fico ARP:

```bash
sudo tcpdump -n -i eth0 arp and host 192.168.1.50 -vv
```

4. En el switch gestionado, buscar el puerto donde aparece la MAC:

```
# ejemplo Cisco
show mac address-table | include aabb.ccdd.eeff
```

5. Soluci√≥n: desconectar el dispositivo duplicado, corregir la configuraci√≥n (DHCP reservation, IP est√°tica incorrecta), renovar lease (`dhclient -r && dhclient`), o modificar DHCP server config.

### 9) ARP spoofing / poisoning ‚Äî riesgos y detecci√≥n (explicaci√≥n responsable)

**Qu√© es (concepto):** un actor malicioso env√≠a ARP replies falsos para asociar su MAC con la IP de otro host (por ejemplo la gateway). Resultado: tr√°fico de la v√≠ctima pasa por el atacante (MITM).

**Qu√© provoca:** sniffing de tr√°fico, manipulaci√≥n, DoS, redirecci√≥n.

**C√≥mo detectarlo (no voy a dar pasos para atacarlo):**

- Observas cambios frecuentes en la MAC de la gateway en tu cache ARP: `ip neigh show`.
- M√∫ltiples IPs mapeadas a la misma MAC o la misma IP con diferentes MACs.
- Herramientas de detecci√≥n: `arpwatch`, `XArp`, IDS/IPS con reglas para ARP anomalies.
- Capturas con `tcpdump` mostrando ARP replies no solicitados (gratuitos) o respuestas contradicctorias.

**Mitigaci√≥n y protecci√≥n:**

- **Dynamic ARP Inspection (DAI)** en switches gestionados (requiere DHCP snooping bindings). Bloquea ARP no v√°lidos.
- **DHCP Snooping**: construir tabla de bindings IP‚ÜîMAC‚Üîpuerto para validar ARP.
- **Port security**: limitar n√∫mero de MACs por puerto.
- **Entradas ARP est√°ticas** en hosts cr√≠ticos (solo para infra peque√±a).
- **Cifrar todo**: HTTPS, SSH, VPNs reducen impacto incluso si hay sniffing.
- **Monitoreo**: alertas cuando cambian los bindings ARP cr√≠ticos.

> Nota √©tica: **no** proporcionar√© instrucciones paso a paso para realizar ARP spoofing o ataques; la informaci√≥n anterior es para **defensa** y detecci√≥n.

### 10) ARP vs IPv6 ‚Äî ¬øqu√© cambia?

IPv6 **no usa ARP**; utiliza **Neighbor Discovery Protocol (NDP)** sobre ICMPv6 para funciones equivalentes (neighbor solicitation / neighbor advertisement). NDP tambi√©n tiene mecanismos de seguridad como SEND (SEcure Neighbor Discovery), aunque en la pr√°ctica muchas redes usan otras protecciones.

### 11) Buenas pr√°cticas operativas relacionadas con ARP

- Habilitar DHCP snooping y DAI en switches gestores en entornos empresariales.
- Minimizar broadcast domain (VLANs) para reducir superficie ARP.
- Registrar y monitorizar cambios de bindings ARP con arpwatches o SIEM.
- Usar entradas ARP est√°ticas √∫nicamente cuando vale la pena (infra cr√≠tica).
- Forzar uso de cifrado y autenticaci√≥n en servicios sensibles.
- Documentar reservas DHCP para evitar duplicaciones.

### 12) Resumen r√°pido y comandos de referencia

Comandos claves:

```bash
# Ver tabla ARP
ip neigh show
arp -n
arp -a    # macOS / Windows

# Probar respuesta ARP
sudo arping -c 3 -I eth0 192.168.1.20

# Anuncio gratuito (gratuitous ARP)
sudo arping -c 2 -A -I eth0 192.168.1.100

# Captura de ARP
sudo tcpdump -n -i eth0 arp

# Limpiar cache ARP
sudo ip -s neigh flush all
```

Conceptos clave:

- ARP = IP ‚Üí MAC en LAN.
- Request = broadcast; Reply = unicast.
- Gratuitous ARP anuncia una IP; Proxy ARP responde en nombre de otra IP.
- IPv6 usa NDP en vez de ARP.
- Riesgo principal: ARP spoofing ‚Üí detectar con monitores y mitigar con DAI/DHCP snooping.

---

[üîº](#√≠ndice)

---

| **Inicio**         | **atr√°s 3**          | **Siguiente 5**     |
| ------------------ | -------------------- | ------------------- |
| [üè†](../README.md) | [‚è™](./13_3_ping.md) | [‚è©](./13_5_cat.md) |
