| **Inicio**         | **atr√°s 9**          | **Siguiente 11**        |
| ------------------ | -------------------- | ----------------------- |
| [üè†](../README.md) | [‚è™](./14_9_IaaS.md) | [‚è©](./14_11_Public.md) |

---

## **√çndice**

| Temario                                                        |
| -------------------------------------------------------------- |
| [532. ¬øQu√© es una nube privada?](#532-qu√©-es-una-nube-privada) |
| [533. Reglas de nube privada](#533-reglas-de-nube-privada)     |

# **Private**

## **532. ¬øQu√© es una nube privada?**

![Private](/img/14_Cloud_Skills_and_Knowledge/Private.png "Private")

Una **nube privada** es un modelo de computaci√≥n en la nube en el que toda la infraestructura (servidores, almacenamiento, red y software de virtualizaci√≥n) est√° **dedicada exclusivamente a una sola organizaci√≥n**.

- Puede estar **alojada internamente** en un centro de datos propio (on-premise) o
- **gestionada por un proveedor externo**, pero siempre con acceso exclusivo para una sola empresa.

üëâ Ejemplo:

Un banco que no puede compartir infraestructura por motivos regulatorios crea su propia nube privada con VMware + Kubernetes, solo accesible para sus empleados y aplicaciones internas.

### ‚öñÔ∏è Diferencia entre nube privada, p√∫blica e h√≠brida

| Caracter√≠stica    | Nube Privada                                              | Nube P√∫blica                                        | Nube H√≠brida                                                      |
| ----------------- | --------------------------------------------------------- | --------------------------------------------------- | ----------------------------------------------------------------- |
| **Propiedad**     | Exclusiva para una organizaci√≥n                           | Compartida por varios clientes (multi-tenant)       | Combinaci√≥n de ambas                                              |
| **Control**       | M√°ximo (empresa define seguridad, red, datos)             | Limitado (el proveedor gestiona la infraestructura) | Mixto                                                             |
| **Escalabilidad** | Limitada al hardware disponible (o al proveedor dedicado) | Muy alta, escalado casi infinito                    | Flexible: el√°stico en la nube p√∫blica + control en la privada     |
| **Coste**         | Alto (infraestructura propia o servicio dedicado)         | Bajo inicial, pago por uso                          | Variable, depende del equilibrio                                  |
| **Ejemplos**      | Nube privada con OpenStack en un datacenter propio        | AWS EC2, Google Cloud, Azure                        | Empresa que mantiene SAP en nube privada y usa AWS para anal√≠tica |

### üï∞Ô∏è Origen del t√©rmino ‚Äúnube privada‚Äù

El t√©rmino **‚Äúprivate cloud‚Äù** empez√≥ a usarse a mediados de los 2000.

- Surgi√≥ como respuesta al auge de la nube p√∫blica (Amazon AWS 2006).
- Muchas empresas, especialmente reguladas (banca, salud, gobierno), **tem√≠an perder control y seguridad** en la nube p√∫blica.
- Se acu√±√≥ ‚Äúnube privada‚Äù para referirse a **infraestructura cloud-like (autoservicio, virtualizaci√≥n, escalabilidad)** pero dedicada a un solo cliente.

üëâ B√°sicamente: _‚ÄúQueremos los beneficios de la nube, pero con seguridad y control total en casa‚Äù_.

### üåü Beneficios de una nube privada

1. **Seguridad y cumplimiento** ‚Üí Control total sobre datos, ideal para regulaciones (HIPAA, GDPR, PCI DSS).

   - _Ejemplo_: un hospital mantiene historiales m√©dicos en nube privada con acceso restringido.

2. **Personalizaci√≥n** ‚Üí Hardware, redes y software adaptados a las necesidades del negocio.
3. **Predecibilidad de costos** ‚Üí Gastos fijos (CAPEX si es propia, OPEX si es gestionada).
4. **Alto rendimiento** ‚Üí Recursos dedicados, sin compartir con otros clientes.
5. **Integraci√≥n con sistemas legacy** ‚Üí Ideal para aplicaciones antiguas que no migran bien a la nube p√∫blica.
6. **Mayor control operativo** ‚Üí Se pueden definir pol√≠ticas de seguridad, backup y disponibilidad a medida.

### ‚öôÔ∏è ¬øC√≥mo funciona una nube privada?

Una nube privada se construye sobre **tecnolog√≠as de virtualizaci√≥n** y/o **contenedores** que permiten:

- **Hipervisores** (VMware vSphere, KVM, Hyper-V) ‚Üí crean m√°quinas virtuales aisladas.
- **Orquestadores** (OpenStack, Kubernetes) ‚Üí gestionan recursos de c√≥mputo, red y almacenamiento.
- **Automatizaci√≥n** ‚Üí los usuarios pueden aprovisionar recursos de forma similar a la nube p√∫blica (autoservicio).

üëâ Ejemplo de flujo:

1. Un desarrollador solicita una VM v√≠a un portal interno.
2. El sistema de nube privada (ej. OpenStack) asigna CPU, RAM y almacenamiento de los servidores f√≠sicos.
3. El recurso se provisiona en minutos, como en AWS, pero dentro del datacenter privado.

### üèóÔ∏è Tipos de soluciones de nube privada

1. **On-premise (local)**

   - Infraestructura en el datacenter propio de la empresa.
   - Ejemplo: OpenStack desplegado en servidores Dell/HP de una empresa.

2. **Nube privada gestionada**

   - Un proveedor externo la aloja y gestiona, pero los recursos siguen siendo dedicados.
   - Ejemplo: Rackspace ofrece nubes privadas basadas en VMware.

3. **Nube privada virtual (VPC)**

   - Infraestructura dentro de una nube p√∫blica, pero con red y recursos aislados.
   - Ejemplo: Amazon VPC en AWS ‚Üí red privada virtual dentro de la nube p√∫blica.

### ‚òÅÔ∏è AWS y la nube privada

Aunque AWS es sin√≥nimo de nube **p√∫blica**, ofrece servicios para construir entornos de **nube privada o h√≠brida**:

1. **Amazon VPC (Virtual Private Cloud):**

   - Crea una red virtual aislada dentro de AWS.
   - Puedes definir subredes privadas/p√∫blicas, reglas de firewall y VPN hacia tu empresa.

2. **AWS Outposts:**

   - Lleva infraestructura de AWS a tu datacenter on-premise.
   - Ejemplo: servidores f√≠sicos en tu empresa, gestionados por AWS, con la misma API que en la nube p√∫blica.

3. **AWS Snowball Edge / Snowmobile:**

   - Dispositivos f√≠sicos para c√≥mputo y almacenamiento en local, con opci√≥n de sincronizaci√≥n con la nube.

4. **AWS Direct Connect:**

   - Conexi√≥n dedicada entre tu datacenter y AWS, √∫til para h√≠bridos.

üëâ Caso pr√°ctico:

Una aerol√≠nea usa **AWS Outposts** en sus aeropuertos para procesar datos localmente (baja latencia), pero replica todo en AWS para an√°lisis global.

### üìå Conclusi√≥n

- Una **nube privada** te da **control, seguridad y cumplimiento**, sacrificando algo de elasticidad y costo.
- La **p√∫blica** es la m√°s flexible y barata, pero con menos control directo.
- La **h√≠brida** mezcla lo mejor de ambas, y es tendencia hoy en d√≠a.
- AWS, aunque p√∫blica, ofrece **VPCs, Outposts y Direct Connect** para acercarse al concepto de nube privada.

---

[üîº](#√≠ndice)

---

## **533. Reglas de nube privada**

### 1. Principios gu√≠a (qu√© deber√≠an perseguir las reglas)

- **Seguridad por dise√±o** (secure-by-default).
- **Menor privilegio** (least privilege).
- **Automatizaci√≥n y ‚Äúpolicy-as-code‚Äù** (las reglas se ejecutan en CI/CD).
- **Auditable y reproducible** (logs, versionado, trazabilidad).
- **Separaci√≥n de responsabilidades** (RACI clara).
- **Resiliencia y recuperaci√≥n** (backup + DR verificados).
- **Cumplimiento legal y residencia de datos**.

### 2. Reglas de gobernanza y organizaci√≥n

**Regla G1 ‚Äî Propiedad y responsabilidades**

- Cada recurso (red, proyecto, tenant) debe tener un _owner_ documentado y un SLA.
- **Ejemplo**: `Owner: equipo-plataforma, Contacto: infra-team@empresa.com, SLA: 99.9%`

**Regla G2 ‚Äî Pol√≠tica de cambios**

- Todo cambio en infra debe pasar por PR en Git y `plan`/`review` automatizado antes de `apply`.
- Mantener **changelogs** y ventanas de mantenimiento programadas.

**Regla G3 ‚Äî Clasificaci√≥n de datos**

- Definir niveles: Public / Internal / Confidential / Restricted. Aplicar controles m√≠nimos por nivel (cifrado, lugares de almacenamiento, access control).

### 3. Reglas de identidad y acceso (IAM / RBAC)

**Regla I1 ‚Äî Principio de menor privilegio**

- Ning√∫n usuario o servicio tiene permisos por defecto. Los roles se otorgan por necesidad y tiempo limitado.

**Regla I2 ‚Äî Autenticaci√≥n fuerte**

- MFA obligatorio para administradores; SSO con IdP corporativo para todos los usuarios.

**Regla I3 ‚Äî Roles y separaci√≥n de funciones**

- Definir roles: `platform-admin`, `network-admin`, `security-analyst`, `dev-team`.
- **Ejemplo RACI simple**:

  - Provisioning: R=dev-team, A=platform-admin, C=security, I=finance

**Ejemplo de pol√≠tica de acceso (JSON gen√©rico)**

```json
{
  "Statement": [
    {
      "Effect": "Allow",
      "Action": ["compute:CreateInstance", "compute:DescribeInstance"],
      "Resource": ["project:dev-*"],
      "Condition": { "TimeOfDay": "08:00-18:00" }
    }
  ]
}
```

_(Adaptar al sistema IAM que uses.)_

### 4. Reglas de red y segmentaci√≥n

**Regla N1 ‚Äî Zonas de confianza / microsegmentaci√≥n**

- Separar redes: Management, Workload-Private, Workload-Public, Database, Backup.
- Comunicaci√≥n entre zonas mediante firewalls/ACLs con listas expl√≠citas (deny-by-default).

**Regla N2 ‚Äî Prohibir rutas directas sin inspecci√≥n**

- Todo tr√°fico Norte-Sur y Este-Oeste inspeccionado por controles de seguridad (IDS/IPS / NGFW).

**Ejemplo: Security Group m√≠nimo (pseudo)**

- ALB: permitir 80/443 desde Internet.
- App tier: only allow 443 from ALB SG.
- DB tier: allow 5432 only from App SG.

**Ejemplo Kubernetes NetworkPolicy**

```yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-app-to-db
spec:
  podSelector:
    matchLabels:
      role: db
  policyTypes:
    - Ingress
  ingress:
    - from:
        - podSelector:
            matchLabels:
              role: app
      ports:
        - protocol: TCP
          port: 5432
```

### 5. Reglas de protecci√≥n de datos y cifrado

**Regla D1 ‚Äî Cifrado obligatorio**

- Datos _at-rest_ cifrados con claves gestionadas y rotaci√≥n peri√≥dica (KMS/HSM).
- TLS 1.2+/HTTPS obligatorio _in-transit_.

**Regla D2 ‚Äî Key management**

- Claves de producci√≥n en HSM o KMS; acceso restringido a roles espec√≠ficos y registrado.

**Regla D3 ‚Äî Exportaci√≥n de datos y residencia**

- Definir reglas de d√≥nde se pueden almacenar datos seg√∫n clasificaci√≥n y legislaci√≥n (ej.: datos EU ‚Üí permanecer en regi√≥n EU).

**Ejemplo de pol√≠tica de cifrado (declarativa)**

- `AllStorage.Encrypted == true`
- `Database.EncryptionKey.Region == Database.Region`

### 6. Reglas de provisi√≥n / lifecycle de workloads

**Regla W1 ‚Äî Cat√°logo de servicios**

- Solo desplegar recursos desde un cat√°logo aprobado (images/m√°quinas, templates IaC).

**Regla W2 ‚Äî Im√°genes duras (hardened images)**

- Las AMI/VM images oficiales deben pasar linters y escaneo de vulnerabilidades antes de ser aprobadas.

**Regla W3 ‚Äî Quotas y l√≠mites**

- Implementar cuotas por proyecto/tenant (CPU, RAM, storage) para evitar noisy neighbors.

**Ejemplo de workflow (onboarding de tenant)**

1. Crear proyecto en infra con owner.
2. Aplicar policy guardrails (RBAC, quotas, network segmentation).
3. Provisionar VMs/Pods desde template aprobado.
4. Registrar en CMDB y activar monitorizaci√≥n autom√°tica.

### 7. Reglas de parcheo y hardening

**Regla P1 ‚Äî Patching programado**

- Parches cr√≠ticos: aplicar en ‚â§48h; parches regulares en ventana mensual.

**Regla P2 ‚Äî Im√°genes inmutables**

- Preferir imagenes inmutables; para cambios rebuild + redeploy en vez de patch manual.

**Regla P3 ‚Äî Escaneo automatizado**

- Escanear continuamente im√°genes y VMs (SCA/SAST/DAST) y remediar hallazgos con prioridad.

### 8. Reglas de backup, continuidad y DR

**Regla B1 ‚Äî Backups m√≠nimos**

- RPO/RTO definidos por clase de datos; por ejemplo:

  - Critical: RPO 1h, RTO 1h
  - Important: RPO 24h, RTO 8h

**Regla B2 ‚Äî Retenci√≥n y pruebas**

- Backups peri√≥dicos + pruebas de restore semestrales (tabletop + ejercicio real) documentadas.

**Ejemplo de pol√≠tica de backup (tabla)**

| Nivel        | RPO | RTO | Retenci√≥n |
| ------------ | --: | --: | --------: |
| Critical     |  1h |  1h |   90 d√≠as |
| Important    | 24h |  8h |   30 d√≠as |
| Non-critical |  7d | 72h |   14 d√≠as |

### 9. Reglas de monitorizaci√≥n, logging y auditor√≠a

**Regla M1 ‚Äî Logs centralizados e inmutables**

- Todos los eventos de plataforma (auth, network, infra, kernel, audit) se env√≠an a un SIEM/log store con retenci√≥n y tamper-evidence.

**Regla M2 ‚Äî Nivel m√≠nimo de telemetr√≠a**

- Metrics: CPU, Mem, I/O, latencia p95/p99, error rate, saturaci√≥n de red.
- Alertas con playbooks enlazados (runbooks).

**Regla M3 ‚Äî Retenci√≥n y acceso a logs**

- Logs de seguridad: retenci√≥n m√≠nima 1 a√±o; acceso a logs: solo security-analyst y auditor.

### 10. Reglas de respuesta a incidentes y forense

**Regla IR1 ‚Äî Playbooks y legal hold**

- Tener playbooks por tipo (ransomware, data exfil, insider); emitir _legal hold_ inmediatamente si hay presunci√≥n de incidente.

**Regla IR2 ‚Äî Preservaci√≥n de evidencia**

- Capturar snapshots de vol√∫menes, exportar logs y preservar chain-of-custody al activar IR.

**Regla IR3 ‚Äî Comunicaci√≥n y notificaciones**

- Escalado claro: cu√°ndo notificar a Board, reguladores, clientes; tiempos m√°ximos (ej.: notificar regulador en 72h si PII afectado).

### 11. Reglas de cumplimiento y auditor√≠a

**Regla C1 ‚Äî Mapear controles a normativas**

- Mapear ISO27001 / GDPR / PCI / HIPAA a controles t√©cnicos (en matrix).

**Regla C2 ‚Äî Auditor√≠as peri√≥dicas**

- Auditor√≠a interna trimestral, auditor√≠a externa anual (SOC2/ISO27001/Pentest).

### 12. Reglas de automatizaci√≥n y ‚Äúpolicy-as-code‚Äù

**Regla A1 ‚Äî Policies automatizadas**

- Implementar guardrails con herramientas: OPA/Conftest (policies en CI), admission controllers (K8s), o herramientas cloud-nativas (guardrails).

\*_Ejemplo Rego_ (pseudo) ‚Äî No public buckets\*\*

```rego
package policies.s3

deny[msg] {
  input.resource.type == "s3_bucket"
  input.resource.public == true
  msg = sprintf("Bucket %s es publico", [input.resource.name])
}
```

_(Integrar en pipeline: bloquea `apply` si la policy falla.)_

### 13. Reglas de facturaci√≥n y FinOps

**Regla F1 ‚Äî Tagging obligatorio**

- Todos los recursos deben tener tags: `owner`, `project`, `environment`, `cost_center`.

**Regla F2 ‚Äî Alertas y budgets**

- Budget alerts autom√°ticos por proyecto; chargeback trimestral.

**Regla F3 ‚Äî Lifecyle/cleanup**

- Entornos temporales (dev/test) con TTL autom√°tico (ej.: destroy 7 d√≠as despu√©s).

### 14. Reglas para multi-tenant y aislamiento entre clientes

**Regla T1 ‚Äî Aislamiento l√≥gico o f√≠sico seg√∫n sensibilidad**

- Para datos sensibles o clientes regulados, exigir aislamiento f√≠sico (single-tenant) o DB separada y strong RBAC.

**Regla T2 ‚Äî No compartir credenciales ni keys**

- Cada tenant tiene su propio key material (KMS) y roles auditables.

### 15. Checklist m√≠nimo obligatorio (resumen r√°pido)

1. [ ] Owner documentado y SLA.
2. [ ] IAM: MFA, least-privilege, roles.
3. [ ] Network: deny-by-default, microsegmentaci√≥n en zonas.
4. [ ] Cifrado en tr√°nsito y reposo + KMS.
5. [ ] Catalogo de images aprobadas + scanning.
6. [ ] Backups autom√°ticos y pruebas de restore.
7. [ ] Logs centralizados y retenci√≥n m√≠nima para seguridad.
8. [ ] Policies-as-code en CI (bloqueo de cambios inseguros).
9. [ ] Tagging obligatorio y budgets.
10. [ ] Playbooks IR y legal hold listos.

### 16. Ejemplo pr√°ctico: pol√≠tica corta para el manual de operaciones

**T√≠tulo:** Pol√≠tica de seguridad ‚Äî Nube Privada (extracto)
**Alcance:** Todos los recursos en la nube privada gestionada por plataforma TI.
**Pol√≠tica:**

- Todo recurso nuevo debe crearse mediante IaC desde repositorio autorizado.
- Los buckets/vol√∫menes deben cifrarse por defecto.
- Acceso administrativo se concede solo mediante roles temporales con MFA y registro de sesi√≥n.
- Backups cr√≠ticos se realizan cada 1h y se mantienen 90 d√≠as.
- Fallas de seguridad cr√≠tica: notificar al CISO en 1 hora y activar IR playbook.

### 17. C√≥mo implementar y hacer cumplir las reglas (sugerencia de roadmap t√©cnico)

1. **Escribir las reglas en lenguaje humano (pol√≠tica).**
2. **Traducir a policy-as-code** (OPA, Conftest, AWS Config Rules, Azure Policy).
3. **Integrar en CI/CD** (PR -> plan -> policy checks).
4. **Provisionar guardrails en la plataforma** (network defaults, quotas).
5. **Automatizar detecci√≥n** (SIEM, Config rules, periodic scans).
6. **Auditor√≠a y m√©tricas** (porcentaje de recursos compliant).
7. **Capacitaci√≥n y onboarding** (formar equipos en reglas y runbooks).

---

[üîº](#√≠ndice)

---

| **Inicio**         | **atr√°s 9**          | **Siguiente 11**        |
| ------------------ | -------------------- | ----------------------- |
| [üè†](../README.md) | [‚è™](./14_9_IaaS.md) | [‚è©](./14_11_Public.md) |
