| **Inicio**         | **atr√°s 8**                                   | **Siguiente 10**                            |
| ------------------ | --------------------------------------------- | ------------------------------------------- |
| [üè†](../README.md) | [‚è™](./8_8_Web_Based_Attacks_and_OWASP_10.md) | [‚è©](./8_10_Core_Concepts_of_Zero_Trust.md) |

---

## **√çndice**

| Temario                                                                                                |
| ------------------------------------------------------------------------------------------------------ |
| [213. Aprenda c√≥mo funciona el malware y sus tipos](#213-aprenda-c√≥mo-funciona-el-malware-y-sus-tipos) |

# **Learn how Malware Operates and Types**

## **213. Aprenda c√≥mo funciona el malware y sus tipos**

![Aprenda c√≥mo funciona el malware y sus tipos](/img/8_Security_Skills_and_Knowledge/Aprenda_como_funciona_el_malware_y_sus_tipos.webp "Aprenda c√≥mo funciona el malware y sus tipos")

### üî∑ ¬øQu√© es el malware?

**Malware** (software malicioso) es cualquier programa, c√≥digo o conjunto de instrucciones dise√±ado para **da√±ar, explotar, espiar o tomar control** de sistemas, redes o dispositivos sin el consentimiento del propietario. Sus metas habituales incluyen robo de datos, sabotaje, obtenci√≥n de dinero (ransomware), control remoto (botnets) o miner√≠a clandestina.

### üîÅ Ciclo de vida / c√≥mo funciona (visi√≥n general)

1. **Reconocimiento / targeting**: el atacante selecciona v√≠ctimas (empresas, usuarios, dispositivos).
2. **Entrega / vector**: el malware llega al objetivo (phishing, descarga, USB, cadena de suministro).
3. **Ejecuci√≥n**: el malware se ejecuta en el host (archivo, macro, script, explotaci√≥n).
4. **Persistencia**: establece m√©todos para sobrevivir reinicios (configuraci√≥n, servicios, tareas).
5. **Escalada y movimiento lateral**: trata de elevar privilegios y desplazarse por la red.
6. **Comando & Control (C2)**: comunica con el atacante para recibir √≥rdenes o exfiltrar datos.
7. **Acci√≥n sobre el objetivo**: cifrar archivos (ransomware), robar credenciales, reclutar para botnet, etc.
8. **Limpieza / ocultaci√≥n**: borra trazas o altera timestamps para evadir forense.

### üö© Vectores de infecci√≥n comunes

- **Phishing / spear-phishing** (adjuntos, links maliciosos).
- **Descargas drive-by** desde sitios comprometidos.
- **Exploits de servicios expuestos** (web, RDP, SMB).
- **Dispositivos extra√≠bles (USB)** con archivos maliciosos.
- **Cadena de suministro** (dependencias/actualizaciones comprometidas).
- **Aplicaciones m√≥viles maliciosas** (Android/iOS sideloading o apps maliciosas en stores).
- **Malware en IoT** (firmware vulnerable, credenciales por defecto).

### üß≠ Tipos principales de malware (con definici√≥n y ejemplos reales)

Voy a agruparlos por comportamiento para que sea f√°cil entenderlos y defenderlos.

#### 1. Virus

**Descripci√≥n:** c√≥digo que se adjunta a archivos leg√≠timos y se propaga cuando el archivo se ejecuta.

**Ejemplo hist√≥rico:** _ILOVEYOU_ (2000) ‚Äî se propag√≥ por correo y sobrescrib√≠a archivos.

#### 2. Gusanos (Worms)

**Descripci√≥n:** malware que se autorreplica y se propaga por redes sin intervenci√≥n humana.

**Ejemplos:** _WannaCry_ (2017) ‚Äî ransomware que us√≥ una vulnerabilidad SMB para propagarse; _Conficker_ (2008).

#### 3. Troyanos (Trojans)

**Descripci√≥n:** malware que se disfraza de software leg√≠timo o aparece como adjunto/instalador para enga√±ar al usuario.

**Ejemplo:** _Zeus_ / _Dridex_ (familias de troyanos bancarios que roban credenciales).

#### 4. Ransomware

**Descripci√≥n:** cifra archivos o sistemas y exige rescate por la clave de descifrado.

**Ejemplos:** _WannaCry_, _Ryuk_, _Conti_, _NotPetya_ (NotPetya actu√≥ m√°s como wiper).

**Impacto:** detiene operaciones, provoca p√©rdidas financieras y reputacionales.

#### 5. Spyware / Keyloggers

**Descripci√≥n:** roba informaci√≥n (credenciales, actividad de usuario, pantalla, teclas).

**Ejemplo:** _Pegasus_ (software de espionaje para m√≥viles); keyloggers comerciales/maliciosos en PCs.

#### 6. Rootkits / Bootkits

**Descripci√≥n:** ocultan procesos, ficheros o m√≥dulos al sistema para permanecer indetectables; los bootkits atacan el arranque.

**Consecuencia:** detecci√≥n y eliminaci√≥n muy complejas.

##### 7. Botnets

**Descripci√≥n:** redes de dispositivos comprometidos controlados por un C2, usadas para DDoS, spam o miner√≠a.

**Ejemplo:** _Mirai_ (2016) ‚Äî infect√≥ routers/c√°maras IoT usando credenciales por defecto.

#### 8. Cryptominers (miner√≠a no autorizada)

**Descripci√≥n:** usa recursos del equipo para minar criptomonedas, degradando rendimiento y energ√≠a.

**Ejemplo:** campa√±as que usan servidores empresariales para minar Monero.

#### 9. Fileless malware

**Descripci√≥n:** no escribe ficheros en disco, usa memoria, scripts o herramientas ‚Äúleg√≠timas‚Äù (PowerShell, WMI) ‚Äî dif√≠cil de detectar por firmas tradicionales.

**Ejemplos:** campa√±as que abusan de PowerShell ofuscado o Living-Off-The-Land Binaries (LOLBins).

#### 10. Dropper / Loader / Backdoor / RAT

- **Dropper/Loader:** instala otras cargas maliciosas. _Emotet_ actu√≥ tradicionalmente como loader/droper.
- **Backdoor / RAT (Remote Access Trojan):** permite control remoto y exfiltraci√≥n (p. ej. _Gh0st RAT_).

#### 11. Logic bombs / Wipers

**Descripci√≥n:** se activan en un evento (fecha/hora) o destruyen datos (wipers como NotPetya).

**Impacto:** sabotaje deliberado.

#### 12. Malware m√≥vil y IoT

- Malware para Android (troyanos bancarios, adware), iOS (explotaci√≥n avanzada).
- IoT malware (Mirai) afecta disponibilidad y privacidad.

### üî¨ Ejemplos concretos y lecciones

- **WannaCry (2017):** aprovech√≥ una falla (EternalBlue) para propagarse. Lecci√≥n: parcheo y segmentaci√≥n reducen impacto.
- **NotPetya (2017):** se disfraz√≥ de ransomware pero actu√≥ como wiper; mostr√≥ riesgo de ataques destructivos a la cadena de suministro.
- **Emotet:** empez√≥ como troyano bancario, luego evolucion√≥ a plataforma de distribuci√≥n (droppers) para otras amenazas. Lecci√≥n: herramientas modulares son muy peligrosas.
- **Mirai:** dispositivos IoT insegros usados para ataques DDoS masivos. Lecci√≥n: cambiar credenciales por defecto y aplicar hardening en IoT.

### üïµÔ∏è Se√±ales e Indicadores de Compromiso (IoCs) ‚Äî qu√© buscar

_(no dar√© hashes/IP concretos ‚Äî estos deben obtenerse de feeds y TIPs actualizados)_

- Actividad de procesos inusual: procesos hijos de MS Office o del navegador que lanzan PowerShell o cmd.
- Ejecuciones de scripts ofuscados (PowerShell con `-EncodedCommand`).
- Tr√°fico saliente a dominios/IPs inusuales o a pa√≠ses no relacionados.
- Escaneo interno o conexiones laterales entre hosts donde no suele haber tr√°fico.
- Creaci√≥n de cuentas locales/servicios desconocidos o cambios en tareas programadas.
- Alto uso de CPU/GPU inesperado (posible cryptominer).
- Archivos cifrados con extensiones nuevas o mensajes de rescate.

### üîé C√≥mo detectar malware (t√©cnicas defensivas)

- **Firma** (AV) + **heur√≠stica**: detecciones basadas en patrones conocidos.
- **Detecci√≥n basada en comportamiento (EDR/XDR):** monitorizaci√≥n de procesos, parent/child, anomal√≠as.
- **Network IDS/IPS y an√°lisis de tr√°fico**: detectar C2, beacons o exfiltraci√≥n.
- **Threat Intelligence feeds**: IOCs actualizados para bloquear dominios/hashes.
- **Hunting proactivo**: queries en EDR/SIEM buscando TTPs (MITRE ATT\&CK).
- **Sandboxing**: ejecutar muestras en entorno aislado para observar comportamiento (detener si es malicioso).
- **An√°lisis de memoria** (para fileless) y logs de endpoints.

Ejemplo de regla defensiva (modelo, para detecci√≥n de PowerShell ofuscado ‚Äî solo con finalidad defensiva):

```yara
rule Suspicious_Powershell_Encoded {
  meta:
    description = "Detecta PowerShell con comandos codificados largos (potencial fileless/malware)"
  strings:
    $enc = /-Enc(odedCommand)?\s+[A-Za-z0-9+/=]{50,}/
  condition:
    $enc
}
```

(Ejemplo ilustrativo ‚Äî adaptar a tu entorno, validar falsos positivos.)

### üõ°Ô∏è C√≥mo prevenir (controles t√©cnicos y organizacionales)

1. **Parches y gesti√≥n de vulnerabilidades**: parchear r√°pido sistemas cr√≠ticos.
2. **Principio de m√≠nimo privilegio (PoLP)**: usuarios con los permisos estrictamente necesarios.
3. **EDR/XDR y detecci√≥n en endpoints**: telemetr√≠a completa y respuesta automatizada.
4. **Seguridad en correo**: filtrado, bloqueo de macros, sandbox de adjuntos, DMARC/SPF/DKIM.
5. **Seguridad de red**: segmentaci√≥n, listas blancas de IP, firewalling, bloqueo de C2 con DNS filtering.
6. **Application allow-listing**: permitir solo software aprobado en endpoints cr√≠ticos.
7. **Copia de seguridad y recuperaci√≥n**: backups offline/air-gapped y pruebas de restore.
8. **Protecci√≥n contra fileless**: monitorizar uso de PowerShell/WMIC/WMI, bloquear comandos ofuscados.
9. **Gesti√≥n de secretos**: no dejar credenciales en repositorios; rotaci√≥n y vaults.
10. **Higiene de IoT**: cambiar credenciales por defecto, actualizar firmware, aislar IoT en VLAN.
11. **Concienciaci√≥n y formaci√≥n**: entrenar contra phishing; simulaciones peri√≥dicas.
12. **Pol√≠ticas de incident response** y Playbooks (contenci√≥n, erradicaci√≥n, recuperaci√≥n).

### ‚úÖ Respuesta ante un incidente de malware (pasos resumidos)

1. **Aislar** sistemas afectados (quitar red) para evitar propagaci√≥n.
2. **Preservar evidencia** (logs, memoria, im√°genes) para an√°lisis forense.
3. **Triage**: identificar familia/tipo (ransomware, botnet, etc.).
4. **Eliminar / erradicar**: limpieza segura (im√°genes limpias, reinstalaciones).
5. **Recuperar** desde backups verificados.
6. **Notificar** (interno, legal, clientes, autoridades seg√∫n normativa).
7. **Lecciones aprendidas**: parchear, mejorar controles y actualizar playbooks.

### üîó Mapeo a MITRE ATT\&CK (√∫til para hunters)

Muchos malwares usan t√©cnicas documentadas por MITRE ‚Äî ejemplos:

- **Initial Access:** Phishing, Exploit Public-Facing Application.
- **Execution:** PowerShell, Scripting, Exploitation.
- **Persistence:** Create Account, Services, Scheduled Tasks.
- **Privilege Escalation:** Exploits, Bypass UAC.
- **Defense Evasion:** Obfuscated Files, Modify System Tools.
- **Command and Control:** C2 over HTTP(S), DNS Tunneling.
- **Exfiltration:** Exfil over C2 channel, SMB, FTP.

Usar MITRE ATT\&CK con EDR + SIEM facilita hunts y reglas Sigma/SIEM.

### üßæ Buenas pr√°cticas empresariales ‚Äî ‚Äúdet√©n las infracciones e impulsa el negocio‚Äù

- **Invierte en detecci√≥n temprana (EDR + SIEM + TIP)** para reducir MTTD/MTTR.
- **Prueba tu capacidad de recuperaci√≥n** (backups y DR) regularmente para minimizar downtime.
- **Automatiza respuestas comunes** (SOAR) para aislar hosts y bloquear IOCs r√°pidamente.
- **Prioriza activos cr√≠ticos** (cuidado extra en OT, sistemas financieros).
- **Mide impacto y comunica claramente** a stakeholders (C-level): seguridad reduce riesgo de interrupciones y protege la continuidad del negocio.

### üß≠ Resumen ejecutivo (para llevar)

- **Qu√© es:** malware = software malicioso con objetivos variados (dinero, espionaje, sabotaje).
- **C√≥mo act√∫a:** vectores de entrega ‚Üí ejecuci√≥n ‚Üí persistencia ‚Üí C2 ‚Üí impacto.
- **Tipos clave:** ransomware, troyanos, gusanos, rootkits, botnets, fileless, cryptominers, spyware.
- **Detectar:** EDR/XDR, network monitoring, hunting, sandboxing, TI feeds.
- **Prevenir:** parches, PoLP, app allowlisting, backups, segmentaci√≥n, formaci√≥n.
- **Responder:** aislar, preservar evidencia, erradicar, restaurar, aprender.

---

[üîº](#√≠ndice)

---

| **Inicio**         | **atr√°s 8**                                   | **Siguiente 10**                            |
| ------------------ | --------------------------------------------- | ------------------------------------------- |
| [üè†](../README.md) | [‚è™](./8_8_Web_Based_Attacks_and_OWASP_10.md) | [‚è©](./8_10_Core_Concepts_of_Zero_Trust.md) |
